import{o as S,m as w,a,u as x,h as U,j as s,c as f,D as L,aU as R,T as C,d as E,e as D,B,aY as I,aq as T}from"./index-DRDIumvF.js";import{s as v}from"./sessionSharing-Cz95NKuV.js";import{D as g}from"./DialogContentText-CilhbB70.js";import"./GridBookmarkWidget-D8PMW6NY.js";import"./MenuItem-D5kXI1eL.js";import"./dividerClasses-rNTJcnQi.js";import"./DataGrid-COGS3KN-.js";import"./index-erzOx3_L.js";import"./utils-BwPRrx3T.js";import"./getThemeProps-IugnyHrN.js";import"./Divider-C_55-x0A.js";import"./Badge-D0gYdILz.js";import"./TableCell-Cy8GZPEs.js";import"./ColorPicker-D_JqId1D.js";import"./DataGridFlexContainer-BtHzV4NV.js";const A=w()(()=>({flexItem:{margin:5},content:{display:"flex",flexFlow:"column",gap:"5px"}})),V=S(function({onClose:l,model:r}){const{classes:c}=A(),[h,y]=a.useState(""),[p,j]=a.useState(),[d,n]=a.useState(!0),t=x.getSession(r),{selectedBookmarks:m}=r,b=m.length===0,k=m.length===0?r.allBookmarksModel:r.sharedBookmarksModel;return a.useEffect(()=>{(async()=>{try{if(!x.isSessionWithShareURL(t))throw new Error("No shareURL configured");n(!0);const e=U(k),o=new URL(window.location.href),u=await v(e,t.shareURL,o.href),i=new URLSearchParams(o.search);i.set("bookmarks",`share-${u.json.sessionId}`),i.set("password",u.password),o.search=i.toString(),y(o.href),n(!1)}catch(e){j(e)}finally{n(!1)}})()},[k,t]),s.jsxs(f.Dialog,{open:!0,onClose:l,title:"Share bookmarks",children:[s.jsxs(L,{className:c.content,children:[s.jsx(R,{severity:"info",children:b?s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"All bookmarks will be shared."}),s.jsx("br",{}),s.jsx("span",{children:"Use the checkboxes to select individual bookmarks to share."})]}):"Only selected bookmarks will be shared."}),s.jsx(g,{children:"Copy the URL below to share your bookmarks."}),p?s.jsx(f.ErrorMessage,{error:p}):d?s.jsx(C,{children:"Generating short URL..."}):s.jsx(E,{label:"URL",value:h,slotProps:{input:{readOnly:!0}},variant:"filled",fullWidth:!0,onClick:e=>{e.target.select()}}),s.jsx(g,{children:'The URL should be pasted into the "Import from share link" field in the "Import" form found in the "Bookmarked regions" drawer.'})]}),s.jsx(D,{children:s.jsx(B,{className:c.flexItem,"data-testid":"dialogShare",variant:"contained",color:"primary",disabled:d,startIcon:s.jsx(T.ContentCopy,{}),onClick:async()=>{I(h),t.notify("Copied to clipboard","success"),l()},children:"Copy share link"})})]})});export{V as default};
//# sourceMappingURL=ShareBookmarksDialog-DoYSL9Fm.js.map
