const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DeletePluginDialog-D_KOQpaw.js","./index-CT2bM4yV.js","./index-DIqbght7.css","./AddCustomPluginDialog-DHtTl9i7.js"])))=>i.map(i=>d[i]);
import{ad as p,j as s,e5 as _,o as x,bG as u,bE as k,au as y,aw as M,c as m,T as d,_ as C,m as j,at as N,bD as A,e6 as D,e7 as B,L as F,e8 as R,B as S,dw as $,ac as W,e as z,dM as q,cu as v,cv as P,bH as I,bB as O}from"./index-CT2bM4yV.js";import{C as H}from"./Clear-BMvCXcfi.js";import{L as V}from"./Lock-BLIs4xA9.js";const Y=p(s.jsx("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined");var h=_();const G=m.lazy(()=>C(()=>import("./DeletePluginDialog-D_KOQpaw.js"),__vite__mapDeps([0,1,2]),import.meta.url)),U=j()(()=>({lockedPluginTooltip:{marginRight:"0.5rem"}}));function J(){const{classes:e}=U();return s.jsx(N,{className:e.lockedPluginTooltip,title:"This plugin was installed by an administrator, you cannot remove it.",children:s.jsx(V,{})})}const K=x(function({plugin:e,model:n}){const{pluginManager:r}=u.getEnv(n),a=u.getSession(n),{jbrowse:t,adminMode:c}=a,o=h.isSessionWithSessionPlugins(a)?a.sessionPlugins.some(l=>{var i;return((i=r.pluginMetadata[e.name])===null||i===void 0?void 0:i.url)===l.url}):!1;return s.jsxs(k,{children:[c||o?s.jsx(y,{"data-testid":`removePlugin-${e.name}`,onClick:()=>{a.queueDialog(l=>[G,{plugin:e.name,onClose:i=>{if(i){const g=r.pluginMetadata[e.name];c?t.removePlugin(g):h.isSessionWithSessionPlugins(a)&&a.removeSessionPlugin(g)}l()}}])},children:s.jsx(M,{})}):s.jsx(J,{}),s.jsx(d,{children:e.name})]},e.name)}),Q=x(function({pluginManager:n,model:r}){const{plugins:a}=n,{filterText:t}=r,c=a.filter(o=>{var l;return!(!((l=n.pluginMetadata[o.name])===null||l===void 0)&&l.isCore)});return s.jsx(A,{children:c.length>0?c.filter(o=>o.name.toLowerCase().includes(t.toLowerCase())).map(o=>s.jsx(K,{plugin:o,model:r},o.name)):s.jsx(d,{children:"No plugins currently installed"})})}),X=p(s.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),Z=p(s.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person"),ss=j()({card:{margin:"0.5em"},icon:{marginLeft:"0.5em",marginRight:"0.5em"},bold:{fontWeight:600},dataField:{display:"flex",alignItems:"center"},mr:{marginRight:"0.5em"}}),es=x(function({plugin:n,model:r}){const{classes:a}=ss(),t=u.getSession(r),{pluginManager:c}=u.getEnv(r),{runtimePluginDefinitions:o}=c,l=o.some(f=>"url"in f&&f.url===n.url),[i,g]=m.useState(!1),{adminMode:b,jbrowse:E}=t,{name:L,authors:T,description:w}=n;return s.jsxs(D,{variant:"outlined",className:a.card,children:[s.jsxs(B,{children:[s.jsx(d,{variant:"h5",children:s.jsx(F,{href:`${n.location}#readme`,target:"_blank",rel:"noopener",children:n.name})}),s.jsxs("div",{className:a.dataField,children:[s.jsx(Z,{className:a.mr}),s.jsx(d,{children:T.join(", ")})]}),s.jsx(d,{className:a.bold,children:"Description:"}),s.jsx(d,{children:w})]}),s.jsx(R,{children:s.jsx(S,{variant:"contained",disabled:l||i,startIcon:l?s.jsx(X,{}):s.jsx($,{}),onClick:()=>{b?E.addPlugin(n):h.isSessionWithSessionPlugins(t)?t.addSessionPlugin(n):t.notify("No way to install plugin"),g(!0)},children:l?"Installed":"Install"})})]},L)});function ns(){const[e,n]=m.useState(),[r,a]=m.useState();return m.useEffect(()=>{(async()=>{try{const t=await fetch("https://jbrowse.org/plugin-store/plugins.json");if(!t.ok){const o=await t.text();throw new Error(`HTTP ${t.status} fetching plugins: ${o}`)}const c=await t.json();n(c.plugins)}catch(t){console.error(t),a(t)}})()},[]),{plugins:e,error:r}}const ts=m.lazy(()=>C(()=>import("./AddCustomPluginDialog-DHtTl9i7.js"),__vite__mapDeps([3,1,2]),import.meta.url)),as=j()(e=>({expandIcon:{color:e.palette.tertiary.contrastText},adminBadge:{borderRadius:3,backgroundColor:e.palette.quaternary.main,padding:"1em",display:"flex",alignContent:"center"},customPluginButton:{margin:"1em auto",display:"flex"},mr:{marginRight:"0.3em"},m:{margin:"1em"}})),ls=x(function({model:e}){const{classes:n}=as(),{plugins:r,error:a}=ns(),{filterText:t}=e,c=u.getSession(e),{adminMode:o}=c,{pluginManager:l}=W(e);return s.jsxs("div",{children:[o&&s.jsxs(s.Fragment,{children:[!u.isElectron&&s.jsxs("div",{className:n.adminBadge,children:[s.jsx(Y,{className:n.mr}),s.jsxs(d,{children:["You are using the ",s.jsx("code",{children:"admin-server"}),". Any changes you make will be saved to your configuration file. You also have the ability to add custom plugins that are not in the store."]})]}),s.jsx(S,{className:n.customPluginButton,variant:"contained",onClick:()=>{c.queueDialog(i=>[ts,{model:e,onClose:i}])},children:"Add custom plugin"})]}),s.jsx(z,{label:"Filter plugins",value:t,onChange:i=>{e.setFilterText(i.target.value)},fullWidth:!0,slotProps:{input:{endAdornment:s.jsx(q,{position:"end",children:s.jsx(y,{onClick:()=>{e.clearFilterText()},children:s.jsx(H,{})})})}}}),s.jsxs(v,{defaultExpanded:!0,children:[s.jsx(P,{expandIcon:s.jsx(I,{className:n.expandIcon}),children:s.jsx(d,{variant:"h5",children:"Installed plugins"})}),s.jsx("div",{className:n.m,children:s.jsx(Q,{pluginManager:l,model:e})})]}),s.jsxs(v,{defaultExpanded:!0,children:[s.jsx(P,{expandIcon:s.jsx(I,{className:n.expandIcon}),children:s.jsx(d,{variant:"h5",children:"Available plugins"})}),a?s.jsx(d,{color:"error",children:`${a}`}):r?r.filter(i=>!(u.isElectron&&i.cjsUrl)&&i.name.toLowerCase().includes(t.toLowerCase())).map(i=>s.jsx(es,{plugin:i,model:e},i.name)):s.jsx(O.LoadingEllipses,{})]})]})});export{ls as default};
//# sourceMappingURL=PluginStoreWidget-BoqsPwWj.js.map
