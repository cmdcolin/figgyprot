import{bs as X,f9 as he,fa as E,cz as O,j as f,c as y,bO as L,fb as w,bN as g,fc as je,fd as be,fe as M,ff as D,o as ue,m as de,fg as fe,D as ge,B as z,cH as pe}from"./index-CT2bM4yV.js";var ye=he();const ve=X(ye);var U={},R={},F={},Z;function K(){if(Z)return F;Z=1,Object.defineProperty(F,"__esModule",{value:!0}),F.default=n;const e=f,t=y,s=L,i=O,u=w,o=E(),c=(0,i.makeStyles)()(r=>({fieldValue:{wordBreak:"break-word",maxHeight:300,fontSize:12,padding:r.spacing(.5),overflow:"auto"}}));function n({value:r}){const{classes:a}=c(),l=/^https?:\/\//.exec(`${r}`);return(0,e.jsx)("div",{className:a.fieldValue,children:(0,t.isValidElement)(r)?r:l?(0,e.jsx)(s.Link,{href:`${r}`,children:`${r}`}):(0,e.jsx)(u.SanitizedHTML,{html:(0,o.isObject)(r)?JSON.stringify(r):String(r)})})}return F}var T={},ee;function V(){if(ee)return T;ee=1,Object.defineProperty(T,"__esModule",{value:!0}),T.default=u;const e=f,t=L,i=(0,O.makeStyles)()(o=>({fieldDescription:{"&:hover":{background:o.palette.mode==="dark"?"#e65100":"yellow"}},fieldName:{wordBreak:"break-all",minWidth:90,borderBottom:"1px solid #0003",fontSize:12,background:o.palette.action.disabledBackground,marginRight:o.spacing(1),padding:o.spacing(.5)}}));function u({description:o,name:c,width:n,prefix:r=[]}){const{classes:a,cx:l}=i(),d=[...r,c].join(".");return o?(0,e.jsx)(t.Tooltip,{title:o,placement:"left",children:(0,e.jsx)("div",{className:l(a.fieldDescription,a.fieldName),children:d})}):(0,e.jsx)("div",{className:a.fieldName,style:{width:n},children:d})}return T}var te;function Se(){if(te)return R;te=1;var e=g&&g.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(R,"__esModule",{value:!0}),R.default=r;const t=f,s=O,i=e(me()),u=e(K()),o=e(V()),c=E(),n=(0,s.makeStyles)()(a=>({field:{display:"flex",flexWrap:"wrap"},fieldSubvalue:{wordBreak:"break-word",maxHeight:300,padding:a.spacing(.5),border:`1px solid ${a.palette.action.selected}`,boxSizing:"border-box",overflow:"auto"}}));function r({name:a,value:l,description:d,prefix:p=[]}){const{classes:x}=n();return l.length===1?(0,c.isObject)(l[0])?(0,t.jsx)(i.default,{attributes:l[0],prefix:[...p,a]}):(0,t.jsxs)("div",{className:x.field,children:[(0,t.jsx)(o.default,{prefix:p,description:d,name:a}),(0,t.jsx)(u.default,{value:l[0]})]}):l.every(h=>(0,c.isObject)(h))?(0,t.jsx)(t.Fragment,{children:l.map((h,v)=>(0,t.jsx)(i.default,{attributes:h,prefix:[...p,`${a}-${v}`]},`${JSON.stringify(h)}-${v}`))}):(0,t.jsxs)("div",{className:x.field,children:[(0,t.jsx)(o.default,{prefix:p,description:d,name:a}),l.map((h,v)=>(0,t.jsx)("div",{className:x.fieldSubvalue,children:(0,t.jsx)(u.default,{value:h})},`${JSON.stringify(h)}-${v}`))]})}return R}var q={},se;function Ce(){if(se)return q;se=1;var e=g&&g.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(q,"__esModule",{value:!0}),q.default=l;const t=f,s=y,i=L,u=je,o=O,c=e(V()),n=w,r=E(),a=(0,o.makeStyles)()(d=>({margin:{marginBottom:d.spacing(4)},cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}));function l({value:d,prefix:p,name:x}){const{classes:h}=a(),[v,G]=(0,s.useState)(!1),k=Object.keys(d[0]).sort(),j=new Set(k),$=Object.entries(d).map(([b,S])=>{const{id:m,..._}=S;return{id:b,identifier:m,..._}});for(const b of d)for(const S of Object.keys(b))j.add(S);let A;j.has("id")?(j.delete("id"),A=["identifier",...j]):A=[...j];const H=A.map(b=>(0,r.measureGridWidth)($.map(S=>S[b])));return j.size<k.length+5?(0,t.jsxs)("div",{className:h.margin,children:[(0,t.jsx)(c.default,{prefix:p,name:x}),(0,t.jsx)(i.FormControlLabel,{control:(0,t.jsx)(i.Checkbox,{checked:v,onChange:b=>{G(b.target.checked)}}),label:(0,t.jsx)(i.Typography,{variant:"body2",children:"Show options"})}),(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(0,t.jsx)(u.DataGrid,{disableRowSelectionOnClick:!0,rows:$,rowHeight:20,columnHeaderHeight:35,hideFooter:$.length<25,slots:{toolbar:v?u.GridToolbar:null},slotProps:{toolbar:{printOptions:{disableToolbarButton:!0}}},columns:A.map((b,S)=>({field:b,renderCell:m=>{const _=m.value;return(0,t.jsx)("div",{className:h.cell,children:(0,t.jsx)(n.SanitizedHTML,{html:(0,r.getStr)(_||"")})})},width:H[S]}))})})]}):null}return q}var B={},re;function Ne(){if(re)return B;re=1;var e=g&&g.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(B,"__esModule",{value:!0}),B.default=c;const t=f,s=O,i=e(K()),u=e(V()),o=(0,s.makeStyles)()({field:{display:"flex",flexWrap:"wrap"}});function c({name:n,value:r,description:a,prefix:l,width:d}){const{classes:p}=o();return r!=null?(0,t.jsxs)("div",{className:p.field,children:[(0,t.jsx)(u.default,{prefix:l,description:a,name:n,width:d}),(0,t.jsx)(i.default,{value:r})]}):null}return B}var P={},ne;function De(){if(ne)return P;ne=1;var e=g&&g.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(P,"__esModule",{value:!0}),P.default=c;const t=f,s=O,i=e(K()),u=e(V()),o=(0,s.makeStyles)()({field:{display:"flex",flexWrap:"wrap"}});function c({value:n,prefix:r,name:a}){const{classes:l}=o(),{uri:d,baseUri:p=""}=n;let x;try{x=new URL(d,p).href}catch{x=d}return(0,t.jsxs)("div",{className:l.field,children:[(0,t.jsx)(u.default,{prefix:r,name:a}),(0,t.jsx)(i.default,{value:x})]})}return P}var N={},C={};Object.defineProperty(C,"__esModule",{value:!0});C.stitch=we;C.dedupe=Oe;C.revlist=$e;C.calculateUTRs=Ae;C.calculateUTRs2=Me;C.ellipses=Ee;C.replaceUndefinedWithNull=ke;function we(e,t){return e.map(s=>t.slice(s.start,s.end)).join("")}function ie(e){return`${e.start}-${e.end}`}function Oe(e){return e.filter((t,s,i)=>!s||ie(t)!==ie(i[s-1]))}function $e(e,t){return e.map(s=>({...s,start:t-s.end,end:t-s.start})).sort((s,i)=>s.start-i.start)}function Ae(e,t){if(!e.length)return[];const s=e.at(0),i=e.at(-1),u=t.findIndex(l=>l.end>=s.start&&l.start<=s.start),o=t.findIndex(l=>l.end>=i.end&&l.start<=i.end),c=t[o],n=t[u],r=[...t.slice(0,u),{start:n.start,end:s.start}].map(l=>({...l,type:"five_prime_UTR"})),a=[{start:i.end,end:c.end},...t.slice(o+1)].map(l=>({...l,type:"three_prime_UTR"}));return[...r,...a]}function Me(e,t){if(!e.length)return[];const s=e.at(0),i=e.at(-1),u=[{start:t.start,end:s.start}].map(c=>({...c,type:"five_prime_UTR"})),o=[{start:i.end,end:t.end}].map(c=>({...c,type:"three_prime_UTR"}));return[...u,...o]}function Ee(e){return e.length>20?`${e.slice(0,20)}...`:e}function ke(e){return JSON.parse(JSON.stringify(e,(t,s)=>s===void 0?null:s))}var ae;function Ue(){if(ae)return N;ae=1,Object.defineProperty(N,"__esModule",{value:!0}),N.isEmpty=s,N.generateTitle=i,N.generateMaxWidth=u,N.accessNested=o;const e=E(),t=C;function s(c){return Object.keys(c).length===0}function i(c,n,r){return[(0,t.ellipses)(`${c||n||""}`),`${r}`].filter(a=>!!a).join(" - ")}function u(c,n){return Math.ceil((0,e.max)(c.map(r=>(0,e.measureText)([...n,r[0]].join("."),12))))+10}function o(c,n={}){let r=n;for(const a of c)(0,e.isObject)(r)&&(r=r[a]);return typeof r=="string"?r:(0,e.isObject)(r)&&typeof r.Description=="string"?r.Description:void 0}return N}var oe;function me(){if(oe)return U;oe=1;var e=g&&g.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(U,"__esModule",{value:!0}),U.default=l;const t=f,s=e(Se()),i=e(Ce()),u=e(Ne()),o=e(De()),c=Ue(),n=E(),r=170,a=["__jbrowsefmt","length","position","subfeatures","uniqueId","exonFrames","parentId","thickStart","thickEnd"];function l(d){const{attributes:p,omit:x=[],omitSingleLevel:h=[],descriptions:v,formatter:G=m=>m,hideUris:k,prefix:j=[]}=d,$=new Set([...x,...a,...h]),{__jbrowsefmt:A,...H}=p,b={...H,...A},S=(0,c.generateMaxWidth)(Object.entries(b).filter(([m,_])=>_!==void 0&&!$.has(m)),j);return(0,t.jsx)(t.Fragment,{children:Object.entries(b).filter(([m,_])=>_!==void 0&&!$.has(m)).map(([m,_])=>{const Q=(0,c.accessNested)([...j,m],v);if(Array.isArray(_))return _.length>1&&_.every(Y=>(0,n.isObject)(Y))?(0,t.jsx)(i.default,{name:m,prefix:j,value:_},m):(0,t.jsx)(s.default,{name:m,value:_,description:Q,prefix:j},m);if((0,n.isObject)(_)){const{omitSingleLevel:Y,..._e}=d;return(0,n.isUriLocation)(_)?k?null:(0,t.jsx)(o.default,{name:m,prefix:j,value:_},m):(0,t.jsx)(l,{..._e,attributes:_,descriptions:v,prefix:[...j,m]},m)}else return(0,t.jsx)(u.default,{name:m,value:G(_,m),description:Q,prefix:j,width:Math.min(S,r)},m)})})}return U}var Re=me();const J=X(Re);var I={},le;function Fe(){if(le)return I;le=1;var e=g&&g.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(I,"__esModule",{value:!0}),I.default=c;const t=f,s=e(be),i=L,o=(0,O.makeStyles)()(n=>({expansionPanelDetails:{display:"block",padding:n.spacing(1)},icon:{color:n.palette.tertiary.contrastText||"#fff"}}));function c({children:n,title:r,defaultExpanded:a=!0}){const{classes:l}=o();return(0,t.jsxs)(i.Accordion,{defaultExpanded:a,children:[(0,t.jsx)(i.AccordionSummary,{expandIcon:(0,t.jsx)(s.default,{className:l.icon}),children:(0,t.jsx)(i.Typography,{variant:"button",children:r})}),(0,t.jsx)(i.AccordionDetails,{className:l.expansionPanelDetails,children:n})]})}return I}var Te=Fe();const W=X(Te);function qe({config:e}){const[t,s]=y.useState(),[i,u]=y.useState(),o=M.getSession(e),{rpcManager:c}=o;y.useEffect(()=>{(async()=>{try{const r=D.readConfObject(e,"adapter"),a=await c.call(e.trackId,"CoreGetInfo",{adapterConfig:r});u(a)}catch(r){console.error(r),s(r)}})()},[e,c]);const n=typeof i=="string"?{header:`<pre>${i.replaceAll("<","&lt;").replaceAll(">","&gt;")}</pre>`}:i||{};return f.jsx(W,{title:"File info",children:t?f.jsx(w.ErrorMessage,{error:t}):i===void 0?f.jsx(w.LoadingEllipses,{message:"Loading file data"}):f.jsx(J,{attributes:n})})}const ce=1e4,Be=de()(e=>({container:{minWidth:800},refNames:{maxHeight:300,overflow:"auto",flexGrow:1,background:e.palette.background.default}})),Pe=ue(function({config:e,onClose:t}){const{classes:s}=Be(),[i,u]=y.useState(),[o,c]=y.useState(),[n,r]=y.useState(!1),{rpcManager:a}=M.getSession(e);y.useEffect(()=>{(async()=>{try{const p=await Promise.all([...new Set(fe.getConfAssemblyNames(e))].map(async x=>{const h=D.readConfObject(e,"adapter");return[x,await a.call(e.trackId,"CoreGetRefNames",{adapterConfig:h,regions:[{assemblyName:x}]})]}));c(Object.fromEntries(p))}catch(p){console.error(p),u(p)}})()},[e,a]);const l=o?Object.entries(o):[],d=l.flatMap(([p,x])=>[`--- ${p} ---`,...x.slice(0,ce),x.length>ce?`
Too many refNames to show in browser for ${p}, use "Copy ref names" button to copy to clipboard`:""]).filter(p=>!!p).join(`
`);return f.jsx(w.Dialog,{open:!0,title:"Reference sequence names used in track",onClose:t,maxWidth:"xl",children:f.jsx(ge,{className:s.container,children:i?f.jsx(w.ErrorMessage,{error:i}):o===void 0?f.jsx(w.LoadingEllipses,{message:"Loading refNames"}):f.jsxs(f.Fragment,{children:[f.jsx(z,{variant:"contained",onClick:()=>{pe(l.flatMap(([p,x])=>[`--- ${p} ---`,...x]).filter(p=>!!p).join(`
`)),r(!0),setTimeout(()=>{r(!1)},1e3)},children:n?"Copied to clipboard!":"Copy ref names"}),f.jsx("pre",{className:s.refNames,children:d})]})})})}),Ie=de()({content:{minWidth:800},button:{float:"right"}});function xe(e,t){for(const s in e)s===t?delete e[s]:typeof e[s]=="object"&&xe(e[s],t);return e}const We=ue(function({config:e}){const[t,s]=y.useState(!1),i=D.readConfObject(e),u=M.getSession(e),{classes:o}=Ie(),[c,n]=y.useState(!1),r=D.getConf(u,["formatAbout","hideUris"])||D.readConfObject(e,["formatAbout","hideUris"]),{pluginManager:a}=M.getEnv(u),l=a.evaluateExtensionPoint("Core-customizeAbout",{config:{...i,...D.getConf(u,["formatAbout","config"],{config:i}),...D.readConfObject(e,["formatAbout","config"],{config:i})}},{session:u,config:e}),d=a.evaluateExtensionPoint("Core-extraAboutPanel",null,{session:u,config:e});return f.jsxs("div",{className:o.content,children:[f.jsxs(W,{title:"Configuration",children:[r?null:f.jsxs("span",{className:o.button,children:[f.jsx(z,{variant:"contained",color:"secondary",onClick:()=>{n(!0)},children:"Show ref names"}),f.jsx(z,{variant:"contained",onClick:()=>{const p=xe(structuredClone(i),"baseUri");pe(JSON.stringify(p,null,2)),s(!0),setTimeout(()=>{s(!1)},1e3)},children:t?"Copied to clipboard!":"Copy config"})]}),f.jsx(J,{attributes:l.config,omit:["displays","baseUri","refNames","formatAbout","metadata"],hideUris:r})]}),l.config.metadata?f.jsx(W,{title:"Metadata",children:f.jsx(J,{attributes:l.config.metadata,omit:["displays","baseUri","refNames","formatAbout"],hideUris:r})}):null,d?f.jsx(W,{title:d.name,children:f.jsx(d.Component,{config:e})}):null,f.jsx(qe,{config:e}),c?f.jsx(Pe,{config:e,onClose:()=>{n(!1)}}):null]})});function Ve({config:e,handleClose:t}){const s=M.getSession(e),i=fe.getTrackName(e,s),{pluginManager:u}=M.getEnv(s),o=u.evaluateExtensionPoint("Core-replaceAbout",We,{session:s,config:e});return f.jsx(ve,{open:!0,onClose:t,title:i,maxWidth:"xl",children:f.jsx(o,{config:e})})}export{Ve as default};
//# sourceMappingURL=AboutDialog--GjkNGVt.js.map
