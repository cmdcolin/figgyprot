{"version":3,"file":"BedpeImport-B5guMMX2.js","sources":["../../node_modules/@jbrowse/plugin-spreadsheet-view/esm/SpreadsheetView/importAdapters/BedpeImport.js"],"sourcesContent":["import { isNumber } from '@mui/x-data-grid/internals';\nimport { bufferToLines, parseStrand } from './util';\nexport function parseBedPEBuffer(buffer) {\n    var _a, _b;\n    const lines = bufferToLines(buffer);\n    const rest = lines.filter(line => !(line.startsWith('#') ||\n        line.startsWith('browser') ||\n        line.startsWith('track')));\n    const lastHeaderLine = lines.findLast(line => line.startsWith('#'));\n    const coreColumns = [\n        'refName',\n        'start',\n        'end',\n        'mateRef',\n        'mateStart',\n        'mateEnd',\n        'name',\n        'score',\n        'strand',\n        'mateStrand',\n    ];\n    const numExtraColumns = Math.max(0, (((_b = (_a = rest[0]) === null || _a === void 0 ? void 0 : _a.split('\\t')) === null || _b === void 0 ? void 0 : _b.length) || 0) - coreColumns.length);\n    const extraNames = (lastHeaderLine === null || lastHeaderLine === void 0 ? void 0 : lastHeaderLine.includes('\\t'))\n        ? lastHeaderLine\n            .slice(1)\n            .split('\\t')\n            .slice(coreColumns.length)\n            .map(t => t.trim())\n        : Array.from({ length: numExtraColumns }, (_v, i) => `field_${i}`);\n    const colNames = [...coreColumns, ...extraNames];\n    return {\n        columns: colNames.map(c => ({ name: c })),\n        rowSet: {\n            rows: rest.map((line, idx) => {\n                const cols = line.split('\\t');\n                return {\n                    cellData: {\n                        refName: cols[0],\n                        start: cols[1],\n                        end: cols[2],\n                        mateRefName: cols[3],\n                        mateStart: cols[4],\n                        mateEnd: cols[5],\n                        name: cols[6],\n                        score: +cols[7] || cols[7],\n                        strand: cols[8],\n                        mateStrand: cols[9],\n                        ...Object.fromEntries(extraNames.map((n, idx) => {\n                            const r = cols[idx + coreColumns.length];\n                            return [n, isNumber(r) ? +r : r];\n                        })),\n                    },\n                    feature: {\n                        uniqueId: `bedpe-${idx}`,\n                        refName: cols[0],\n                        start: +cols[1],\n                        end: +cols[2],\n                        strand: parseStrand(cols[8]),\n                        mate: {\n                            refName: cols[3],\n                            start: +cols[4],\n                            end: +cols[5],\n                            strand: parseStrand(cols[9]),\n                        },\n                        name: cols[6],\n                        score: cols[7],\n                        ...Object.fromEntries(extraNames.map((n, idx) => {\n                            const r = cols[idx + coreColumns.length];\n                            return [n, isNumber(r) ? +r : r];\n                        })),\n                    },\n                };\n            }),\n        },\n    };\n}\n"],"names":["parseBedPEBuffer","buffer","_a","_b","lines","bufferToLines","rest","line","lastHeaderLine","coreColumns","numExtraColumns","extraNames","t","_v","c","idx","cols","n","isNumber","parseStrand"],"mappings":"kFAEO,SAASA,EAAiBC,EAAQ,CACrC,IAAIC,EAAIC,EACR,MAAMC,EAAQC,EAAcJ,CAAM,EAC5BK,EAAOF,EAAM,OAAOG,GAAQ,EAAEA,EAAK,WAAW,GAAG,GACnDA,EAAK,WAAW,SAAS,GACzBA,EAAK,WAAW,OAAO,EAAE,EACvBC,EAAiBJ,EAAM,SAASG,GAAQA,EAAK,WAAW,GAAG,CAAC,EAC5DE,EAAc,CAChB,UACA,QACA,MACA,UACA,YACA,UACA,OACA,QACA,SACA,YACH,EACKC,EAAkB,KAAK,IAAI,KAAMP,GAAMD,EAAKI,EAAK,CAAC,KAAO,MAAQJ,IAAO,OAAS,OAASA,EAAG,MAAM,GAAI,KAAO,MAAQC,IAAO,OAAS,OAASA,EAAG,SAAW,GAAKM,EAAY,MAAM,EACpLE,EAAcH,GAAmB,MAA6CA,EAAe,SAAS,GAAI,EAC1GA,EACG,MAAM,CAAC,EACP,MAAM,GAAI,EACV,MAAMC,EAAY,MAAM,EACxB,IAAIG,GAAKA,EAAE,KAAM,CAAA,EACpB,MAAM,KAAK,CAAE,OAAQF,CAAiB,EAAE,CAACG,EAAI,IAAM,SAAS,CAAC,EAAE,EAErE,MAAO,CACH,QAFa,CAAC,GAAGJ,EAAa,GAAGE,CAAU,EAEzB,IAAIG,IAAM,CAAE,KAAMA,CAAC,EAAG,EACxC,OAAQ,CACJ,KAAMR,EAAK,IAAI,CAACC,EAAMQ,IAAQ,CAC1B,MAAMC,EAAOT,EAAK,MAAM,GAAI,EAC5B,MAAO,CACH,SAAU,CACN,QAASS,EAAK,CAAC,EACf,MAAOA,EAAK,CAAC,EACb,IAAKA,EAAK,CAAC,EACX,YAAaA,EAAK,CAAC,EACnB,UAAWA,EAAK,CAAC,EACjB,QAASA,EAAK,CAAC,EACf,KAAMA,EAAK,CAAC,EACZ,MAAO,CAACA,EAAK,CAAC,GAAKA,EAAK,CAAC,EACzB,OAAQA,EAAK,CAAC,EACd,WAAYA,EAAK,CAAC,EAClB,GAAG,OAAO,YAAYL,EAAW,IAAI,CAACM,EAAGF,IAAQ,CAC7C,MAAM,EAAIC,EAAKD,EAAMN,EAAY,MAAM,EACvC,MAAO,CAACQ,EAAGC,EAAS,CAAC,EAAI,CAAC,EAAI,CAAC,CAC3D,CAAyB,CAAC,CACL,EACD,QAAS,CACL,SAAU,SAASH,CAAG,GACtB,QAASC,EAAK,CAAC,EACf,MAAO,CAACA,EAAK,CAAC,EACd,IAAK,CAACA,EAAK,CAAC,EACZ,OAAQG,EAAYH,EAAK,CAAC,CAAC,EAC3B,KAAM,CACF,QAASA,EAAK,CAAC,EACf,MAAO,CAACA,EAAK,CAAC,EACd,IAAK,CAACA,EAAK,CAAC,EACZ,OAAQG,EAAYH,EAAK,CAAC,CAAC,CAC9B,EACD,KAAMA,EAAK,CAAC,EACZ,MAAOA,EAAK,CAAC,EACb,GAAG,OAAO,YAAYL,EAAW,IAAI,CAACM,EAAGF,IAAQ,CAC7C,MAAM,EAAIC,EAAKD,EAAMN,EAAY,MAAM,EACvC,MAAO,CAACQ,EAAGC,EAAS,CAAC,EAAI,CAAC,EAAI,CAAC,CAC3D,CAAyB,CAAC,CACL,CACJ,CACjB,CAAa,CACJ,CACJ,CACL","x_google_ignoreList":[0]}