import{a3 as S}from"./index-CT2bM4yV.js";import{i as C}from"./util-eIttPhVK.js";import $ from"./PAFAdapter-C7rCfCH-.js";import"./index-DviPGhcF.js";function z(a,q){const{statusCallback:d=()=>{}}={};let c="",A="",u=0,m=0,h=0,p=0,k=0,x=0,t=[],i=0,f=0,D=!1;const L=[],E=new RegExp(/^>(\S+)\s+(\S+)\s+(\d+)\s+(\d+)/);let r=0,M=0,P=0;const _=new TextDecoder("utf8");for(;r<a.length;){P++%1e4===0&&d(`Loading ${S.getProgressDisplayStr(r,a.length)}`);const b=a.indexOf(10,r);if(b===-1)break;const j=a.subarray(r,b),w=_.decode(j).trim();if(r=b+1,M++,w){const y=E.exec(w);if(y!==null){c=y[1],A=y[2],D=!0;continue}if(!D)continue;const s=w.split(" ");if(s.length===7){const n=+s[0],e=+s[1],o=+s[2],l=+s[3],g=+s[4];k=n<e&&o<l||n>e&&o>l?1:-1,h=+Math.min(n,e)-1,p=+Math.max(e,n),u=+Math.min(o,l)-1,m=+Math.max(l,o),i=f=0,x=g,t=[]}else if(s.length===1){const n=+s[0];if(n===0){let e=0;const o=[];if(p-h-i!==m-u-f)throw new Error(`inconsistent alignment on line ${M}`);t.push(p-h-i<<4);for(const l of t){const g=l>>4;e+=g,o.push(g+"MID".charAt(t[M]&15))}L.push({qname:A,qstart:u,qend:m,tname:c,tstart:h,tend:p,strand:k,extra:{numMatches:e-x,blockLen:e,mappingQual:0,NM:x,cg:o.join("")}})}else if(n>0){const e=n-1;i+=e+1,f+=e,e>0&&t.push(e<<4),t.length>0&&(t[t.length-1]&15)===2?t[t.length-1]+=16:t.push(18)}else{const e=-n-1;i+=e,f+=e+1,e>0&&t.push(e<<4),t.length>0&&(t[t.length-1]&15)===1?t[t.length-1]+=16:t.push(17)}}}}return L}class Q extends ${async setupPre(q){const d=C.openLocation(this.getConf("deltaLocation"),this.pluginManager),c=await S.fetchAndMaybeUnzip(d,q);return z(c)}}export{Q as default};
//# sourceMappingURL=DeltaAdapter-aKJvF5x0.js.map
