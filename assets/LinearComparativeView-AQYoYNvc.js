import{o as b,m as v,j as e,cE as Q,T as w,u as S,a as p,F as W,cl as I,aq as Z,cs as ee,cF as ne,c as V,y as te,an as se,cG as D,bB as H,R as oe}from"./index-DRDIumvF.js";const re=v()(()=>({bp:{display:"flex",alignItems:"center",marginLeft:10},searchBox:{display:"flex"}})),ae=b(function({view:n}){const{classes:o}=re(),{assemblyNames:r,coarseTotalBp:t}=n;return e.jsxs("span",{className:o.searchBox,children:[e.jsx(Q,{model:n,showHelp:!1}),e.jsxs(w,{variant:"body2",color:"textSecondary",className:o.bp,children:[r.join(",")," ",S.toLocale(Math.round(t))," bp"]})]})}),ie=v()({inline:{display:"inline-flex"}}),ce=b(function({model:n}){const{classes:o}=ie(),{views:r}=n,[t,u]=p.useState(r.length<=3),[i,d]=p.useState(r.length<=3);return e.jsxs(W,{row:!0,children:[e.jsx(I,{menuItems:[{label:"Synteny track selectors",type:"subMenu",subMenu:r.slice(0,-1).map((a,c)=>({label:`Row ${c+1}->${c+2} (${r[c].assemblyNames.join(",")}->${r[c+1].assemblyNames.join(",")})`,onClick:()=>{n.activateTrackSelector(c)}}))},{label:"Row track selectors",type:"subMenu",subMenu:r.map((a,c)=>({label:`Row ${c+1} track selector (${a.assemblyNames.join(",")})`,onClick:()=>a.activateTrackSelector()}))}],children:e.jsx(Z.TrackSelector,{})}),e.jsx(I,{menuItems:[{label:"Row view menus",type:"subMenu",subMenu:r.map((a,c)=>({label:`View ${c+1} Menu`,subMenu:a.menuItems()}))},...n.headerMenuItems()],children:e.jsx(ee,{})}),e.jsx(I,{menuItems:[{label:"Show search boxes",type:"checkbox",checked:t,onClick:()=>{u(!t)}},{label:"Orientation - Side-by-side",type:"radio",checked:i,onClick:()=>{d(!i)}},{label:"Orientation - Vertical",type:"radio",checked:!i,onClick:()=>{d(!i)}}],children:e.jsx(ne,{})}),t?e.jsx("span",{className:i?o.inline:void 0,children:r.map(a=>e.jsx(ae,{view:a},a.id))}):null]})}),_=v()({container:{display:"grid"},overlay:{zIndex:100,gridArea:"1/1"},resizeHandle:{height:4,background:"#ccc"}});function le({view:n}){const{pluginManager:o}=S.getEnv(n),{ReactComponent:r}=o.getViewType(n.type);return e.jsx(r,{model:n})}const ue=b(function({model:n}){const{classes:o}=_(),{views:r,levels:t}=n;return e.jsx("div",{className:o.container,children:r.map((u,i)=>e.jsxs(e.Fragment,{children:[i>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:o.container,children:e.jsx(de,{model:n,level:i-1})}),e.jsx(V.ResizeHandle,{onDrag:d=>{var a,c;return(a=t[i-1])===null||a===void 0?void 0:a.setHeight((((c=t[i-1])===null||c===void 0?void 0:c.height)||0)+d)},className:o.resizeHandle})]}):null,e.jsx(le,{view:u})]},u.id))})}),de=b(function({model:n,level:o}){var r;const{classes:t}=_();return e.jsx(e.Fragment,{children:(r=n.levels[o])===null||r===void 0?void 0:r.tracks.map(u=>{const[i]=u.displays,{RenderingComponent:d}=i,a=te.getConf(u,"trackId");return d?e.jsx("div",{className:t.overlay,style:{height:i.height,overflow:"hidden"},children:e.jsx(d,{model:i})},a):null})})}),pe=v()({guide:{pointerEvents:"none",height:"100%",width:1,position:"absolute",background:"red",zIndex:1001}}),fe=b(function({model:n,coordX:o}){const{classes:r}=pe();return e.jsx(se,{open:!0,placement:"top",title:n.views.map(t=>t.pxToBp(o)).map((t,u)=>e.jsx("div",{children:S.stringify(t,!0)},[JSON.stringify(t),u].join("-"))),arrow:!0,children:e.jsx("div",{className:r.guide,style:{left:o}})})}),he=v()(n=>({rubberband:{height:"100%",background:oe(n.palette.tertiary.main,.7),position:"absolute",zIndex:900,textAlign:"center",overflow:"hidden"},rubberbandControl:{cursor:"crosshair",width:"100%",minHeight:8},rubberbandText:{color:n.palette.tertiary.contrastText},popover:{mouseEvents:"none",cursor:"crosshair"},paper:{paddingLeft:n.spacing(1),paddingRight:n.spacing(1)}})),be=b(function({model:o,ControlComponent:r=e.jsx("div",{})}){const[t,u]=p.useState(),[i,d]=p.useState(),[a,c]=p.useState(),[T,C]=p.useState(),m=p.useRef(null),M=p.useRef(null),{classes:f}=he(),j=t!==void 0&&a===void 0;p.useEffect(()=>{function s(y,h){if(t===void 0)return;let g=t,x=y;x<g&&([g,x]=[x,g]);const k=h.pxToBp(g),B=h.pxToBp(x);return{leftOffset:k,rightOffset:B}}function l(y){if(m.current&&j){const h=y.clientX-m.current.getBoundingClientRect().left;d(h)}}function z(y){if(t!==void 0&&m.current){const{clientX:h,clientY:g}=y,x=m.current,k=h-x.getBoundingClientRect().left;c({offsetX:k,clientX:h,clientY:g}),H(()=>{for(const B of o.views){const P=s(k,B);if(P){const{leftOffset:q,rightOffset:K}=P;B.setOffsets(q,K)}}}),C(void 0)}}return j?(window.addEventListener("mousemove",l),window.addEventListener("mouseup",z),()=>{window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",z)}):()=>{}},[t,j,o]),p.useEffect(()=>{!j&&i!==void 0&&t!==void 0&&Math.abs(i-t)<=3&&R()},[j,i,t]);function X(s){s.preventDefault(),s.stopPropagation();const l=s.clientX-s.target.getBoundingClientRect().left;u(l),d(l)}function $(s){const l=s.target;C(s.clientX-l.getBoundingClientRect().left)}function F(){C(void 0),H(()=>{for(const s of o.views)s.setOffsets(void 0,void 0)})}function R(){c(void 0),u(void 0),d(void 0)}const A=!!a;function G(s,l){l(),R()}if(t===void 0)return e.jsxs(e.Fragment,{children:[T!==void 0?e.jsx(fe,{model:o,coordX:T}):null,e.jsx("div",{ref:m,className:f.rubberbandControl,onMouseDown:X,onMouseOut:F,onMouseMove:$,children:r})]});const L=a?a.offsetX:i||0,N=Math.min(L,t),O=Math.abs(L-t),{views:E}=o,J=E.map(s=>s.pxToBp(N)),U=E.map(s=>s.pxToBp(N+O)),Y=E.map(s=>Math.ceil(O*s.bpPerPx));return e.jsxs(e.Fragment,{children:[M.current?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:f.popover,classes:{paper:f.paper},open:!0,anchorEl:M.current,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"right"},keepMounted:!0,disableRestoreFocus:!0,children:J.map((s,l)=>e.jsx(w,{children:S.stringify(s,!0)},[JSON.stringify(s),l,"left"].join("-")))}),e.jsx(D,{className:f.popover,classes:{paper:f.paper},open:!0,anchorEl:M.current,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,disableRestoreFocus:!0,children:U.map((s,l)=>e.jsx(w,{children:S.stringify(s,!0)},[JSON.stringify(s),l,"right"].join("-")))})]}):null,e.jsx("div",{ref:M,className:f.rubberband,style:{left:N,width:O},children:e.jsx(w,{variant:"h6",className:f.rubberbandText,children:Y.map((s,l)=>e.jsx(w,{children:`${s.toLocaleString("en-US")}bp`},`${s}_${l}`))})}),e.jsx("div",{className:f.rubberbandControl,ref:m,onMouseDown:X,onMouseOut:F,onMouseMove:$,children:r}),a?e.jsx(V.Menu,{anchorReference:"anchorPosition",anchorPosition:{left:a.clientX,top:a.clientY},onMenuItemClick:G,open:A,onClose:R,menuItems:o.rubberBandMenuItems()}):null]})}),me=v()(n=>({rubberbandContainer:{position:"relative",overflow:"hidden"},rubberbandDiv:{width:"100%",background:n.palette.action.disabledBackground,height:15,"&:hover":{background:n.palette.action.selected}}})),xe=b(function({model:n}){const{classes:o}=me();return e.jsxs("div",{className:o.rubberbandContainer,children:[e.jsx(ce,{model:n}),e.jsx(be,{model:n,ControlComponent:e.jsx("div",{className:o.rubberbandDiv})}),e.jsx(ue,{model:n})]})});export{xe as default};
//# sourceMappingURL=LinearComparativeView-AQYoYNvc.js.map
