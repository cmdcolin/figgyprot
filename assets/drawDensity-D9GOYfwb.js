import{y as c,aF as S,$ as T,u as j,aH as y}from"./index-DQP-8m57.js";const k=.3,x=2;function G(t,E){const{stopToken:u,features:g,regions:F,bpPerPx:d,scaleOpts:s,height:i,config:n}=E,C=F[0],I=c.readConfObject(n,"bicolorPivot"),M=c.readConfObject(n,"bicolorPivotValue"),N=c.readConfObject(n,"negColor"),b=c.readConfObject(n,"posColor"),V=c.readConfObject(n,"color"),R=c.readConfObject(n,"clipColor"),h=I!=="none"&&s.scaleType!=="log",H=S({...s,pivotValue:h?M:void 0,range:h?[N,"#eee",b]:["#eee",b]}),_=S({...s,range:[0,i]}),A=V==="#f0f"?(o,e)=>H(e):(o,e)=>c.readConfObject(n,"color",{feature:o,score:e}),m=_.domain(),P=m[0],v=m[1];let w=Number.NEGATIVE_INFINITY,p=!1;const O=[];let a=performance.now();for(const o of g.values()){performance.now()-a>400&&(T.checkStopToken(u),a=performance.now());const[e,f]=j.featureSpanPx(o,C,d);(Math.floor(e)!==Math.floor(w)||f-e>1)&&(O.push(o),w=e);const r=o.get("score");p=p||r>v||r<P;const l=f-e+k;r>=s.domain[0]?(t.fillStyle=A(o,r),t.fillRect(e,0,l,i)):(t.fillStyle="#eee",t.fillRect(e,0,l,i))}if(t.save(),p){t.fillStyle=R;for(const o of g.values()){performance.now()-a>400&&(T.checkStopToken(u),a=performance.now());const[e,f]=j.featureSpanPx(o,C,d),r=f-e+k,l=o.get("score");l>v?y(e,0,r,x,t):l<P&&s.scaleType!=="log"&&y(e,0,r,x,t)}}return t.restore(),{reducedFeatures:O}}export{G as drawDensity};
//# sourceMappingURL=drawDensity-D9GOYfwb.js.map
