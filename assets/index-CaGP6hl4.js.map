{"version":3,"file":"index-CaGP6hl4.js","sources":["../../node_modules/@jbrowse/plugin-bed/node_modules/@jbrowse/core/data_adapters/BaseAdapter/util.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@jbrowse/core/data_adapters/BaseAdapter/types.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@jbrowse/core/util/idMaker.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@jbrowse/core/data_adapters/BaseAdapter/BaseAdapter.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@jbrowse/core/util/rxjs.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@jbrowse/core/util/stats.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@jbrowse/core/data_adapters/BaseAdapter/BaseFeatureDataAdapter.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@jbrowse/core/data_adapters/BaseAdapter/BaseSequenceAdapter.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@jbrowse/core/data_adapters/BaseAdapter/index.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@gmod/http-range-fetcher/esm/cacheSemantics.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@gmod/http-range-fetcher/esm/aggregatingFetcher.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@gmod/http-range-fetcher/esm/crossFetchBinaryRange.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@gmod/http-range-fetcher/esm/util.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@gmod/http-range-fetcher/esm/httpRangeFetcher.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@jbrowse/core/util/io/RemoteFileWithRangeCache.js","../../node_modules/@jbrowse/plugin-bed/node_modules/@jbrowse/core/util/io/index.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isSequenceAdapter = isSequenceAdapter;\nexports.isRegionsAdapter = isRegionsAdapter;\nexports.isFeatureAdapter = isFeatureAdapter;\nexports.isRefNameAliasAdapter = isRefNameAliasAdapter;\nexports.isTextSearchAdapter = isTextSearchAdapter;\nfunction isSequenceAdapter(t) {\n    return 'getRegions' in t && 'getFeatures' in t;\n}\nfunction isRegionsAdapter(t) {\n    return 'getRegions' in t;\n}\nfunction isFeatureAdapter(t) {\n    return 'getFeatures' in t;\n}\nfunction isRefNameAliasAdapter(t) {\n    return 'getRefNameAliases' in t;\n}\nfunction isTextSearchAdapter(t) {\n    return 'searchIndex' in t;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = idMaker;\nconst _1 = require(\"./\");\nfunction idMaker(args, id = '', len = 5000) {\n    const stack = [args];\n    while (stack.length) {\n        const obj = stack.pop();\n        for (const [key, val] of Object.entries(obj)) {\n            if (id.length > len) {\n                return (0, _1.hashCode)(id);\n            }\n            else {\n                if (typeof val === 'object' && val !== null) {\n                    stack.push(val);\n                }\n                else {\n                    id += `${key}-${val}`;\n                }\n            }\n        }\n    }\n    return `adp-${(0, _1.hashCode)(id)}`;\n}\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BaseAdapter = void 0;\nconst mobx_state_tree_1 = require(\"mobx-state-tree\");\nconst configuration_1 = require(\"../../configuration\");\nconst idMaker_1 = __importDefault(require(\"../../util/idMaker\"));\nconst EmptyConfig = (0, configuration_1.ConfigurationSchema)('empty', {});\nclass BaseAdapter {\n    constructor(config = EmptyConfig.create(), getSubAdapter, pluginManager) {\n        this.config = config;\n        this.getSubAdapter = getSubAdapter;\n        this.pluginManager = pluginManager;\n        if (typeof jest === 'undefined') {\n            const data = (0, mobx_state_tree_1.isStateTreeNode)(config) ? (0, mobx_state_tree_1.getSnapshot)(config) : config;\n            this.id = `${(0, idMaker_1.default)(data)}`;\n        }\n        else {\n            this.id = 'test';\n        }\n    }\n    getConf(arg) {\n        return (0, configuration_1.readConfObject)(this.config, arg);\n    }\n}\nexports.BaseAdapter = BaseAdapter;\nBaseAdapter.capabilities = [];\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ObservableCreate = ObservableCreate;\nconst rxjs_1 = require(\"rxjs\");\nconst stopToken_1 = require(\"./stopToken\");\nfunction ObservableCreate(func, stopToken) {\n    (0, stopToken_1.checkStopToken)(stopToken);\n    return new rxjs_1.Observable((observer) => {\n        try {\n            const ret = func(observer);\n            if (ret === null || ret === void 0 ? void 0 : ret.catch) {\n                ret.catch((error) => {\n                    observer.error(error);\n                });\n            }\n        }\n        catch (error) {\n            observer.error(error);\n        }\n    });\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.calcStdFromSums = calcStdFromSums;\nexports.rectifyStats = rectifyStats;\nexports.scoresToStats = scoresToStats;\nexports.blankStats = blankStats;\nconst rxjs_1 = require(\"rxjs\");\nconst operators_1 = require(\"rxjs/operators\");\nfunction calcStdFromSums(sum, sumSquares, n, population = false) {\n    if (n === 0) {\n        return 0;\n    }\n    let variance;\n    if (population) {\n        variance = sumSquares / n - (sum * sum) / (n * n);\n    }\n    else {\n        variance = sumSquares - (sum * sum) / n;\n        if (n > 1) {\n            variance /= n - 1;\n        }\n    }\n    return variance < 0 ? 0 : Math.sqrt(variance);\n}\nfunction rectifyStats(s) {\n    return {\n        ...s,\n        scoreMean: (s.scoreSum || 0) / (s.featureCount || s.basesCovered || 1),\n        scoreStdDev: calcStdFromSums(s.scoreSum, s.scoreSumSquares, s.featureCount || s.basesCovered),\n        featureDensity: (s.featureCount || 1) / s.basesCovered,\n    };\n}\nasync function scoresToStats(region, feats) {\n    const { start, end } = region;\n    const seed = {\n        scoreMin: Number.MAX_VALUE,\n        scoreMax: Number.MIN_VALUE,\n        scoreSum: 0,\n        scoreSumSquares: 0,\n        featureCount: 0,\n    };\n    let found = false;\n    const { scoreMin, scoreMax, scoreSum, scoreSumSquares, featureCount } = await (0, rxjs_1.firstValueFrom)(feats.pipe((0, operators_1.reduce)((acc, f) => {\n        const s = f.get('score');\n        const summary = f.get('summary');\n        const { scoreMax, scoreMin } = acc;\n        acc.scoreMax = Math.max(scoreMax, summary ? f.get('maxScore') : s);\n        acc.scoreMin = Math.min(scoreMin, summary ? f.get('minScore') : s);\n        acc.scoreSum += s;\n        acc.scoreSumSquares += s * s;\n        acc.featureCount += 1;\n        found = true;\n        return acc;\n    }, seed)));\n    return found\n        ? rectifyStats({\n            scoreMax,\n            scoreMin,\n            scoreSum,\n            scoreSumSquares,\n            featureCount,\n            basesCovered: end - start + 1,\n        })\n        : blankStats();\n}\nfunction blankStats() {\n    return {\n        scoreMin: 0,\n        scoreMax: 0,\n        scoreMean: 0,\n        scoreStdDev: 0,\n        scoreSum: 0,\n        scoreSumSquares: 0,\n        featureCount: 0,\n        featureDensity: 0,\n        basesCovered: 0,\n    };\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BaseFeatureDataAdapter = void 0;\nconst rxjs_1 = require(\"rxjs\");\nconst operators_1 = require(\"rxjs/operators\");\nconst BaseAdapter_1 = require(\"./BaseAdapter\");\nconst util_1 = require(\"../../util\");\nconst rxjs_2 = require(\"../../util/rxjs\");\nconst stats_1 = require(\"../../util/stats\");\nconst stopToken_1 = require(\"../../util/stopToken\");\nclass BaseFeatureDataAdapter extends BaseAdapter_1.BaseAdapter {\n    async getHeader(_opts) {\n        return null;\n    }\n    async getMetadata(_opts) {\n        return null;\n    }\n    getFeaturesInRegion(region, opts = {}) {\n        return (0, rxjs_2.ObservableCreate)(async (observer) => {\n            const hasData = await this.hasDataForRefName(region.refName, opts);\n            (0, stopToken_1.checkStopToken)(opts.stopToken);\n            if (!hasData) {\n                observer.complete();\n            }\n            else {\n                this.getFeatures(region, opts).subscribe(observer);\n            }\n        });\n    }\n    getFeaturesInMultipleRegions(regions, opts = {}) {\n        return (0, rxjs_1.merge)(...regions.map(region => this.getFeaturesInRegion(region, opts)));\n    }\n    async hasDataForRefName(refName, opts = {}) {\n        const refNames = await this.getRefNames(opts);\n        return refNames.includes(refName);\n    }\n    async getRegionQuantitativeStats(region, opts) {\n        const feats = this.getFeatures(region, opts);\n        return (0, stats_1.scoresToStats)(region, feats);\n    }\n    async getMultiRegionQuantitativeStats(regions = [], opts) {\n        if (!regions.length) {\n            return (0, stats_1.blankStats)();\n        }\n        const feats = await Promise.all(regions.map(region => this.getRegionQuantitativeStats(region, opts)));\n        const scoreMax = (0, util_1.max)(feats.map(a => a.scoreMax));\n        const scoreMin = (0, util_1.min)(feats.map(a => a.scoreMin));\n        const scoreSum = (0, util_1.sum)(feats.map(a => a.scoreSum));\n        const scoreSumSquares = (0, util_1.sum)(feats.map(a => a.scoreSumSquares));\n        const featureCount = (0, util_1.sum)(feats.map(a => a.featureCount));\n        const basesCovered = (0, util_1.sum)(feats.map(a => a.basesCovered));\n        return (0, stats_1.rectifyStats)({\n            scoreMin,\n            scoreMax,\n            featureCount,\n            basesCovered,\n            scoreSumSquares,\n            scoreSum,\n        });\n    }\n    getRegionFeatureDensityStats(region, opts) {\n        let lastTime = +Date.now();\n        const statsFromInterval = async (length, expansionTime) => {\n            const { start, end } = region;\n            const sampleCenter = start * 0.75 + end * 0.25;\n            const features = await (0, rxjs_1.firstValueFrom)(this.getFeatures({\n                ...region,\n                start: Math.max(0, Math.round(sampleCenter - length / 2)),\n                end: Math.min(Math.round(sampleCenter + length / 2), end),\n            }, opts).pipe((0, operators_1.toArray)()));\n            return maybeRecordStats({\n                interval: length,\n                statsSampleFeatures: features.length,\n                expansionTime,\n                stats: {\n                    featureDensity: features.length / length,\n                },\n            });\n        };\n        const maybeRecordStats = async ({ interval, stats, statsSampleFeatures, expansionTime, }) => {\n            const refLen = region.end - region.start;\n            if (statsSampleFeatures >= 70 || interval * 2 > refLen) {\n                return stats;\n            }\n            else if (expansionTime <= 5000) {\n                const currTime = +Date.now();\n                expansionTime += currTime - lastTime;\n                lastTime = currTime;\n                return statsFromInterval(interval * 2, expansionTime);\n            }\n            else {\n                console.warn(\"Stats estimation reached timeout, or didn't get enough features\");\n                return { featureDensity: Number.POSITIVE_INFINITY };\n            }\n        };\n        return statsFromInterval(1000, 0);\n    }\n    async getMultiRegionFeatureDensityStats(regions, opts) {\n        if (!regions.length) {\n            throw new Error('No regions supplied');\n        }\n        return this.getRegionFeatureDensityStats(regions[0], opts);\n    }\n    async getSources(regions) {\n        const features = await (0, rxjs_1.firstValueFrom)(this.getFeaturesInMultipleRegions(regions).pipe((0, operators_1.toArray)()));\n        const sources = new Set();\n        for (const f of features) {\n            sources.add(f.get('source'));\n        }\n        return [...sources].map(source => ({\n            name: source,\n        }));\n    }\n}\nexports.BaseFeatureDataAdapter = BaseFeatureDataAdapter;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BaseSequenceAdapter = void 0;\nconst BaseFeatureDataAdapter_1 = require(\"./BaseFeatureDataAdapter\");\nclass BaseSequenceAdapter extends BaseFeatureDataAdapter_1.BaseFeatureDataAdapter {\n    async getMultiRegionFeatureDensityStats() {\n        return { featureDensity: 0 };\n    }\n}\nexports.BaseSequenceAdapter = BaseSequenceAdapter;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BaseSequenceAdapter = exports.BaseFeatureDataAdapter = exports.BaseAdapter = void 0;\n__exportStar(require(\"./util\"), exports);\n__exportStar(require(\"./types\"), exports);\nvar BaseAdapter_1 = require(\"./BaseAdapter\");\nObject.defineProperty(exports, \"BaseAdapter\", { enumerable: true, get: function () { return BaseAdapter_1.BaseAdapter; } });\nvar BaseFeatureDataAdapter_1 = require(\"./BaseFeatureDataAdapter\");\nObject.defineProperty(exports, \"BaseFeatureDataAdapter\", { enumerable: true, get: function () { return BaseFeatureDataAdapter_1.BaseFeatureDataAdapter; } });\nvar BaseSequenceAdapter_1 = require(\"./BaseSequenceAdapter\");\nObject.defineProperty(exports, \"BaseSequenceAdapter\", { enumerable: true, get: function () { return BaseSequenceAdapter_1.BaseSequenceAdapter; } });\n","export function parseCacheControl(field) {\n    if (typeof field !== 'string') {\n        return {};\n    }\n    const parsed = {};\n    const invalid = field.toLowerCase().replace(\n    // eslint-disable-next-line no-control-regex\n    /(?:^|(?:\\s*,\\s*))([^\\x00-\\x20\\(\\)<>@\\,;\\:\\\\\"\\/\\[\\]\\?\\=\\{\\}\\x7F]+)(?:\\=(?:([^\\x00-\\x20\\(\\)<>@\\,;\\:\\\\\"\\/\\[\\]\\?\\=\\{\\}\\x7F]+)|(?:\\\"((?:[^\"\\\\]|\\\\.)*)\\\")))?/g, (match, fieldName, three, four) => {\n        const value = three || four;\n        parsed[fieldName] = value ? value.toLowerCase() : true;\n        return '';\n    });\n    if (invalid) {\n        return {};\n    }\n    // parse any things that seem to be numbers\n    Object.keys(parsed).forEach(key => {\n        if (/^[\\d]+$/.test(`${parsed[key]}`)) {\n            try {\n                const num = parseInt(`${parsed[key]}`, 10);\n                if (!Number.isNaN(num)) {\n                    parsed[key] = num;\n                }\n            }\n            catch (e) {\n                /* ignore */\n            }\n        }\n    });\n    return parsed;\n}\nexport class CacheSemantics {\n    constructor({ minimumTTL }) {\n        this.minimumTTL = minimumTTL;\n    }\n    calculateChunkExpirationDate(chunkResponse) {\n        const { headers = {}, requestDate, responseDate, } = chunkResponse;\n        const { date, pragma } = headers;\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        let baselineDate = responseDate || requestDate;\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        if (!baselineDate) {\n            if (!date) {\n                return undefined;\n            }\n            baselineDate = new Date(date);\n        }\n        const basePlus = (ttl) => new Date(baselineDate.getTime() + ttl);\n        // results that are not really cacheable expire after the minimum time to live\n        if (/\\bno-cache\\b/.test(pragma || '')) {\n            return basePlus(this.minimumTTL);\n        }\n        const cacheControl = parseCacheControl(headers['cache-control'] || '');\n        if (cacheControl['no-cache'] ||\n            cacheControl['no-store'] ||\n            cacheControl['must-revalidate']) {\n            return basePlus(this.minimumTTL);\n        }\n        if (cacheControl['max-age'] !== undefined) {\n            const ttl = +cacheControl['max-age'] * 1000; // max-age is in seconds\n            return basePlus(Math.max(ttl, this.minimumTTL));\n        }\n        else if (this._coerceToDate(headers.expires)) {\n            return this._coerceToDate(headers.expires);\n        }\n        else if (this._coerceToDate(headers['last-modified'])) {\n            const lastModified = this._coerceToDate(headers['last-modified']);\n            const ttl = (baselineDate.getTime() - (lastModified?.getTime() || 0)) / 10;\n            return basePlus(ttl);\n        }\n        // otherwise, we just cache forever\n        return undefined;\n    }\n    _coerceToDate(thing) {\n        if (thing) {\n            if (thing instanceof Date) {\n                return thing;\n            }\n            if (typeof thing === 'string' || typeof thing === 'number') {\n                return new Date(thing);\n            }\n        }\n        return undefined;\n    }\n    /**\n     * check whether a cached chunk response is still valid and can be used\n     */\n    cachedChunkIsValid(chunkResponse) {\n        const expiration = this.calculateChunkExpirationDate(chunkResponse);\n        return !expiration || new Date() <= expiration;\n    }\n    /**\n     * check whether the response for this chunk fetch can be cached (always\n     * returns true now)\n     */\n    chunkIsCacheable(_arg) {\n        // right now, we are caching everything, we just give it a very short\n        // time to live if it's not supposed to be cached\n        return true;\n    }\n}\n//# sourceMappingURL=cacheSemantics.js.map","/**\n * takes fetch requests and aggregates them at a certain time frequency\n */\nexport default class AggregatingFetcher {\n    /**\n     *\n     * @param params\n     * @param [params.frequency] number of milliseconds to wait for requests to aggregate\n     */\n    constructor({ fetch, frequency = 100, maxExtraSize = 32000, maxFetchSize = 1000000, }) {\n        this.requestQueues = {}; // url => array of requests\n        this.fetchCallback = fetch;\n        this.frequency = frequency;\n        this.maxExtraSize = maxExtraSize;\n        this.maxFetchSize = maxFetchSize;\n    }\n    _canAggregate(requestGroup, request) {\n        return (\n        // the fetches overlap, or come close\n        request.start <= requestGroup.end + this.maxExtraSize &&\n            // aggregating would not result in a fetch that is too big\n            request.end - request.start + requestGroup.end - requestGroup.start <\n                this.maxFetchSize);\n    }\n    // returns a promise that only resolves when all of the signals in the given\n    // array have fired their abort signal\n    _allSignalsFired(signals) {\n        return new Promise(resolve => {\n            let signalsLeft = signals.filter(s => !s.aborted).length;\n            signals.forEach(signal => {\n                signal.addEventListener('abort', () => {\n                    signalsLeft -= 1;\n                    if (!signalsLeft) {\n                        resolve();\n                    }\n                });\n            });\n        }).catch((e) => {\n            console.error(e);\n        });\n    }\n    // dispatch a request group as a single request and then slice the result\n    // back up to satisfy the individual requests\n    _dispatch({ url, start, end, requests }) {\n        // if any of the requests have an AbortSignal `signal` in their\n        // requestOptions, make our aggregating abortcontroller track it, aborting\n        // the request if all of the abort signals that are aggregated here have\n        // fired\n        const abortWholeRequest = new AbortController();\n        const signals = [];\n        requests.forEach(({ requestOptions }) => {\n            if (requestOptions.signal) {\n                signals.push(requestOptions.signal);\n            }\n        });\n        if (signals.length === requests.length) {\n            // may need review\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\n            this._allSignalsFired(signals).then(() => {\n                abortWholeRequest.abort();\n            });\n        }\n        this.fetchCallback(url, start, end - 1, {\n            signal: abortWholeRequest.signal,\n        })\n            .then(response => {\n            const data = response.buffer;\n            requests.forEach(({ start: reqStart, end: reqEnd, resolve }) => {\n                resolve({\n                    headers: response.headers,\n                    buffer: data.subarray(reqStart - start, reqEnd - start),\n                });\n            });\n        })\n            .catch((err) => {\n            requests.forEach(({ reject }) => {\n                reject(err);\n            });\n        });\n    }\n    _aggregateAndDispatch() {\n        Object.entries(this.requestQueues).forEach(([url, requests]) => {\n            if (!requests.length) {\n                return;\n            }\n            // we are now going to aggregate the requests in this url's queue into\n            // groups of requests that can be dispatched as one\n            const requestsToDispatch = [];\n            // look to see if any of the requests are aborted, and if they are, just\n            // reject them now and forget about them\n            requests.forEach(request => {\n                const { requestOptions, reject } = request;\n                if (requestOptions.signal?.aborted) {\n                    reject(Object.assign(new Error('aborted'), { code: 'ERR_ABORTED' }));\n                }\n                else {\n                    requestsToDispatch.push(request);\n                }\n            });\n            requestsToDispatch.sort((a, b) => a.start - b.start);\n            requests.length = 0;\n            if (!requestsToDispatch.length) {\n                return;\n            }\n            let currentRequestGroup;\n            for (const next of requestsToDispatch) {\n                if (currentRequestGroup &&\n                    this._canAggregate(currentRequestGroup, next)) {\n                    // aggregate it into the current group\n                    currentRequestGroup.requests.push(next);\n                    currentRequestGroup.end = next.end;\n                }\n                else {\n                    // out of range, dispatch the current request group\n                    if (currentRequestGroup) {\n                        this._dispatch(currentRequestGroup);\n                    }\n                    // and start on a new one\n                    currentRequestGroup = {\n                        requests: [next],\n                        url,\n                        start: next.start,\n                        end: next.end,\n                    };\n                }\n            }\n            if (currentRequestGroup) {\n                this._dispatch(currentRequestGroup);\n            }\n        });\n    }\n    _enQueue(url, request) {\n        if (!this.requestQueues[url]) {\n            this.requestQueues[url] = [];\n        }\n        this.requestQueues[url].push(request);\n    }\n    /**\n     *\n     * @param url\n     * @param start 0-based half-open\n     * @param end 0-based half-open\n     * @param [requestOptions] options passed to the underlying fetch call\n     */\n    fetch(url, start, end, requestOptions = {}) {\n        return new Promise((resolve, reject) => {\n            this._enQueue(url, { start, end, resolve, reject, requestOptions });\n            if (!this.timeout) {\n                this.timeout = setTimeout(() => {\n                    this.timeout = undefined;\n                    this._aggregateAndDispatch();\n                }, this.frequency || 1);\n            }\n        });\n    }\n}\n//# sourceMappingURL=aggregatingFetcher.js.map","export default async function crossFetchBinaryRange(url, start, end, options = {}) {\n    const requestDate = new Date();\n    const fetchOptions = Object.assign({\n        method: 'GET',\n        headers: { range: `bytes=${start}-${end}` },\n    }, options);\n    const res = await fetch(url, fetchOptions);\n    const responseDate = new Date();\n    if (res.status !== 206 && res.status !== 200) {\n        throw new Error(`HTTP ${res.status} when fetching ${url} bytes ${start}-${end}`);\n    }\n    if (res.status === 200) {\n        // TODO: check that the response satisfies the byte range,\n        // and is not too big (check maximum size),\n        // because we actually ended up getting served the whole file\n        throw new Error(`HTTP ${res.status} when fetching ${url} bytes ${start}-${end}`);\n    }\n    const buffer = new Uint8Array(await res.arrayBuffer());\n    // return the response headers, and the data buffer\n    return {\n        // @ts-expect-error needs audit\n        headers: res.headers.map,\n        requestDate,\n        responseDate,\n        buffer,\n    };\n}\n//# sourceMappingURL=crossFetchBinaryRange.js.map","export function sum(array) {\n    let sum = 0;\n    for (const entry of array) {\n        sum += entry.length;\n    }\n    return sum;\n}\nexport function concatUint8Array(args) {\n    const mergedArray = new Uint8Array(sum(args));\n    let offset = 0;\n    for (const entry of args) {\n        mergedArray.set(entry, offset);\n        offset += entry.length;\n    }\n    return mergedArray;\n}\n//# sourceMappingURL=util.js.map","import LRU from 'quick-lru';\nimport { CacheSemantics } from './cacheSemantics';\nimport AggregatingFetcher from './aggregatingFetcher';\nimport crossFetchBinaryRange from './crossFetchBinaryRange';\nimport { concatUint8Array } from './util';\n/**\n * check if the given exception was caused by an operation being intentionally aborted\n * @param {Error} exception\n * @returns {boolean}\n */\nfunction isAbortException(exception) {\n    return (\n    // DOMException\n    exception.name === 'AbortError' ||\n        // standard-ish non-DOM abort exception\n        // @ts-ignore\n        exception.code === 'ERR_ABORTED' ||\n        // message contains aborted for bubbling through RPC\n        // things we have seen that we want to catch here\n        // Error: aborted\n        // AbortError: aborted\n        // AbortError: The user aborted a request.\n        !!exception.message.match(/\\b(aborted|AbortError)\\b/i));\n}\n// TODO: fire events when a remote file is detected as having been changed\n/**\n * smart cache that fetches chunks of remote files.\n * caches chunks in an LRU cache, and aggregates upstream fetches\n */\nexport default class HttpRangeFetcher {\n    constructor({ fetch = crossFetchBinaryRange, size = 10000000, chunkSize = 32768, aggregationTime = 100, minimumTTL = 1000, maxFetchSize = chunkSize * 4, maxExtraFetch = chunkSize, }) {\n        this.aggregator = new AggregatingFetcher({\n            fetch,\n            frequency: aggregationTime,\n            maxFetchSize,\n            maxExtraSize: maxExtraFetch,\n        });\n        this.chunkSize = chunkSize;\n        this.chunkCache = new LRU({ maxSize: Math.floor(size / chunkSize) || 1 });\n        this.cacheSemantics = new CacheSemantics({ minimumTTL });\n        this.stats = new LRU({ maxSize: 20 });\n    }\n    async getRange(key, position, length, options = {}) {\n        // calculate the list of chunks involved in this fetch\n        const firstChunk = Math.floor(position / this.chunkSize);\n        const lastChunk = Math.floor((position + length - 1) / this.chunkSize);\n        // fetch them all as necessary\n        const fetches = new Array(lastChunk - firstChunk + 1);\n        for (let chunk = firstChunk; chunk <= lastChunk; chunk += 1) {\n            fetches[chunk - firstChunk] = this._getChunk(key, chunk, options).then(res => res && {\n                headers: res.headers,\n                buffer: res.buffer,\n                chunkNumber: chunk,\n            });\n        }\n        // return a \"composite buffer\" that lets the array of chunks be accessed like a flat buffer\n        let chunkResponses = await Promise.all(fetches);\n        chunkResponses = chunkResponses.filter(r => !!r); // filter out any undefined (out of range) responses\n        if (!chunkResponses.length) {\n            return {\n                headers: {},\n                buffer: new Uint8Array(0),\n            };\n        }\n        const chunksOffset = position - chunkResponses[0].chunkNumber * this.chunkSize;\n        return {\n            headers: this._makeHeaders(chunkResponses[0].headers, position, position + length - 1),\n            buffer: this._makeBuffer(chunkResponses, chunksOffset, length),\n        };\n    }\n    _makeBuffer(chunkResponses, chunksOffset, length) {\n        if (chunkResponses.length === 1) {\n            return chunkResponses[0].buffer.slice(chunksOffset, chunksOffset + length);\n        }\n        else if (chunkResponses.length === 0) {\n            return new Uint8Array(0);\n        }\n        else {\n            // 2 or more buffers\n            const buffers = chunkResponses.map(r => r.buffer);\n            const first = buffers.shift().slice(chunksOffset);\n            let last = buffers.pop();\n            let trimEnd = first.length +\n                buffers.reduce((sum, buf) => sum + buf.length, 0) +\n                last.length -\n                length;\n            if (trimEnd < 0) {\n                trimEnd = 0;\n            }\n            last = last.slice(0, last.length - trimEnd);\n            return concatUint8Array([first, ...buffers, last]);\n        }\n    }\n    /**\n     * Fetches the first few bytes of the remote file (if necessary) and uses\n     * the returned headers to populate a `fs`-like stat object.\n     *\n     * Currently, this attempts to set `size`, `mtime`, and `mtimeMs`, if\n     * the information is available from HTTP headers.\n     *\n     * @param {string} key\n     * @returns {Promise} for a stats object\n     */\n    async stat(key) {\n        let stat = this.stats.get(key);\n        if (!stat) {\n            const chunk = await this._getChunk(key, 0);\n            if (chunk) {\n                this._recordStatsIfNecessary(key, chunk);\n            }\n            stat = this.stats.get(key);\n            if (!stat) {\n                throw new Error(`failed to retrieve file size for ${key}`);\n            }\n        }\n        return stat;\n    }\n    _headersToStats(chunkResponse) {\n        const { headers } = chunkResponse;\n        const stat = {};\n        if (headers?.['content-range']) {\n            const match = /\\d+-\\d+\\/(\\d+)/.exec(headers['content-range']);\n            if (match) {\n                const r = parseInt(match[1], 10);\n                if (!Number.isNaN(r)) {\n                    stat.size = r;\n                }\n            }\n        }\n        if (headers?.['last-modified']) {\n            stat.mtime = new Date(headers['last-modified']);\n            if (stat.mtime.toString() === 'Invalid Date') {\n                console.warn('Invalid Date');\n                stat.mtime = new Date();\n            }\n            stat.mtimeMs = stat.mtime.getTime();\n        }\n        return stat;\n    }\n    _makeHeaders(originalHeaders, newStart, newEnd) {\n        const headers = { ...originalHeaders };\n        const match = /\\d+-\\d+\\/(\\d+)/.exec(headers['content-range'] || '');\n        return {\n            ...originalHeaders,\n            'content-length': newEnd - newStart,\n            'content-range': `${newStart}-${newEnd - 1}/${match?.[1]}`,\n            'x-resource-length': match?.[1],\n        };\n    }\n    async _getChunk(key, chunkNumber, requestOptions) {\n        const chunkKey = `${key}/${chunkNumber}`;\n        const cachedPromise = this.chunkCache.get(chunkKey);\n        if (cachedPromise) {\n            let chunk;\n            let chunkAborted = false;\n            try {\n                chunk = await cachedPromise;\n            }\n            catch (err) {\n                if (isAbortException(err)) {\n                    // fetch was aborted\n                    chunkAborted = true;\n                }\n                else {\n                    throw err;\n                }\n            }\n            // when the cached chunk is resolved, validate it before returning it.\n            // if invalid or aborted, delete it from the cache and redispatch the request\n            if (\n            // todo: audit whether the chunk && is needed\n            // was introduced during typescriptification\n            chunk &&\n                (chunkAborted || !this.cacheSemantics.cachedChunkIsValid(chunk))) {\n                this._uncacheIfSame(chunkKey, cachedPromise);\n                return this._getChunk(key, chunkNumber, requestOptions);\n            }\n            // gather the stats for the file from the headers\n            if (chunk) {\n                this._recordStatsIfNecessary(key, chunk);\n            }\n            return chunk;\n        }\n        const fetchStart = chunkNumber * this.chunkSize;\n        let fetchEnd = fetchStart + this.chunkSize;\n        // clamp the end of the fetch to the size if we have a cached size for the file\n        const stat = this.stats.get(key);\n        if (stat?.size) {\n            if (fetchStart >= stat.size) {\n                return undefined;\n            }\n            if (fetchEnd >= stat.size) {\n                fetchEnd = stat.size;\n            }\n        }\n        const freshPromise = this.aggregator.fetch(key, fetchStart, fetchEnd, requestOptions).catch((err) => {\n            this._uncacheIfSame(chunkKey, freshPromise);\n            throw err;\n        });\n        this.chunkCache.set(chunkKey, freshPromise);\n        const freshChunk = await freshPromise;\n        // gather the stats for the file from the headers\n        this._recordStatsIfNecessary(key, freshChunk);\n        // remove the promise from the cache if it turns out not to be cacheable.\n        // this is done after the fact because we want multiple requests for the\n        // same chunk to reuse the same cached promise\n        if (!this.cacheSemantics.chunkIsCacheable(freshChunk)) {\n            this._uncacheIfSame(chunkKey, freshPromise);\n        }\n        return freshChunk;\n    }\n    // if the stats for a resource haven't been recorded yet, record them\n    _recordStatsIfNecessary(key, chunk) {\n        if (!this.stats.has(key)) {\n            this.stats.set(key, this._headersToStats(chunk));\n        }\n    }\n    // delete a promise from the cache if it is still in there.\n    // need to check if it is still the same because it might\n    // have been overwritten sometime while the promise was in flight\n    _uncacheIfSame(key, cachedPromise) {\n        if (this.chunkCache.get(key) === cachedPromise) {\n            this.chunkCache.delete(key);\n        }\n    }\n    /**\n     * Throw away all cached data, resetting the cache.\n     */\n    reset() {\n        this.stats.clear();\n        this.chunkCache.clear();\n    }\n}\n//# sourceMappingURL=httpRangeFetcher.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RemoteFileWithRangeCache = void 0;\nexports.clearCache = clearCache;\nconst http_range_fetcher_1 = require(\"@gmod/http-range-fetcher\");\nconst generic_filehandle2_1 = require(\"generic-filehandle2\");\nconst fetchers = {};\nfunction binaryRangeFetch(url, start, end, options = {}) {\n    const fetcher = fetchers[url];\n    if (!fetcher) {\n        throw new Error(`fetch not registered for ${url}`);\n    }\n    return fetcher(url, start, end, options);\n}\nconst globalRangeCache = new http_range_fetcher_1.HttpRangeFetcher({\n    fetch: binaryRangeFetch,\n    size: 500 * 1024 ** 2,\n    chunkSize: 128 * 1024,\n    maxFetchSize: 100 * 1024 ** 2,\n    minimumTTL: 24 * 60 * 60 * 1000,\n});\nfunction clearCache() {\n    globalRangeCache.reset();\n}\nclass RemoteFileWithRangeCache extends generic_filehandle2_1.RemoteFile {\n    async fetch(url, init) {\n        const str = String(url);\n        if (!fetchers[str]) {\n            fetchers[str] = this.fetchBinaryRange.bind(this);\n        }\n        const range = new Headers(init === null || init === void 0 ? void 0 : init.headers).get('range');\n        if (range) {\n            const rangeParse = /bytes=(\\d+)-(\\d+)/.exec(range);\n            if (rangeParse) {\n                const [, start, end] = rangeParse;\n                const s = Number.parseInt(start, 10);\n                const e = Number.parseInt(end, 10);\n                const len = e - s;\n                const { buffer, headers } = (await globalRangeCache.getRange(`${url}`, s, len + 1));\n                return new Response(buffer, {\n                    status: 206,\n                    headers,\n                });\n            }\n        }\n        return super.fetch(url, init);\n    }\n    async fetchBinaryRange(url, start, end, options = {}) {\n        const requestDate = new Date();\n        const res = await super.fetch(url, {\n            ...options,\n            headers: {\n                ...options.headers,\n                range: `bytes=${start}-${end}`,\n            },\n        });\n        const responseDate = new Date();\n        if (!res.ok) {\n            const errorMessage = `HTTP ${res.status} fetching ${url} bytes ${start}-${end}`;\n            const hint = ' (should be 206 for range requests)';\n            throw new Error(`${errorMessage}${res.status === 200 ? hint : ''}`);\n        }\n        const headers = {};\n        for (const [k, v] of res.headers.entries()) {\n            headers[k] = v;\n        }\n        const arrayBuffer = await res.arrayBuffer();\n        return {\n            headers,\n            requestDate,\n            responseDate,\n            buffer: new Uint8Array(arrayBuffer),\n        };\n    }\n}\nexports.RemoteFileWithRangeCache = RemoteFileWithRangeCache;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RemoteFileWithRangeCache = void 0;\nexports.resolveUriLocation = resolveUriLocation;\nexports.openLocation = openLocation;\nexports.getFetcher = getFetcher;\nconst detect_node_1 = __importDefault(require(\"detect-node\"));\nconst generic_filehandle2_1 = require(\"generic-filehandle2\");\nconst RemoteFileWithRangeCache_1 = require(\"./RemoteFileWithRangeCache\");\nconst __1 = require(\"../\");\nconst tracks_1 = require(\"../tracks\");\nconst types_1 = require(\"../types\");\nfunction isLocalPathLocation(location) {\n    return 'localPath' in location;\n}\nfunction isBlobLocation(location) {\n    return 'blobId' in location;\n}\nfunction resolveUriLocation(location) {\n    return location.baseUri\n        ? { ...location, uri: new URL(location.uri, location.baseUri).href }\n        : location;\n}\nfunction openLocation(location, pluginManager) {\n    if (isLocalPathLocation(location)) {\n        if (!location.localPath) {\n            throw new Error('No local path provided');\n        }\n        if (detect_node_1.default || __1.isElectron) {\n            return new generic_filehandle2_1.LocalFile(location.localPath);\n        }\n        else {\n            throw new Error(\"can't use local files in the browser\");\n        }\n    }\n    if (isBlobLocation(location)) {\n        const blob = (0, tracks_1.getBlob)(location.blobId);\n        if (!blob) {\n            throw new Error(`file (\"${location.name}\") was opened locally from a previous session. To restore it, go to track settings and reopen the file`);\n        }\n        return new generic_filehandle2_1.BlobFile(blob);\n    }\n    if ((0, types_1.isUriLocation)(location)) {\n        if (!location.uri) {\n            throw new Error('No URI provided');\n        }\n        const absoluteLocation = resolveUriLocation(location);\n        if (pluginManager) {\n            const internetAccount = getInternetAccount(location, pluginManager);\n            if (internetAccount) {\n                return internetAccount.openLocation(absoluteLocation);\n            }\n        }\n        return new RemoteFileWithRangeCache_1.RemoteFileWithRangeCache(absoluteLocation.uri, {\n            fetch: checkAuthNeededFetch,\n        });\n    }\n    throw new Error('invalid fileLocation');\n}\nfunction getFetcher(location, pluginManager) {\n    if (!(0, types_1.isUriLocation)(location)) {\n        throw new Error(`Not a valid UriLocation: ${JSON.stringify(location)}`);\n    }\n    if (pluginManager) {\n        const internetAccount = getInternetAccount(location, pluginManager);\n        if (internetAccount) {\n            return internetAccount.getFetcher(location);\n        }\n    }\n    return checkAuthNeededFetch;\n}\nfunction getInternetAccount(location, pluginManager) {\n    const { rootModel } = pluginManager;\n    if (rootModel && (0, types_1.isRootModelWithInternetAccounts)(rootModel)) {\n        return rootModel.findAppropriateInternetAccount(location);\n    }\n    if (location.internetAccountPreAuthorization) {\n        if (!location.internetAccountPreAuthorization.authInfo.token) {\n            throw new Error('Failed to obtain token from internet account. Try reloading the page');\n        }\n        return pluginManager\n            .getInternetAccountType(location.internetAccountPreAuthorization.internetAccountType)\n            .stateModel.create({\n            type: location.internetAccountPreAuthorization.internetAccountType,\n            configuration: location.internetAccountPreAuthorization.authInfo.configuration,\n        });\n    }\n    return undefined;\n}\nasync function checkAuthNeededFetch(url, opts) {\n    var _a;\n    const response = await fetch(url, opts);\n    if (response.status === 401 &&\n        ((_a = response.headers.get('WWW-Authenticate')) === null || _a === void 0 ? void 0 : _a.includes('Basic'))) {\n        throw new types_1.AuthNeededError('Accessing HTTPBasic resource without authentication', url.toString());\n    }\n    return response;\n}\nvar RemoteFileWithRangeCache_2 = require(\"./RemoteFileWithRangeCache\");\nObject.defineProperty(exports, \"RemoteFileWithRangeCache\", { enumerable: true, get: function () { return RemoteFileWithRangeCache_2.RemoteFileWithRangeCache; } });\n"],"names":["util","isSequenceAdapter","isRegionsAdapter","isFeatureAdapter","isRefNameAliasAdapter","isTextSearchAdapter","t","types","idMaker_1","idMaker","_1","require$$0","args","id","len","stack","obj","key","val","__importDefault","this","mod","BaseAdapter_1","mobx_state_tree_1","configuration_1","require$$1","require$$2","EmptyConfig","BaseAdapter","config","getSubAdapter","pluginManager","data","arg","rxjs","ObservableCreate_1","ObservableCreate","rxjs_1","stopToken_1","func","stopToken","observer","ret","error","stats","calcStdFromSums","rectifyStats","scoresToStats","blankStats","operators_1","sum","sumSquares","n","population","variance","s","region","feats","start","end","seed","found","scoreMin","scoreMax","scoreSum","scoreSumSquares","featureCount","acc","f","summary","BaseFeatureDataAdapter_1","util_1","require$$3","rxjs_2","require$$4","stats_1","require$$5","require$$6","BaseFeatureDataAdapter","_opts","opts","hasData","regions","refName","a","basesCovered","lastTime","statsFromInterval","length","expansionTime","sampleCenter","features","maybeRecordStats","interval","statsSampleFeatures","refLen","currTime","sources","source","BaseSequenceAdapter_1","BaseSequenceAdapter","__createBinding","o","m","k","k2","desc","__exportStar","exports","p","parseCacheControl","field","parsed","match","fieldName","three","four","value","num","CacheSemantics","minimumTTL","chunkResponse","headers","requestDate","responseDate","date","pragma","baselineDate","basePlus","ttl","cacheControl","lastModified","thing","expiration","_arg","AggregatingFetcher","fetch","frequency","maxExtraSize","maxFetchSize","requestGroup","request","signals","resolve","signalsLeft","signal","e","url","requests","abortWholeRequest","requestOptions","response","reqStart","reqEnd","err","reject","requestsToDispatch","_a","b","currentRequestGroup","next","crossFetchBinaryRange","options","fetchOptions","res","buffer","array","entry","concatUint8Array","mergedArray","offset","isAbortException","exception","HttpRangeFetcher","size","chunkSize","aggregationTime","maxExtraFetch","LRU","position","firstChunk","lastChunk","fetches","chunk","chunkResponses","r","chunksOffset","buffers","first","last","trimEnd","buf","stat","originalHeaders","newStart","newEnd","chunkNumber","chunkKey","cachedPromise","chunkAborted","fetchStart","fetchEnd","freshPromise","freshChunk","RemoteFileWithRangeCache_1","clearCache","http_range_fetcher_1","generic_filehandle2_1","fetchers","binaryRangeFetch","fetcher","globalRangeCache","RemoteFileWithRangeCache","init","str","range","rangeParse","errorMessage","hint","v","arrayBuffer","resolveUriLocation","openLocation","getFetcher","detect_node_1","__1","tracks_1","types_1","isLocalPathLocation","location","isBlobLocation","blob","absoluteLocation","internetAccount","getInternetAccount","checkAuthNeededFetch","rootModel","RemoteFileWithRangeCache_2"],"mappings":"yJACA,OAAO,eAAeA,EAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EACnCA,EAAA,kBAAGC,GACJD,EAAA,iBAAGE,GACHF,EAAA,iBAAGG,GACEH,EAAA,sBAAGI,GACLJ,EAAA,oBAAGK,GAC9B,SAASJ,GAAkBK,EAAG,CAC1B,MAAO,eAAgBA,GAAK,gBAAiBA,CACjD,CACA,SAASJ,GAAiBI,EAAG,CACzB,MAAO,eAAgBA,CAC3B,CACA,SAASH,GAAiBG,EAAG,CACzB,MAAO,gBAAiBA,CAC5B,CACA,SAASF,GAAsBE,EAAG,CAC9B,MAAO,sBAAuBA,CAClC,CACA,SAASD,GAAoBC,EAAG,CAC5B,MAAO,gBAAiBA,CAC5B,UCpBA,OAAO,eAAeC,EAAS,aAAc,CAAE,MAAO,EAAI,CAAE,gBCA5D,OAAO,eAAeC,EAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EAC7CA,EAAA,QAAGC,GAClB,MAAMC,EAAKC,EAAa,EACxB,SAASF,GAAQG,EAAMC,EAAK,GAAIC,EAAM,IAAM,CACxC,MAAMC,EAAQ,CAACH,CAAI,EACnB,KAAOG,EAAM,QAAQ,CACjB,MAAMC,EAAMD,EAAM,IAAK,EACvB,SAAW,CAACE,EAAKC,CAAG,IAAK,OAAO,QAAQF,CAAG,EAAG,CAC1C,GAAIH,EAAG,OAASC,EACZ,SAAWJ,EAAG,UAAUG,CAAE,EAGtB,OAAOK,GAAQ,UAAYA,IAAQ,KACnCH,EAAM,KAAKG,CAAG,EAGdL,GAAM,GAAGI,CAAG,IAAIC,CAAG,EAGvC,CACA,CACI,MAAO,UAAWR,EAAG,UAAUG,CAAE,CAAC,EACtC,CCtBA,IAAIM,GAAmBC,GAAQA,EAAK,iBAAoB,SAAUC,EAAK,CACnE,OAAQA,GAAOA,EAAI,WAAcA,EAAM,CAAE,QAAWA,CAAK,CAC7D,EACA,OAAO,eAAeC,EAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EACzCA,EAAA,YAAG,OACtB,MAAMC,EAAoBZ,EACpBa,EAAkBC,EAA8B,EAChDjB,GAAYW,GAAgBO,CAA6B,EACzDC,MAAkBH,EAAgB,qBAAqB,QAAS,CAAA,CAAE,EACxE,MAAMI,CAAY,CACd,YAAYC,EAASF,GAAY,OAAM,EAAIG,EAAeC,EAAe,CAIrE,GAHA,KAAK,OAASF,EACd,KAAK,cAAgBC,EACrB,KAAK,cAAgBC,EACjB,OAAO,KAAS,IAAa,CAC7B,MAAMC,KAAWT,EAAkB,iBAAiBM,CAAM,KAAQN,EAAkB,aAAaM,CAAM,EAAIA,EAC3G,KAAK,GAAK,MAAOrB,GAAU,SAASwB,CAAI,CAAC,EACrD,MAEY,KAAK,GAAK,MAEtB,CACI,QAAQC,EAAK,CACT,SAAWT,EAAgB,gBAAgB,KAAK,OAAQS,CAAG,CACnE,CACA,CACmBX,EAAA,YAAGM,EACtBA,EAAY,aAAe,CAAE,gBC3B7B,OAAO,eAAeM,EAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EACpC,IAAAC,GAAAD,EAAA,iBAAGE,GAC3B,MAAMC,GAAS1B,EACT2B,GAAcb,EACpB,SAASW,GAAiBG,EAAMC,EAAW,CACvC,SAAIF,GAAY,gBAAgBE,CAAS,EAClC,IAAIH,GAAO,WAAYI,GAAa,CACvC,GAAI,CACA,MAAMC,EAAMH,EAAKE,CAAQ,EACrBC,GAAQ,MAAkCA,EAAI,OAC9CA,EAAI,MAAOC,GAAU,CACjBF,EAAS,MAAME,CAAK,CACxC,CAAiB,CAEjB,OACeA,EAAO,CACVF,EAAS,MAAME,CAAK,CAChC,CACA,CAAK,CACL,UCnBA,OAAO,eAAeC,EAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EACrCA,EAAA,gBAAGC,EACND,EAAA,aAAGE,EACFF,EAAA,cAAGG,GACNH,EAAA,WAAGI,EACrB,MAAMX,GAAS1B,EACTsC,GAAcxB,EACpB,SAASoB,EAAgBK,EAAKC,EAAYC,EAAGC,EAAa,GAAO,CAC7D,GAAID,IAAM,EACN,MAAO,GAEX,IAAIE,EACJ,OAAID,EACAC,EAAWH,EAAaC,EAAKF,EAAMA,GAAQE,EAAIA,IAG/CE,EAAWH,EAAcD,EAAMA,EAAOE,EAClCA,EAAI,IACJE,GAAYF,EAAI,IAGjBE,EAAW,EAAI,EAAI,KAAK,KAAKA,CAAQ,CAChD,CACA,SAASR,EAAaS,EAAG,CACrB,MAAO,CACH,GAAGA,EACH,WAAYA,EAAE,UAAY,IAAMA,EAAE,cAAgBA,EAAE,cAAgB,GACpE,YAAaV,EAAgBU,EAAE,SAAUA,EAAE,gBAAiBA,EAAE,cAAgBA,EAAE,YAAY,EAC5F,gBAAiBA,EAAE,cAAgB,GAAKA,EAAE,YAC7C,CACL,CACA,eAAeR,GAAcS,EAAQC,EAAO,CACxC,KAAM,CAAE,MAAAC,EAAO,IAAAC,CAAG,EAAKH,EACjBI,EAAO,CACT,SAAU,OAAO,UACjB,SAAU,OAAO,UACjB,SAAU,EACV,gBAAiB,EACjB,aAAc,CACjB,EACD,IAAIC,EAAQ,GACZ,KAAM,CAAE,SAAAC,EAAU,SAAAC,EAAU,SAAAC,EAAU,gBAAAC,EAAiB,aAAAC,CAAc,EAAG,QAAU7B,GAAO,gBAAgBoB,EAAM,QAASR,GAAY,QAAQ,CAACkB,EAAKC,IAAM,CACpJ,MAAMb,EAAIa,EAAE,IAAI,OAAO,EACjBC,EAAUD,EAAE,IAAI,SAAS,EACzB,CAAE,SAAAL,EAAU,SAAAD,CAAQ,EAAKK,EAC/B,OAAAA,EAAI,SAAW,KAAK,IAAIJ,EAAUM,EAAUD,EAAE,IAAI,UAAU,EAAIb,CAAC,EACjEY,EAAI,SAAW,KAAK,IAAIL,EAAUO,EAAUD,EAAE,IAAI,UAAU,EAAIb,CAAC,EACjEY,EAAI,UAAYZ,EAChBY,EAAI,iBAAmBZ,EAAIA,EAC3BY,EAAI,cAAgB,EACpBN,EAAQ,GACDM,CACf,EAAOP,CAAI,CAAC,CAAC,EACT,OAAOC,EACDf,EAAa,CACX,SAAAiB,EACA,SAAAD,EACA,SAAAE,EACA,gBAAAC,EACA,aAAAC,EACA,aAAcP,EAAMD,EAAQ,CAC/B,CAAA,EACCV,EAAY,CACtB,CACA,SAASA,GAAa,CAClB,MAAO,CACH,SAAU,EACV,SAAU,EACV,UAAW,EACX,YAAa,EACb,SAAU,EACV,gBAAiB,EACjB,aAAc,EACd,eAAgB,EAChB,aAAc,CACjB,CACL,CC5EA,OAAO,eAAesB,EAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EAC9BA,EAAA,uBAAG,OACjC,MAAMjC,EAAS1B,EACTsC,EAAcxB,EACdH,GAAgBI,EAChB6C,EAASC,EAAqB,EAC9BC,GAASC,EACTC,EAAUC,EACVtC,GAAcuC,EACpB,MAAMC,WAA+BxD,GAAc,WAAY,CAC3D,MAAM,UAAUyD,EAAO,CACnB,OAAO,IACf,CACI,MAAM,YAAYA,EAAO,CACrB,OAAO,IACf,CACI,oBAAoBvB,EAAQwB,EAAO,GAAI,CACnC,SAAWP,GAAO,kBAAkB,MAAOhC,GAAa,CACpD,MAAMwC,EAAU,MAAM,KAAK,kBAAkBzB,EAAO,QAASwB,CAAI,KAC7D1C,GAAY,gBAAgB0C,EAAK,SAAS,EACzCC,EAID,KAAK,YAAYzB,EAAQwB,CAAI,EAAE,UAAUvC,CAAQ,EAHjDA,EAAS,SAAU,CAKnC,CAAS,CACT,CACI,6BAA6ByC,EAASF,EAAO,GAAI,CAC7C,SAAW3C,EAAO,OAAO,GAAG6C,EAAQ,IAAI1B,GAAU,KAAK,oBAAoBA,EAAQwB,CAAI,CAAC,CAAC,CACjG,CACI,MAAM,kBAAkBG,EAASH,EAAO,GAAI,CAExC,OADiB,MAAM,KAAK,YAAYA,CAAI,GAC5B,SAASG,CAAO,CACxC,CACI,MAAM,2BAA2B3B,EAAQwB,EAAM,CAC3C,MAAMvB,EAAQ,KAAK,YAAYD,EAAQwB,CAAI,EAC3C,SAAWL,EAAQ,eAAenB,EAAQC,CAAK,CACvD,CACI,MAAM,gCAAgCyB,EAAU,CAAE,EAAEF,EAAM,CACtD,GAAI,CAACE,EAAQ,OACT,SAAWP,EAAQ,YAAa,EAEpC,MAAMlB,EAAQ,MAAM,QAAQ,IAAIyB,EAAQ,IAAI1B,GAAU,KAAK,2BAA2BA,EAAQwB,CAAI,CAAC,CAAC,EAC9FjB,KAAeQ,EAAO,KAAKd,EAAM,IAAI2B,GAAKA,EAAE,QAAQ,CAAC,EACrDtB,KAAeS,EAAO,KAAKd,EAAM,IAAI2B,GAAKA,EAAE,QAAQ,CAAC,EACrDpB,KAAeO,EAAO,KAAKd,EAAM,IAAI2B,GAAKA,EAAE,QAAQ,CAAC,EACrDnB,KAAsBM,EAAO,KAAKd,EAAM,IAAI2B,GAAKA,EAAE,eAAe,CAAC,EACnElB,KAAmBK,EAAO,KAAKd,EAAM,IAAI2B,GAAKA,EAAE,YAAY,CAAC,EAC7DC,KAAmBd,EAAO,KAAKd,EAAM,IAAI2B,GAAKA,EAAE,YAAY,CAAC,EACnE,SAAWT,EAAQ,cAAc,CAC7B,SAAAb,EACA,SAAAC,EACA,aAAAG,EACA,aAAAmB,EACA,gBAAApB,EACA,SAAAD,CACZ,CAAS,CACT,CACI,6BAA6BR,EAAQwB,EAAM,CACvC,IAAIM,EAAW,CAAC,KAAK,IAAK,EAC1B,MAAMC,EAAoB,MAAOC,EAAQC,IAAkB,CACvD,KAAM,CAAE,MAAA/B,EAAO,IAAAC,CAAG,EAAKH,EACjBkC,EAAehC,EAAQ,IAAOC,EAAM,IACpCgC,EAAW,QAAUtD,EAAO,gBAAgB,KAAK,YAAY,CAC/D,GAAGmB,EACH,MAAO,KAAK,IAAI,EAAG,KAAK,MAAMkC,EAAeF,EAAS,CAAC,CAAC,EACxD,IAAK,KAAK,IAAI,KAAK,MAAME,EAAeF,EAAS,CAAC,EAAG7B,CAAG,CACxE,EAAeqB,CAAI,EAAE,QAAS/B,EAAY,SAAU,CAAA,CAAC,EACzC,OAAO2C,EAAiB,CACpB,SAAUJ,EACV,oBAAqBG,EAAS,OAC9B,cAAAF,EACA,MAAO,CACH,eAAgBE,EAAS,OAASH,CACrC,CACjB,CAAa,CACJ,EACKI,EAAmB,MAAO,CAAE,SAAAC,EAAU,MAAAjD,EAAO,oBAAAkD,EAAqB,cAAAL,KAAqB,CACzF,MAAMM,EAASvC,EAAO,IAAMA,EAAO,MACnC,GAAIsC,GAAuB,IAAMD,EAAW,EAAIE,EAC5C,OAAOnD,EAEN,GAAI6C,GAAiB,IAAM,CAC5B,MAAMO,EAAW,CAAC,KAAK,IAAK,EAC5B,OAAAP,GAAiBO,EAAWV,EAC5BA,EAAWU,EACJT,EAAkBM,EAAW,EAAGJ,CAAa,CACpE,KAEgB,gBAAQ,KAAK,iEAAiE,EACvE,CAAE,eAAgB,OAAO,iBAAmB,CAE1D,EACD,OAAOF,EAAkB,IAAM,CAAC,CACxC,CACI,MAAM,kCAAkCL,EAASF,EAAM,CACnD,GAAI,CAACE,EAAQ,OACT,MAAM,IAAI,MAAM,qBAAqB,EAEzC,OAAO,KAAK,6BAA6BA,EAAQ,CAAC,EAAGF,CAAI,CACjE,CACI,MAAM,WAAWE,EAAS,CACtB,MAAMS,EAAW,QAAUtD,EAAO,gBAAgB,KAAK,6BAA6B6C,CAAO,EAAE,QAASjC,EAAY,SAAU,CAAA,CAAC,EACvHgD,EAAU,IAAI,IACpB,UAAW7B,KAAKuB,EACZM,EAAQ,IAAI7B,EAAE,IAAI,QAAQ,CAAC,EAE/B,MAAO,CAAC,GAAG6B,CAAO,EAAE,IAAIC,IAAW,CAC/B,KAAMA,CAClB,EAAU,CACV,CACA,CACA5B,EAAA,uBAAiCQ,YCjHjC,OAAO,eAAeqB,EAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EACjCA,EAAA,oBAAG,OAC9B,MAAM7B,GAA2B3D,EACjC,MAAMyF,WAA4B9B,GAAyB,sBAAuB,CAC9E,MAAM,mCAAoC,CACtC,MAAO,CAAE,eAAgB,CAAG,CACpC,CACA,CACA6B,EAAA,oBAA8BC,gBCR9B,IAAIC,EAAmBjF,GAAQA,EAAK,kBAAqB,OAAO,OAAU,SAASkF,EAAGC,EAAGC,EAAGC,EAAI,CACxFA,IAAO,SAAWA,EAAKD,GAC3B,IAAIE,EAAO,OAAO,yBAAyBH,EAAGC,CAAC,GAC3C,CAACE,IAAS,QAASA,EAAO,CAACH,EAAE,WAAaG,EAAK,UAAYA,EAAK,iBAClEA,EAAO,CAAE,WAAY,GAAM,IAAK,UAAW,CAAE,OAAOH,EAAEC,CAAC,EAAM,GAE/D,OAAO,eAAeF,EAAGG,EAAIC,CAAI,CACpC,EAAK,SAASJ,EAAGC,EAAGC,EAAGC,EAAI,CACpBA,IAAO,SAAWA,EAAKD,GAC3BF,EAAEG,CAAE,EAAIF,EAAEC,CAAC,IAEXG,EAAgBvF,GAAQA,EAAK,cAAiB,SAASmF,EAAGK,EAAS,CACnE,QAASC,KAAKN,EAAOM,IAAM,WAAa,CAAC,OAAO,UAAU,eAAe,KAAKD,EAASC,CAAC,GAAGR,EAAgBO,EAASL,EAAGM,CAAC,CAC3H,EACD,OAAO,eAAcD,EAAU,aAAc,CAAE,MAAO,GAAM,EAC5DA,EAAA,oBAA8BA,EAAiC,uBAAAA,EAAA,YAAsB,OACrFD,EAAahG,EAAmBiG,CAAO,EACvCD,EAAalF,EAAoBmF,CAAO,EACxC,IAAItF,EAAgBI,EACpB,OAAO,eAAekF,EAAS,cAAe,CAAE,WAAY,GAAM,IAAK,UAAY,CAAE,OAAOtF,EAAc,WAAc,CAAA,CAAE,EAC1H,IAAIgD,EAA2BE,EAC/B,OAAO,eAAeoC,EAAS,yBAA0B,CAAE,WAAY,GAAM,IAAK,UAAY,CAAE,OAAOtC,EAAyB,sBAAyB,CAAA,CAAE,EAC3J,IAAI6B,EAAwBzB,EAC5B,OAAO,eAAekC,EAAS,sBAAuB,CAAE,WAAY,GAAM,IAAK,UAAY,CAAE,OAAOT,EAAsB,mBAAoB,CAAI,CAAA,uBCxB3I,SAASW,GAAkBC,EAAO,CACrC,GAAI,OAAOA,GAAU,SACjB,MAAO,CAAE,EAEb,MAAMC,EAAS,CAAE,EAQjB,OAPgBD,EAAM,YAAW,EAAG,QAEpC,0JAA2J,CAACE,EAAOC,EAAWC,EAAOC,IAAS,CAC1L,MAAMC,EAAQF,GAASC,EACvB,OAAAJ,EAAOE,CAAS,EAAIG,EAAQA,EAAM,YAAa,EAAG,GAC3C,EACf,CAAK,EAEU,CAAE,GAGb,OAAO,KAAKL,CAAM,EAAE,QAAQ/F,GAAO,CAC/B,GAAI,UAAU,KAAK,GAAG+F,EAAO/F,CAAG,CAAC,EAAE,EAC/B,GAAI,CACA,MAAMqG,EAAM,SAAS,GAAGN,EAAO/F,CAAG,CAAC,GAAI,EAAE,EACpC,OAAO,MAAMqG,CAAG,IACjBN,EAAO/F,CAAG,EAAIqG,EAElC,MACsB,CAEtB,CAEA,CAAK,EACMN,EACX,CACO,MAAMO,EAAe,CACxB,YAAY,CAAE,WAAAC,GAAc,CACxB,KAAK,WAAaA,CAC1B,CACI,6BAA6BC,EAAe,CACxC,KAAM,CAAE,QAAAC,EAAU,CAAA,EAAI,YAAAC,EAAa,aAAAC,CAAe,EAAGH,EAC/C,CAAE,KAAAI,EAAM,OAAAC,CAAM,EAAKJ,EAEzB,IAAIK,EAAeH,GAAgBD,EAEnC,GAAI,CAACI,EAAc,CACf,GAAI,CAACF,EACD,OAEJE,EAAe,IAAI,KAAKF,CAAI,CACxC,CACQ,MAAMG,EAAYC,GAAQ,IAAI,KAAKF,EAAa,QAAS,EAAGE,CAAG,EAE/D,GAAI,eAAe,KAAKH,GAAU,EAAE,EAChC,OAAOE,EAAS,KAAK,UAAU,EAEnC,MAAME,EAAepB,GAAkBY,EAAQ,eAAe,GAAK,EAAE,EACrE,GAAIQ,EAAa,UAAU,GACvBA,EAAa,UAAU,GACvBA,EAAa,iBAAiB,EAC9B,OAAOF,EAAS,KAAK,UAAU,EAEnC,GAAIE,EAAa,SAAS,IAAM,OAAW,CACvC,MAAMD,EAAM,CAACC,EAAa,SAAS,EAAI,IACvC,OAAOF,EAAS,KAAK,IAAIC,EAAK,KAAK,UAAU,CAAC,CAC1D,KACa,IAAI,KAAK,cAAcP,EAAQ,OAAO,EACvC,OAAO,KAAK,cAAcA,EAAQ,OAAO,EAExC,GAAI,KAAK,cAAcA,EAAQ,eAAe,CAAC,EAAG,CACnD,MAAMS,EAAe,KAAK,cAAcT,EAAQ,eAAe,CAAC,EAC1DO,GAAOF,EAAa,QAAO,IAAMI,GAAA,YAAAA,EAAc,YAAa,IAAM,GACxE,OAAOH,EAASC,CAAG,CAC/B,EAGA,CACI,cAAcG,EAAO,CACjB,GAAIA,EAAO,CACP,GAAIA,aAAiB,KACjB,OAAOA,EAEX,GAAI,OAAOA,GAAU,UAAY,OAAOA,GAAU,SAC9C,OAAO,IAAI,KAAKA,CAAK,CAErC,CAEA,CAII,mBAAmBX,EAAe,CAC9B,MAAMY,EAAa,KAAK,6BAA6BZ,CAAa,EAClE,MAAO,CAACY,GAAc,IAAI,MAAUA,CAC5C,CAKI,iBAAiBC,EAAM,CAGnB,MAAO,EACf,CACA,CCjGe,MAAMC,EAAmB,CAMpC,YAAY,CAAE,MAAAC,EAAO,UAAAC,EAAY,IAAK,aAAAC,EAAe,KAAO,aAAAC,EAAe,KAAY,CACnF,KAAK,cAAgB,GACrB,KAAK,cAAgBH,EACrB,KAAK,UAAYC,EACjB,KAAK,aAAeC,EACpB,KAAK,aAAeC,CAC5B,CACI,cAAcC,EAAcC,EAAS,CACjC,OAEAA,EAAQ,OAASD,EAAa,IAAM,KAAK,cAErCC,EAAQ,IAAMA,EAAQ,MAAQD,EAAa,IAAMA,EAAa,MAC1D,KAAK,YACrB,CAGI,iBAAiBE,EAAS,CACtB,OAAO,IAAI,QAAQC,GAAW,CAC1B,IAAIC,EAAcF,EAAQ,OAAOvF,GAAK,CAACA,EAAE,OAAO,EAAE,OAClDuF,EAAQ,QAAQG,GAAU,CACtBA,EAAO,iBAAiB,QAAS,IAAM,CACnCD,GAAe,EACVA,GACDD,EAAS,CAEjC,CAAiB,CACjB,CAAa,CACb,CAAS,EAAE,MAAOG,GAAM,CACZ,QAAQ,MAAMA,CAAC,CAC3B,CAAS,CACT,CAGI,UAAU,CAAE,IAAAC,EAAK,MAAAzF,EAAO,IAAAC,EAAK,SAAAyF,CAAQ,EAAI,CAKrC,MAAMC,EAAoB,IAAI,gBACxBP,EAAU,CAAE,EAClBM,EAAS,QAAQ,CAAC,CAAE,eAAAE,KAAqB,CACjCA,EAAe,QACfR,EAAQ,KAAKQ,EAAe,MAAM,CAElD,CAAS,EACGR,EAAQ,SAAWM,EAAS,QAG5B,KAAK,iBAAiBN,CAAO,EAAE,KAAK,IAAM,CACtCO,EAAkB,MAAO,CACzC,CAAa,EAEL,KAAK,cAAcF,EAAKzF,EAAOC,EAAM,EAAG,CACpC,OAAQ0F,EAAkB,MAC7B,CAAA,EACI,KAAKE,GAAY,CAClB,MAAMvH,EAAOuH,EAAS,OACtBH,EAAS,QAAQ,CAAC,CAAE,MAAOI,EAAU,IAAKC,EAAQ,QAAAV,KAAc,CAC5DA,EAAQ,CACJ,QAASQ,EAAS,QAClB,OAAQvH,EAAK,SAASwH,EAAW9F,EAAO+F,EAAS/F,CAAK,CAC1E,CAAiB,CACjB,CAAa,CACJ,CAAA,EACI,MAAOgG,GAAQ,CAChBN,EAAS,QAAQ,CAAC,CAAE,OAAAO,KAAa,CAC7BA,EAAOD,CAAG,CAC1B,CAAa,CACb,CAAS,CACT,CACI,uBAAwB,CACpB,OAAO,QAAQ,KAAK,aAAa,EAAE,QAAQ,CAAC,CAACP,EAAKC,CAAQ,IAAM,CAC5D,GAAI,CAACA,EAAS,OACV,OAIJ,MAAMQ,EAAqB,CAAE,EAc7B,GAXAR,EAAS,QAAQP,GAAW,OACxB,KAAM,CAAE,eAAAS,EAAgB,OAAAK,CAAM,EAAKd,GAC/BgB,EAAAP,EAAe,SAAf,MAAAO,EAAuB,QACvBF,EAAO,OAAO,OAAO,IAAI,MAAM,SAAS,EAAG,CAAE,KAAM,aAAa,CAAE,CAAC,EAGnEC,EAAmB,KAAKf,CAAO,CAEnD,CAAa,EACDe,EAAmB,KAAK,CAACxE,EAAG0E,IAAM1E,EAAE,MAAQ0E,EAAE,KAAK,EACnDV,EAAS,OAAS,EACd,CAACQ,EAAmB,OACpB,OAEJ,IAAIG,EACJ,UAAWC,KAAQJ,EACXG,GACA,KAAK,cAAcA,EAAqBC,CAAI,GAE5CD,EAAoB,SAAS,KAAKC,CAAI,EACtCD,EAAoB,IAAMC,EAAK,MAI3BD,GACA,KAAK,UAAUA,CAAmB,EAGtCA,EAAsB,CAClB,SAAU,CAACC,CAAI,EACf,IAAAb,EACA,MAAOa,EAAK,MACZ,IAAKA,EAAK,GACb,GAGLD,GACA,KAAK,UAAUA,CAAmB,CAElD,CAAS,CACT,CACI,SAASZ,EAAKN,EAAS,CACd,KAAK,cAAcM,CAAG,IACvB,KAAK,cAAcA,CAAG,EAAI,CAAE,GAEhC,KAAK,cAAcA,CAAG,EAAE,KAAKN,CAAO,CAC5C,CAQI,MAAMM,EAAKzF,EAAOC,EAAK2F,EAAiB,CAAA,EAAI,CACxC,OAAO,IAAI,QAAQ,CAACP,EAASY,IAAW,CACpC,KAAK,SAASR,EAAK,CAAE,MAAAzF,EAAO,IAAAC,EAAK,QAAAoF,EAAS,OAAAY,EAAQ,eAAAL,EAAgB,EAC7D,KAAK,UACN,KAAK,QAAU,WAAW,IAAM,CAC5B,KAAK,QAAU,OACf,KAAK,sBAAuB,CAChD,EAAmB,KAAK,WAAa,CAAC,EAEtC,CAAS,CACT,CACA,CC3Je,eAAeW,GAAsBd,EAAKzF,EAAOC,EAAKuG,EAAU,CAAA,EAAI,CAC/E,MAAMvC,EAAc,IAAI,KAClBwC,EAAe,OAAO,OAAO,CAC/B,OAAQ,MACR,QAAS,CAAE,MAAO,SAASzG,CAAK,IAAIC,CAAG,EAAI,CAC9C,EAAEuG,CAAO,EACJE,EAAM,MAAM,MAAMjB,EAAKgB,CAAY,EACnCvC,EAAe,IAAI,KACzB,GAAIwC,EAAI,SAAW,KAAOA,EAAI,SAAW,IACrC,MAAM,IAAI,MAAM,QAAQA,EAAI,MAAM,kBAAkBjB,CAAG,UAAUzF,CAAK,IAAIC,CAAG,EAAE,EAEnF,GAAIyG,EAAI,SAAW,IAIf,MAAM,IAAI,MAAM,QAAQA,EAAI,MAAM,kBAAkBjB,CAAG,UAAUzF,CAAK,IAAIC,CAAG,EAAE,EAEnF,MAAM0G,EAAS,IAAI,WAAW,MAAMD,EAAI,YAAW,CAAE,EAErD,MAAO,CAEH,QAASA,EAAI,QAAQ,IACrB,YAAAzC,EACA,aAAAC,EACA,OAAAyC,CACH,CACL,CC1BO,SAASnH,GAAIoH,EAAO,CACvB,IAAIpH,EAAM,EACV,UAAWqH,KAASD,EAChBpH,GAAOqH,EAAM,OAEjB,OAAOrH,CACX,CACO,SAASsH,GAAiB5J,EAAM,CACnC,MAAM6J,EAAc,IAAI,WAAWvH,GAAItC,CAAI,CAAC,EAC5C,IAAI8J,EAAS,EACb,UAAWH,KAAS3J,EAChB6J,EAAY,IAAIF,EAAOG,CAAM,EAC7BA,GAAUH,EAAM,OAEpB,OAAOE,CACX,CCLA,SAASE,GAAiBC,EAAW,CACjC,OAEAA,EAAU,OAAS,cAGfA,EAAU,OAAS,eAMnB,CAAC,CAACA,EAAU,QAAQ,MAAM,2BAA2B,CAC7D,CAMe,MAAMC,EAAiB,CAClC,YAAY,CAAE,MAAArC,EAAQyB,GAAuB,KAAAa,EAAO,IAAU,UAAAC,EAAY,MAAO,gBAAAC,EAAkB,IAAK,WAAAxD,EAAa,IAAM,aAAAmB,EAAeoC,EAAY,EAAG,cAAAE,EAAgBF,GAAc,CACnL,KAAK,WAAa,IAAIxC,GAAmB,CACrC,MAAAC,EACA,UAAWwC,EACX,aAAArC,EACA,aAAcsC,CAC1B,CAAS,EACD,KAAK,UAAYF,EACjB,KAAK,WAAa,IAAIG,EAAI,CAAE,QAAS,KAAK,MAAMJ,EAAOC,CAAS,GAAK,CAAC,CAAE,EACxE,KAAK,eAAiB,IAAIxD,GAAe,CAAE,WAAAC,CAAU,CAAE,EACvD,KAAK,MAAQ,IAAI0D,EAAI,CAAE,QAAS,EAAE,CAAE,CAC5C,CACI,MAAM,SAASjK,EAAKkK,EAAU3F,EAAQ0E,EAAU,CAAA,EAAI,CAEhD,MAAMkB,EAAa,KAAK,MAAMD,EAAW,KAAK,SAAS,EACjDE,EAAY,KAAK,OAAOF,EAAW3F,EAAS,GAAK,KAAK,SAAS,EAE/D8F,EAAU,IAAI,MAAMD,EAAYD,EAAa,CAAC,EACpD,QAASG,EAAQH,EAAYG,GAASF,EAAWE,GAAS,EACtDD,EAAQC,EAAQH,CAAU,EAAI,KAAK,UAAUnK,EAAKsK,EAAOrB,CAAO,EAAE,KAAKE,GAAOA,GAAO,CACjF,QAASA,EAAI,QACb,OAAQA,EAAI,OACZ,YAAamB,CAC7B,CAAa,EAGL,IAAIC,EAAiB,MAAM,QAAQ,IAAIF,CAAO,EAE9C,GADAE,EAAiBA,EAAe,OAAOC,GAAK,CAAC,CAACA,CAAC,EAC3C,CAACD,EAAe,OAChB,MAAO,CACH,QAAS,CAAE,EACX,OAAQ,IAAI,WAAW,CAAC,CAC3B,EAEL,MAAME,EAAeP,EAAWK,EAAe,CAAC,EAAE,YAAc,KAAK,UACrE,MAAO,CACH,QAAS,KAAK,aAAaA,EAAe,CAAC,EAAE,QAASL,EAAUA,EAAW3F,EAAS,CAAC,EACrF,OAAQ,KAAK,YAAYgG,EAAgBE,EAAclG,CAAM,CAChE,CACT,CACI,YAAYgG,EAAgBE,EAAclG,EAAQ,CAC9C,GAAIgG,EAAe,SAAW,EAC1B,OAAOA,EAAe,CAAC,EAAE,OAAO,MAAME,EAAcA,EAAelG,CAAM,EAExE,GAAIgG,EAAe,SAAW,EAC/B,OAAO,IAAI,WAAW,CAAC,EAEtB,CAED,MAAMG,EAAUH,EAAe,IAAIC,GAAKA,EAAE,MAAM,EAC1CG,EAAQD,EAAQ,MAAK,EAAG,MAAMD,CAAY,EAChD,IAAIG,EAAOF,EAAQ,IAAK,EACpBG,EAAUF,EAAM,OAChBD,EAAQ,OAAO,CAACzI,EAAK6I,IAAQ7I,EAAM6I,EAAI,OAAQ,CAAC,EAChDF,EAAK,OACLrG,EACJ,OAAIsG,EAAU,IACVA,EAAU,GAEdD,EAAOA,EAAK,MAAM,EAAGA,EAAK,OAASC,CAAO,EACnCtB,GAAiB,CAACoB,EAAO,GAAGD,EAASE,CAAI,CAAC,CAC7D,CACA,CAWI,MAAM,KAAK5K,EAAK,CACZ,IAAI+K,EAAO,KAAK,MAAM,IAAI/K,CAAG,EAC7B,GAAI,CAAC+K,EAAM,CACP,MAAMT,EAAQ,MAAM,KAAK,UAAUtK,EAAK,CAAC,EAKzC,GAJIsK,GACA,KAAK,wBAAwBtK,EAAKsK,CAAK,EAE3CS,EAAO,KAAK,MAAM,IAAI/K,CAAG,EACrB,CAAC+K,EACD,MAAM,IAAI,MAAM,oCAAoC/K,CAAG,EAAE,CAEzE,CACQ,OAAO+K,CACf,CACI,gBAAgBvE,EAAe,CAC3B,KAAM,CAAE,QAAAC,CAAO,EAAKD,EACduE,EAAO,CAAE,EACf,GAAItE,GAAA,MAAAA,EAAU,iBAAkB,CAC5B,MAAMT,EAAQ,iBAAiB,KAAKS,EAAQ,eAAe,CAAC,EAC5D,GAAIT,EAAO,CACP,MAAMwE,EAAI,SAASxE,EAAM,CAAC,EAAG,EAAE,EAC1B,OAAO,MAAMwE,CAAC,IACfO,EAAK,KAAOP,EAEhC,CACA,CACQ,OAAI/D,GAAA,MAAAA,EAAU,mBACVsE,EAAK,MAAQ,IAAI,KAAKtE,EAAQ,eAAe,CAAC,EAC1CsE,EAAK,MAAM,SAAQ,IAAO,iBAC1B,QAAQ,KAAK,cAAc,EAC3BA,EAAK,MAAQ,IAAI,MAErBA,EAAK,QAAUA,EAAK,MAAM,QAAS,GAEhCA,CACf,CACI,aAAaC,EAAiBC,EAAUC,EAAQ,CAC5C,MAAMzE,EAAU,CAAE,GAAGuE,CAAiB,EAChChF,EAAQ,iBAAiB,KAAKS,EAAQ,eAAe,GAAK,EAAE,EAClE,MAAO,CACH,GAAGuE,EACH,iBAAkBE,EAASD,EAC3B,gBAAiB,GAAGA,CAAQ,IAAIC,EAAS,CAAC,IAAIlF,GAAA,YAAAA,EAAQ,EAAE,GACxD,oBAAqBA,GAAA,YAAAA,EAAQ,EAChC,CACT,CACI,MAAM,UAAUhG,EAAKmL,EAAa9C,EAAgB,CAC9C,MAAM+C,EAAW,GAAGpL,CAAG,IAAImL,CAAW,GAChCE,EAAgB,KAAK,WAAW,IAAID,CAAQ,EAClD,GAAIC,EAAe,CACf,IAAIf,EACAgB,EAAe,GACnB,GAAI,CACAhB,EAAQ,MAAMe,CAC9B,OACmB5C,EAAK,CACR,GAAIiB,GAAiBjB,CAAG,EAEpB6C,EAAe,OAGf,OAAM7C,CAE1B,CAGY,OAGA6B,IACKgB,GAAgB,CAAC,KAAK,eAAe,mBAAmBhB,CAAK,IAC9D,KAAK,eAAec,EAAUC,CAAa,EACpC,KAAK,UAAUrL,EAAKmL,EAAa9C,CAAc,IAGtDiC,GACA,KAAK,wBAAwBtK,EAAKsK,CAAK,EAEpCA,EACnB,CACQ,MAAMiB,EAAaJ,EAAc,KAAK,UACtC,IAAIK,EAAWD,EAAa,KAAK,UAEjC,MAAMR,EAAO,KAAK,MAAM,IAAI/K,CAAG,EAC/B,GAAI+K,GAAA,MAAAA,EAAM,KAAM,CACZ,GAAIQ,GAAcR,EAAK,KACnB,OAEAS,GAAYT,EAAK,OACjBS,EAAWT,EAAK,KAEhC,CACQ,MAAMU,EAAe,KAAK,WAAW,MAAMzL,EAAKuL,EAAYC,EAAUnD,CAAc,EAAE,MAAOI,GAAQ,CACjG,WAAK,eAAe2C,EAAUK,CAAY,EACpChD,CAClB,CAAS,EACD,KAAK,WAAW,IAAI2C,EAAUK,CAAY,EAC1C,MAAMC,EAAa,MAAMD,EAEzB,YAAK,wBAAwBzL,EAAK0L,CAAU,EAIvC,KAAK,eAAe,iBAAiBA,CAAU,GAChD,KAAK,eAAeN,EAAUK,CAAY,EAEvCC,CACf,CAEI,wBAAwB1L,EAAKsK,EAAO,CAC3B,KAAK,MAAM,IAAItK,CAAG,GACnB,KAAK,MAAM,IAAIA,EAAK,KAAK,gBAAgBsK,CAAK,CAAC,CAE3D,CAII,eAAetK,EAAKqL,EAAe,CAC3B,KAAK,WAAW,IAAIrL,CAAG,IAAMqL,GAC7B,KAAK,WAAW,OAAOrL,CAAG,CAEtC,CAII,OAAQ,CACJ,KAAK,MAAM,MAAO,EAClB,KAAK,WAAW,MAAO,CAC/B,CACA,kICvOA,OAAO,eAAe2L,EAAS,aAAc,CAAE,MAAO,EAAI,CAAE,EAC5BA,EAAA,yBAAG,OACjBA,EAAA,WAAGC,GACrB,MAAMC,GAAuBnM,GACvBoM,GAAwBtL,EACxBuL,EAAW,CAAE,EACnB,SAASC,GAAiB9D,EAAKzF,EAAOC,EAAKuG,EAAU,CAAA,EAAI,CACrD,MAAMgD,EAAUF,EAAS7D,CAAG,EAC5B,GAAI,CAAC+D,EACD,MAAM,IAAI,MAAM,4BAA4B/D,CAAG,EAAE,EAErD,OAAO+D,EAAQ/D,EAAKzF,EAAOC,EAAKuG,CAAO,CAC3C,CACA,MAAMiD,EAAmB,IAAIL,GAAqB,iBAAiB,CAC/D,MAAOG,GACP,KAAM,IAAM,MAAQ,EACpB,UAAW,IAAM,KACjB,aAAc,IAAM,MAAQ,EAC5B,WAAY,GAAK,GAAK,GAAK,GAC/B,CAAC,EACD,SAASJ,IAAa,CAClBM,EAAiB,MAAO,CAC5B,CACA,MAAMC,WAAiCL,GAAsB,UAAW,CACpE,MAAM,MAAM5D,EAAKkE,EAAM,CACnB,MAAMC,EAAM,OAAOnE,CAAG,EACjB6D,EAASM,CAAG,IACbN,EAASM,CAAG,EAAI,KAAK,iBAAiB,KAAK,IAAI,GAEnD,MAAMC,EAAQ,IAAI,QAAQF,GAAS,KAA0B,OAASA,EAAK,OAAO,EAAE,IAAI,OAAO,EAC/F,GAAIE,EAAO,CACP,MAAMC,EAAa,oBAAoB,KAAKD,CAAK,EACjD,GAAIC,EAAY,CACZ,KAAM,CAAG,CAAA9J,EAAOC,CAAG,EAAI6J,EACjBjK,EAAI,OAAO,SAASG,EAAO,EAAE,EAE7B5C,EADI,OAAO,SAAS6C,EAAK,EAAE,EACjBJ,EACV,CAAE,OAAA8G,EAAQ,QAAA3C,GAAa,MAAMyF,EAAiB,SAAS,GAAGhE,CAAG,GAAI5F,EAAGzC,EAAM,CAAC,EACjF,OAAO,IAAI,SAASuJ,EAAQ,CACxB,OAAQ,IACR,QAAA3C,CACpB,CAAiB,CACjB,CACA,CACQ,OAAO,MAAM,MAAMyB,EAAKkE,CAAI,CACpC,CACI,MAAM,iBAAiBlE,EAAKzF,EAAOC,EAAKuG,EAAU,CAAA,EAAI,CAClD,MAAMvC,EAAc,IAAI,KAClByC,EAAM,MAAM,MAAM,MAAMjB,EAAK,CAC/B,GAAGe,EACH,QAAS,CACL,GAAGA,EAAQ,QACX,MAAO,SAASxG,CAAK,IAAIC,CAAG,EAC/B,CACb,CAAS,EACKiE,EAAe,IAAI,KACzB,GAAI,CAACwC,EAAI,GAAI,CACT,MAAMqD,EAAe,QAAQrD,EAAI,MAAM,aAAajB,CAAG,UAAUzF,CAAK,IAAIC,CAAG,GACvE+J,EAAO,sCACb,MAAM,IAAI,MAAM,GAAGD,CAAY,GAAGrD,EAAI,SAAW,IAAMsD,EAAO,EAAE,EAAE,CAC9E,CACQ,MAAMhG,EAAU,CAAE,EAClB,SAAW,CAAClB,EAAGmH,CAAC,IAAKvD,EAAI,QAAQ,UAC7B1C,EAAQlB,CAAC,EAAImH,EAEjB,MAAMC,EAAc,MAAMxD,EAAI,YAAa,EAC3C,MAAO,CACH,QAAA1C,EACA,YAAAC,EACA,aAAAC,EACA,OAAQ,IAAI,WAAWgG,CAAW,CACrC,CACT,CACA,CACAhB,EAAA,yBAAmCQ,gBC1EnC,IAAIjM,EAAmBC,GAAQA,EAAK,iBAAoB,SAAUC,EAAK,CACnE,OAAQA,GAAOA,EAAI,WAAcA,EAAM,CAAE,QAAWA,CAAK,CAC5D,EACD,OAAO,eAAcuF,EAAU,aAAc,CAAE,MAAO,GAAM,EAC5DA,EAAmC,yBAAA,OACnCA,EAAA,mBAA6BiH,EAC7BjH,EAAA,aAAuBkH,EACvBlH,EAAA,WAAqBmH,EACrB,MAAMC,EAAgB7M,EAAgBR,CAAsB,EACtDoM,EAAwBtL,EACxBmL,EAA6BlL,EAC7BuM,EAAMzJ,EAAc,EACpB0J,EAAWxJ,GACXyJ,EAAUvJ,EAAmB,EACnC,SAASwJ,EAAoBC,EAAU,CACnC,MAAO,cAAeA,EAE1B,SAASC,EAAeD,EAAU,CAC9B,MAAO,WAAYA,EAEvB,SAASR,EAAmBQ,EAAU,CAClC,OAAOA,EAAS,QACV,CAAE,GAAGA,EAAU,IAAK,IAAI,IAAIA,EAAS,IAAKA,EAAS,OAAO,EAAE,IAAI,EAChEA,EAEV,SAASP,EAAaO,EAAUtM,EAAe,CAC3C,GAAIqM,EAAoBC,CAAQ,EAAG,CAC/B,GAAI,CAACA,EAAS,UACV,MAAM,IAAI,MAAM,wBAAwB,EAE5C,GAAIL,EAAc,SAAWC,EAAI,WAC7B,OAAO,IAAIlB,EAAsB,UAAUsB,EAAS,SAAS,EAG7D,MAAM,IAAI,MAAM,sCAAsC,EAG9D,GAAIC,EAAeD,CAAQ,EAAG,CAC1B,MAAME,KAAWL,EAAS,SAASG,EAAS,MAAM,EAClD,GAAI,CAACE,EACD,MAAM,IAAI,MAAM,UAAUF,EAAS,IAAI,wGAAwG,EAEnJ,OAAO,IAAItB,EAAsB,SAASwB,CAAI,EAElD,MAAQJ,EAAQ,eAAeE,CAAQ,EAAG,CACtC,GAAI,CAACA,EAAS,IACV,MAAM,IAAI,MAAM,iBAAiB,EAErC,MAAMG,EAAmBX,EAAmBQ,CAAQ,EACpD,GAAItM,EAAe,CACf,MAAM0M,EAAkBC,EAAmBL,EAAUtM,CAAa,EAClE,GAAI0M,EACA,OAAOA,EAAgB,aAAaD,CAAgB,EAG5D,OAAO,IAAI5B,EAA2B,yBAAyB4B,EAAiB,IAAK,CACjF,MAAOG,CACnB,CAAS,EAEL,MAAM,IAAI,MAAM,sBAAsB,EAE1C,SAASZ,EAAWM,EAAUtM,EAAe,CACzC,GAAI,IAAKoM,EAAQ,eAAeE,CAAQ,EACpC,MAAM,IAAI,MAAM,4BAA4B,KAAK,UAAUA,CAAQ,CAAC,EAAE,EAE1E,GAAItM,EAAe,CACf,MAAM0M,EAAkBC,EAAmBL,EAAUtM,CAAa,EAClE,GAAI0M,EACA,OAAOA,EAAgB,WAAWJ,CAAQ,EAGlD,OAAOM,EAEX,SAASD,EAAmBL,EAAUtM,EAAe,CACjD,KAAM,CAAE,UAAA6M,CAAS,EAAK7M,EACtB,GAAI6M,MAAiBT,EAAQ,iCAAiCS,CAAS,EACnE,OAAOA,EAAU,+BAA+BP,CAAQ,EAE5D,GAAIA,EAAS,gCAAiC,CAC1C,GAAI,CAACA,EAAS,gCAAgC,SAAS,MACnD,MAAM,IAAI,MAAM,sEAAsE,EAE1F,OAAOtM,EACF,uBAAuBsM,EAAS,gCAAgC,mBAAmB,EACnF,WAAW,OAAO,CACnB,KAAMA,EAAS,gCAAgC,oBAC/C,cAAeA,EAAS,gCAAgC,SAAS,aAC7E,CAAS,GAIT,eAAeM,EAAqBxF,EAAKnE,EAAM,CAC3C,IAAI6E,EACJ,MAAMN,EAAW,MAAM,MAAMJ,EAAKnE,CAAI,EACtC,GAAIuE,EAAS,SAAW,MAClB,GAAAM,EAAKN,EAAS,QAAQ,IAAI,kBAAkB,KAAO,MAAQM,IAAO,SAAkBA,EAAG,SAAS,OAAO,GACzG,MAAM,IAAIsE,EAAQ,gBAAgB,sDAAuDhF,EAAI,SAAQ,CAAE,EAE3G,OAAOI,EAEX,IAAIsF,EAA6BnN,EACjC,OAAO,eAAekF,EAAS,2BAA4B,CAAE,WAAY,GAAM,IAAK,UAAY,CAAE,OAAOiI,EAA2B,wBAAyB,CAAI,CAAA","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]}