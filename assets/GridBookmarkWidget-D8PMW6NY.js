const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CmuRsDk9.js","./index-DRz5BQNA.js","./index-ZFEwcD3Z.js","./index-DRDIumvF.js","./index-DnpZ9owN.css","./ExportBookmarksDialog-FsRL1D44.js","./MenuItem-D5kXI1eL.js","./dividerClasses-rNTJcnQi.js","./DataGrid-COGS3KN-.js","./index-erzOx3_L.js","./utils-BwPRrx3T.js","./getThemeProps-IugnyHrN.js","./Divider-C_55-x0A.js","./Badge-D0gYdILz.js","./TableCell-Cy8GZPEs.js","./ColorPicker-D_JqId1D.js","./DataGridFlexContainer-BtHzV4NV.js","./ImportBookmarksDialog-ySwzw-N3.js","./ExpandMore-CaMz3Gw7.js","./Collapse-DUY0HwHW.js","./sessionSharing-Cz95NKuV.js","./AccordionDetails-BOde5Ozz.js","./ShareBookmarksDialog-DoYSL9Fm.js","./DialogContentText-CilhbB70.js","./HighlightSettingsDialog-ZaUY4zbi.js","./useThemeProps-CRLrYtpH.js","./EditHighlightColorDialog-CyM3siE2.js","./DeleteBookmarksDialog-Bo-4GaJp.js"])))=>i.map(i=>d[i]);
import{ac as E,j as r,o as k,ak as D,cj as v,al as A,C as g,ck as j,u as m,bx as y,_ as b,m as w,L as C,aU as B,cl as I,aV as L,aX as N,ch as T,cm as V,cn as O,co as $,a as f}from"./index-DRDIumvF.js";import{M as x}from"./MenuItem-D5kXI1eL.js";import{L as S,D as P,G}from"./DataGrid-COGS3KN-.js";import{a as R}from"./ColorPicker-D_JqId1D.js";import{D as M}from"./DataGridFlexContainer-BtHzV4NV.js";const W=E(r.jsx("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92"})),z=k(function({model:n}){const{validAssemblies:t,selectedAssemblies:c}=n,l=t.size===0,u="Select assemblies",i="select-assemblies-label",a=new Set(c),o=[...t].every(s=>a.has(s));return r.jsxs(D,{disabled:l,fullWidth:!0,children:[r.jsx(v,{id:i,children:u}),r.jsxs(A,{labelId:i,multiple:!0,value:c,onChange:s=>{n.setSelectedAssemblies(typeof s.target.value=="string"?[s.target.value]:s.target.value)},input:r.jsx(j,{label:u}),renderValue:s=>s.join(", "),children:[r.jsxs(x,{onClickCapture:s=>{n.setSelectedAssemblies(o?[]:void 0),s.preventDefault()},children:[r.jsx(g,{checked:o,indeterminate:!o&&c.length>0}),r.jsx(S,{primary:"Select all"})]}),[...t].map(s=>r.jsxs(x,{value:s,children:[r.jsx(g,{checked:c.includes(s)}),r.jsx(S,{primary:s})]},s))]})]})});async function H(n,t,c,l){const u=m.getSession(l);try{let i=c.find(a=>a.id===u.focusedViewId);if((i==null?void 0:i.assemblyNames[0])!==t&&(i=c.find(a=>a.type==="LinearGenomeView"&&a.assemblyNames[0]===t)),!i){const a=`${l.id}_${t}`;i=u.addView("LinearGenomeView",{id:a})}await i.navToLocString(n,t)}catch(i){console.error(i),u.notifyError(`${i}`,i)}}function re(n,t){const{selectedBookmarks:c,bookmarksWithValidAssemblies:l}=t,u=c.length===0?l:c;if(n==="BED"){const i="",a={};for(const o of u){const{label:s}=o,d=s===""?".":s,e=`${o.refName}	${o.start}	${o.end}	${d}
`;a[o.assemblyName]?a[o.assemblyName].push(e):a[o.assemblyName]=[e]}for(const o in a){const s=a[o].reduce((p,h)=>p+h,i),d=new Blob([s||""],{type:"text/x-bed;charset=utf-8"}),e=`jbrowse_bookmarks_${o}.bed`;y.saveAs(d,e)}}else{const a=u.map(d=>{const{label:e}=d,p=e===""?".":e,h=m.assembleLocString(d);return`${d.refName}	${d.start+1}	${d.end}	${p}	${d.assemblyName}	${h}
`}).reduce((d,e)=>d+e,`chrom	start	end	label	assembly_name	coord_range
`),o=new Blob([a||""],{type:"text/tab-separated-values;charset=utf-8"});y.saveAs(o,"jbrowse_bookmarks.tsv")}}function q(n){let t=0;switch(n.length%4){case 3:t=1;break;case 2:t=2;break;case 0:t=0;break;default:throw new Error("base64 not a valid length")}return n+"=".repeat(t)}async function ne(n){const t=q(n.replaceAll("-","+").replaceAll("_","/")),{toByteArray:c}=await b(async()=>{const{toByteArray:a}=await import("./index-CmuRsDk9.js").then(o=>o.i);return{toByteArray:a}},__vite__mapDeps([0,1]),import.meta.url),{inflate:l}=await b(async()=>{const{inflate:a}=await import("./index-ZFEwcD3Z.js").then(o=>o.i);return{inflate:a}},__vite__mapDeps([2,3,4]),import.meta.url),u=c(t),i=l(u);return new TextDecoder().decode(i)}async function ce(n){const t=new TextEncoder().encode(n),{deflate:c}=await b(async()=>{const{deflate:o}=await import("./index-ZFEwcD3Z.js").then(s=>s.i);return{deflate:o}},__vite__mapDeps([2,3,4]),import.meta.url),{fromByteArray:l}=await b(async()=>{const{fromByteArray:o}=await import("./index-CmuRsDk9.js").then(s=>s.i);return{fromByteArray:o}},__vite__mapDeps([0,1]),import.meta.url),u=c(t),i=l(u),a=i.indexOf("=");return a>0?i.slice(0,a).replaceAll("+","-").replaceAll("/","_"):i.replaceAll("+","-").replaceAll("/","_")}const F=w()(()=>({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}})),U=k(function({model:n}){const{classes:t}=F(),{bookmarks:c,bookmarksWithValidAssemblies:l,selectedAssemblies:u,selectedBookmarks:i}=n,a=m.getSession(n),o=new Set(u),s=c.filter(e=>o.has(e.assemblyName)).map((e,p)=>{const{assemblyName:h,..._}=e;return{...e,id:p,assemblyName:h,locString:m.assembleLocString(_),correspondingObj:e}}),d=[50,Math.max(m.measureText("Bookmark link",12)+30,m.measureGridWidth(s.map(e=>e.locString))),Math.max(m.measureText("Label",12)+30,m.measureGridWidth(s.map(e=>e.label))),Math.max(m.measureText("Assembly",12)+30,m.measureGridWidth(s.map(e=>e.assemblyName))),100];return r.jsx(M,{children:r.jsx(P,{density:"compact",rows:s,columns:[{...G,width:d[0]},{field:"locString",headerName:"Bookmark link",width:d[1],renderCell:({value:e,row:p})=>r.jsx(C,{className:t.cell,href:"#",onClick:async h=>{h.preventDefault();const{views:_}=a;await H(e,p.assemblyName,_,n)},children:e})},{field:"label",headerName:"Label",width:d[2],editable:!0},{field:"assemblyName",headerName:"Assembly",width:d[3]},{field:"highlight",headerName:"Highlight",width:d[4],renderCell:({value:e,row:p})=>r.jsx(R,{color:e||"black",onChange:h=>{n.updateBookmarkHighlight(p,h)}})}],processRowUpdate:e=>{const p=s[e.id];return n.updateBookmarkLabel(p,e.label),e},onProcessRowUpdateError:e=>{a.notifyError(`${e}`,e)},checkboxSelection:!0,onRowSelectionModelChange:e=>{l.length>0&&n.setSelectedBookmarks([...e.ids].map(p=>({...s[p]})))},rowSelectionModel:{type:"include",ids:new Set(i.map(e=>e.id))}})})}),X=f.lazy(()=>b(()=>import("./ExportBookmarksDialog-FsRL1D44.js"),__vite__mapDeps([5,3,4,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url)),K=f.lazy(()=>b(()=>import("./ImportBookmarksDialog-ySwzw-N3.js"),__vite__mapDeps([17,3,4,18,19,20,21,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url)),J=f.lazy(()=>b(()=>import("./ShareBookmarksDialog-DoYSL9Fm.js"),__vite__mapDeps([22,3,4,20,23,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url)),Q=f.lazy(()=>b(()=>import("./HighlightSettingsDialog-ZaUY4zbi.js"),__vite__mapDeps([24,3,4,11,25,8,9,10,6,7,12,13,14]),import.meta.url)),Y=f.lazy(()=>b(()=>import("./EditHighlightColorDialog-CyM3siE2.js"),__vite__mapDeps([26,3,4,15]),import.meta.url)),Z=f.lazy(()=>b(()=>import("./DeleteBookmarksDialog-Bo-4GaJp.js"),__vite__mapDeps([27,3,4]),import.meta.url)),ee=w()({flex:{display:"flex"}}),te=k(function({model:t}){const{classes:c}=ee();return r.jsxs("div",{children:[r.jsxs(B,{severity:"info",children:["Click and type within the ",r.jsx("strong",{children:"label"})," field to annotate your bookmark. Double click the ",r.jsx("strong",{children:"label"})," field to do so within a dialog."]}),r.jsxs("div",{className:c.flex,children:[r.jsx(I,{"data-testid":"grid_bookmark_menu",menuItems:[{label:"Export",icon:L,onClick:()=>{m.getSession(t).queueDialog(l=>[X,{onClose:l,model:t}])}},{label:"Import",icon:N,onClick:()=>{m.getSession(t).queueDialog(l=>[K,{model:t,onClose:l}])}},{label:"Delete",icon:T,onClick:()=>{m.getSession(t).queueDialog(l=>[Z,{model:t,onClose:l}])}},{label:"Share",icon:W,onClick:()=>{m.getSession(t).queueDialog(l=>[J,{model:t,onClose:l}])}},{label:"Edit colors",icon:V,onClick:()=>{m.getSession(t).queueDialog(l=>[Y,{model:t,onClose:l}])}},{label:"Settings",icon:O,onClick:()=>{m.getSession(t).queueDialog(l=>[Q,{model:t,onClose:l}])}}],children:r.jsx($,{})}),r.jsx(z,{model:t})]}),r.jsx(U,{model:t})]})}),de=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{de as G,re as d,ne as f,ce as t};
//# sourceMappingURL=GridBookmarkWidget-D8PMW6NY.js.map
