const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ModalWidget--bxUKXsT.js","./index-DRDIumvF.js","./index-DnpZ9owN.css"])))=>i.map(i=>d[i]);
import{V as b,cr as C,o as p,m,a as c,j as e,P as W,ao as g,cs as D,an as v,ct as k,as as z,cu as I,u as y,ak as T,al as _,T as x,ch as H,aZ as S,a_ as M,cv as P,cw as F,c as j,_ as R}from"./index-DRDIumvF.js";import{M as E}from"./MenuItem-D5kXI1eL.js";import"./dividerClasses-rNTJcnQi.js";var V=C();const f=b(V),L=m()(t=>({paper:{overflowY:"auto",height:"100%",position:"relative",zIndex:t.zIndex.drawer,outline:"none",background:t.palette.background.default},resizeHandle:{width:4,position:"fixed",top:0,zIndex:t.zIndex.drawer+1}})),N=p(function({children:t,session:n}){const{drawerPosition:l,drawerWidth:a}=n,{classes:i}=L(),r=c.useRef(null);return c.useEffect(()=>{function o(d){var s,u,h;if(d.target instanceof Element&&(!((s=r.current)===null||s===void 0)&&s.contains(d.target))){const w=(h=(u=n.visibleWidget)===null||u===void 0?void 0:u.view)===null||h===void 0?void 0:h.id;w&&n.setFocusedViewId(w)}}return document.addEventListener("mousedown",o),document.addEventListener("keydown",o),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("keydown",o)}},[n]),e.jsxs(W,{ref:r,className:i.paper,elevation:16,square:!0,children:[l==="right"?e.jsx(f,{onDrag:n.resizeDrawer,className:i.resizeHandle,vertical:!0}):null,t,l==="left"?e.jsx(f,{onDrag:n.resizeDrawer,className:i.resizeHandle,style:{left:a},vertical:!0}):null]})}),B=p(function({session:t}){const[n,l]=c.useState(null),{drawerPosition:a,visibleWidget:i}=t;return e.jsxs(e.Fragment,{children:[e.jsx(g,{color:"inherit",onClick:r=>{l(r.currentTarget)},children:e.jsx(D,{})}),e.jsx(v,{title:"Minimize drawer",children:e.jsx(g,{"data-testid":"drawer-minimize",color:"inherit",onClick:()=>{t.notify(`Drawer minimized, click button on ${a} side of screen to re-open`,"info"),t.minimizeWidgetDrawer()},children:e.jsx(k,{})})}),e.jsx(v,{title:"Close drawer",children:e.jsx(g,{color:"inherit",onClick:()=>{t.hideWidget(i)},children:e.jsx(z,{})})}),e.jsx(I,{anchorEl:n,open:!!n,onClose:()=>{l(null)},children:["left","right"].map(r=>e.jsx(E,{selected:a==="option",onClick:()=>{t.setDrawerPosition(r),l(null)},children:r},r))})]})}),$=m()(t=>({formControl:{margin:0},drawerSelect:{margin:0,color:t.palette.secondary.contrastText},dropDownIcon:{color:t.palette.secondary.contrastText}})),A=p(function({session:t}){const{visibleWidget:n,activeWidgets:l}=t,{classes:a}=$(),{pluginManager:i}=y.getEnv(t);return e.jsx(T,{className:a.formControl,children:e.jsx(_,{value:n==null?void 0:n.id,"data-testid":"widget-drawer-selects",className:a.drawerSelect,classes:{icon:a.dropDownIcon},renderValue:r=>{const o=t.activeWidgets.get(r);if(!o)return e.jsx(x,{variant:"h6",color:"inherit",children:"Unknown widget"});const d=i.getWidgetType(o.type),{HeadingComponent:s,heading:u}=d;return s?e.jsx(s,{model:o}):e.jsx(x,{variant:"h6",color:"inherit",children:u})},onChange:r=>{const o=t.activeWidgets.get(r.target.value);o?t.showWidget(o):t.notify(`Widget not found ${r.target.value}`,"warning")},children:[...l.values()].map(r=>{const o=i.getWidgetType(r.type),{HeadingComponent:d,heading:s}=o;return e.jsxs(E,{"data-testid":`widget-drawer-selects-item-${r.type}`,value:r.id,children:[d?e.jsx(d,{model:r}):e.jsx(x,{variant:"h6",color:"inherit",children:s}),e.jsx(g,{"data-testid":`${r.type}-drawer-delete`,color:"inherit","aria-label":"Delete",onClick:()=>{t.hideWidget(r)},children:e.jsx(H,{})})]},r.id)})})})}),O=m()(t=>({spacer:{flexGrow:1},headerFocused:{background:t.palette.secondary.main},headerUnfocused:{background:t.palette.secondary.dark}})),U=p(function({session:t,setToolbarHeight:n,onPopoutDrawer:l}){var a,i;const{classes:r}=O(),o=t.focusedViewId,d=(i=(a=t.visibleWidget)===null||a===void 0?void 0:a.view)===null||i===void 0?void 0:i.id;return e.jsx(S,{position:"sticky",className:o===d?r.headerFocused:r.headerUnfocused,ref:s=>{n((s==null?void 0:s.getBoundingClientRect().height)||0)},children:e.jsxs(M,{disableGutters:!0,children:[e.jsx(A,{session:t}),e.jsx(v,{title:"Open drawer in dialog",children:e.jsx(g,{color:"inherit",onClick:()=>{l()},children:e.jsx(P,{})})}),e.jsx("div",{className:r.spacer}),e.jsx(B,{session:t})]})})}),q=c.lazy(()=>R(()=>import("./ModalWidget--bxUKXsT.js"),__vite__mapDeps([0,1,2]),import.meta.url)),J=p(function({session:t}){const{visibleWidget:n}=t,{pluginManager:l}=y.getEnv(t),a=n?l.evaluateExtensionPoint("Core-replaceWidget",l.getWidgetType(n.type).ReactComponent,{session:t,model:n}):null,[i,r]=c.useState(0),[o,d]=c.useState(!1);return e.jsxs(N,{session:t,children:[e.jsx(U,{onPopoutDrawer:()=>{d(!0)},session:t,setToolbarHeight:r}),e.jsx(c.Suspense,{fallback:e.jsx(j.LoadingEllipses,{}),children:e.jsx(F.ErrorBoundary,{FallbackComponent:({error:s})=>e.jsx(j.ErrorMessage,{error:s}),children:a?o?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Opened in dialog..."}),e.jsx(q,{session:t,onClose:()=>{d(!1)}})]}):e.jsxs(e.Fragment,{children:[e.jsx(a,{model:n,session:t,toolbarHeight:i}),e.jsx("div",{style:{height:300}})]}):null})})]})});export{J as default};
//# sourceMappingURL=DrawerWidget-DPIfzY9I.js.map
