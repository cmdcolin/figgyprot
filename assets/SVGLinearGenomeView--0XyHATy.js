import{bZ as P,j as t,u as i,d6 as $,d7 as E,d8 as H,d9 as A,I as O,da as G,b_ as L,d as N}from"./index-CGKDrrCR.js";import{S as M,t as z,a as _}from"./util-Dq-dUS2h.js";function C({width:e,height:s,shift:o}){const l=P();return t.jsx("rect",{width:e+o*2,height:s,fill:i.stripAlpha(l.palette.background.default)})}function I({model:e,fontSize:s}){const{offsetPx:o,dynamicBlocks:{totalWidthPxWithoutBorders:l,totalBp:m}}=e,c=P(),h=i.getBpDisplayStr(m),n=Math.max(-o,0),d=n+l,a=i.stripAlpha(c.palette.text.secondary),f=n+(d-n)/2,x=s;return t.jsxs(t.Fragment,{children:[t.jsx("line",{x1:n,x2:d,y1:10,y2:10,stroke:a}),t.jsx("line",{x1:n,x2:n,y1:5,y2:15,stroke:a}),t.jsx("line",{x1:d,x2:d,y1:5,y2:15,stroke:a}),t.jsx("text",{x:f,y:x,textAnchor:"middle",dominantBaseline:"hanging",fontSize:s,fill:a,children:h})]})}function J({model:e,fontSize:s,cytobandHeight:o,rulerHeight:l}){const{width:m,assemblyNames:c,showCytobands:h,displayedRegions:n}=e,{assemblyManager:d}=i.getSession(e),a=c.length>1?"":c[0],f=d.get(a),x=P(),j=i.stripAlpha(x.palette.text.primary),r=$.create({displayedRegions:JSON.parse(JSON.stringify(n)),interRegionPaddingWidth:0,minimumBlockWidth:e.minimumBlockWidth}),w=e.dynamicBlocks.contentBlocks;if(!w.length)return null;r.setVolatileWidth(m),r.showAllRegions();const b=r.dynamicBlocks.contentBlocks[0],g=w.at(0),y=w.at(-1),p=r.bpToPx({...g,coord:g.reversed?g.end:g.start})||0,v=r.bpToPx({...y,coord:y.reversed?y.start:y.end})||0,k=+h*o;return t.jsxs("g",{id:"header",children:[t.jsx("text",{x:0,y:0,dominantBaseline:"hanging",fontSize:s,fill:j,children:a}),h?t.jsxs("g",{transform:`translate(0 ${l})`,children:[t.jsx(E,{overview:r,assembly:f,block:b}),t.jsx("rect",{stroke:"red",fill:"rgb(255,0,0)",fillOpacity:.1,width:Math.max(v-p,.5),height:H-1,x:p,y:.5}),t.jsx("g",{transform:`translate(0,${H})`,children:t.jsx(A,{overview:r,model:e,useOffset:!1})})]}):null,t.jsx("g",{transform:`translate(0 ${s+k})`,children:t.jsx(I,{model:e,fontSize:s})}),t.jsx("g",{transform:`translate(0 ${l+k})`,children:t.jsx(M,{model:e,fontSize:s})})]})}async function X(e,s){await O(()=>e.initialized);const{textHeight:o=18,headerHeight:l=40,rulerHeight:m=50,fontSize:c=13,cytobandHeight:h=100,trackLabels:n="offset",themeName:d="default",Wrapper:a=({children:u})=>u}=s,f=i.getSession(e),{allThemes:x}=f,j=x==null?void 0:x()[d],{width:r,pinnedTracks:w,unpinnedTracks:b,tracks:g,showCytobands:y}=e,p=50,v=+y*h,k=l+m+v+10,S=z(g,o,n)+k+100,W=await Promise.all([...w,...b].map(async u=>{const R=u.displays[0];return await O(()=>!R.renderProps().notReady),{track:u,result:await R.renderSvg({...s,theme:j})}})),V=i.max(g.map(u=>i.measureText(G.getTrackName(u.configuration,f),c)),0)+40,B=n==="left"?V:0,T=r+B;return i.renderToStaticMarkup(t.jsx(L,{theme:N.createJBrowseTheme(j),children:t.jsx(a,{children:t.jsxs("svg",{width:T,height:S,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:[0,0,T+p*2,S].toString(),children:[t.jsx(C,{width:T,height:S,shift:p}),t.jsxs("g",{transform:`translate(${p} 0)`,children:[t.jsx("g",{transform:`translate(${B})`,children:t.jsx(J,{model:e,fontSize:c,rulerHeight:m,cytobandHeight:h})}),t.jsx("g",{transform:`translate(0 ${k})`,children:t.jsx(_,{textHeight:o,fontSize:c,model:e,displayResults:W,trackLabels:n,trackLabelOffset:B})})]})]})})}))}export{M as SVGRuler,_ as SVGTracks,X as renderToSvg};
//# sourceMappingURL=SVGLinearGenomeView--0XyHATy.js.map
