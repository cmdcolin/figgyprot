import{a6 as X,m as B,a as w,j as i,c as H,D as P,f as j,C as k,d as O,e as U,B as E}from"./index-DQP-8m57.js";const{parseCigar:q}=X;function L(t,n){let o=0,c=0;for(let a=0;a<t.length;a++){const d=+t[a],s=t[a+1],r=Math.min(d,n-o);if(o>=n)break;s==="I"?c+=d:s==="D"?o+=r:(s==="M"||s==="="||s==="X")&&(c+=r,o+=r)}return[o,c]}async function W({feature:t,windowSize:n,session:o,trackId:c,region:a,horizontallyFlip:d}){const s=t.get("CIGAR"),r=t.get("strand"),y=t.get("refName"),p=t.get("assemblyName"),l=t.get("start"),S=t.get("end"),g=t.get("mate"),m=g.start,e=g.end,M=g.assemblyName,R=g.refName;let h,f,u,x;if(a&&s){const I=a.start,N=a.end,C=q(s),[T,F]=L(C,I-l),[G,V]=L(C,N-l),b=r===-1?-1:1;u=l+T,x=l+G,h=(r===-1?e:m)+F*b,f=(r===-1?e:m)+V*b}else u=l,x=S,h=m,f=e;const v=o.addView("LinearSyntenyView",{type:"LinearSyntenyView",views:[{type:"LinearGenomeView",hideHeader:!0},{type:"LinearGenomeView",hideHeader:!0}],tracks:[{configuration:c,type:"SyntenyTrack",displays:[{type:"LinearSyntenyDisplay",configuration:`${c}-LinearSyntenyDisplay`}]}]}),$=`${y}:${Math.floor(u-n)}-${Math.floor(x+n)}`,z=Math.min(h,f),A=Math.max(h,f),D=`${R}:${Math.floor(z-n)}-${Math.floor(A+n)}${d?"[rev]":""}`;await Promise.all([v.views[0].navToLocString($,p),v.views[1].navToLocString(D,M)])}const J=B()({padding:{margin:10,border:"1px solid #ccc"}});function Q({session:t,view:n,feature:o,trackId:c,handleClose:a}){const{classes:d}=J(),s=o.get("strand")===-1,r=!!o.get("CIGAR"),[y,p]=w.useState(s),[l,S]=w.useState("1000"),[g,m]=w.useState(!0);return i.jsxs(H.Dialog,{open:!0,title:"Launch synteny view",onClose:a,children:[i.jsxs(P,{children:[n&&r?i.jsx(j,{className:d.padding,control:i.jsx(k,{checked:g,onChange:e=>{m(e.target.checked)}}),label:"Use CIGAR string to navigate the current visible to the target"}):null,s?i.jsx(j,{className:d.padding,control:i.jsx(k,{checked:y,onChange:e=>{p(e.target.checked)}}),label:`Note: The feature is inverted in orientation on the target
            sequence. This will result in the lower panel having genomic
            coordinates decreasing left to right. Horizontally flip?`}):null,i.jsx(O,{label:"Add window size in bp",value:l,onChange:e=>{S(e.target.value)}})]}),i.jsxs(U,{children:[i.jsx(E,{variant:"contained",onClick:()=>{(async()=>{try{await W({feature:o,windowSize:+l,horizontallyFlip:y,trackId:c,session:t,region:g?n==null?void 0:n.dynamicBlocks.contentBlocks[0]:void 0})}catch(e){console.error(e),t.notifyError(`${e}`,e)}})(),a()},children:"Submit"}),i.jsx(E,{variant:"contained",color:"secondary",onClick:()=>{a()},children:"Cancel"})]})]})}export{Q as default};
//# sourceMappingURL=LaunchSyntenyViewDialog-DvpdVwL9.js.map
