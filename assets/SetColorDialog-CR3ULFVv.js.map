{"version":3,"file":"SetColorDialog-CR3ULFVv.js","sources":["../../node_modules/@jbrowse/plugin-wiggle/esm/MultiLinearWiggleDisplay/components/SourcesGrid.js","../../node_modules/@jbrowse/plugin-wiggle/esm/MultiLinearWiggleDisplay/components/SetColorDialog.js"],"sourcesContent":["import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport { SanitizedHTML } from '@jbrowse/core/ui';\nimport ColorPicker, { ColorPopover } from '@jbrowse/core/ui/ColorPicker';\nimport { getStr, measureGridWidth } from '@jbrowse/core/util';\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\nimport KeyboardDoubleArrowDownIcon from '@mui/icons-material/KeyboardDoubleArrowDown';\nimport KeyboardDoubleArrowUpIcon from '@mui/icons-material/KeyboardDoubleArrowUp';\nimport { Button } from '@mui/material';\nimport { DataGrid } from '@mui/x-data-grid';\nimport { makeStyles } from 'tss-react/mui';\nimport { moveDown, moveUp } from './util';\nconst useStyles = makeStyles()({\n    cell: {\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n    },\n});\nfunction SourcesGrid({ rows, onChange, showTips, }) {\n    const { classes } = useStyles();\n    const [anchorEl, setAnchorEl] = useState(null);\n    const [selected, setSelected] = useState([]);\n    const { name: _name, color: _color, baseUri: _baseUri, ...rest } = rows[0];\n    const [widgetColor, setWidgetColor] = useState('blue');\n    const [currSort, setCurrSort] = useState({\n        idx: 0,\n        field: null,\n    });\n    return (_jsxs(\"div\", { children: [_jsx(Button, { disabled: !selected.length, onClick: event => {\n                    setAnchorEl(event.currentTarget);\n                }, children: \"Change color of selected items\" }), _jsxs(Button, { onClick: () => {\n                    onChange(moveUp([...rows], selected));\n                }, disabled: !selected.length, children: [_jsx(KeyboardArrowUpIcon, {}), showTips ? 'Move selected items up' : null] }), _jsxs(Button, { onClick: () => {\n                    onChange(moveDown([...rows], selected));\n                }, disabled: !selected.length, children: [_jsx(KeyboardArrowDownIcon, {}), showTips ? 'Move selected items down' : null] }), _jsxs(Button, { onClick: () => {\n                    onChange(moveUp([...rows], selected, rows.length));\n                }, disabled: !selected.length, children: [_jsx(KeyboardDoubleArrowUpIcon, {}), showTips ? 'Move selected items to top' : null] }), _jsxs(Button, { onClick: () => {\n                    onChange(moveDown([...rows], selected, rows.length));\n                }, disabled: !selected.length, children: [_jsx(KeyboardDoubleArrowDownIcon, {}), showTips ? 'Move selected items to bottom' : null] }), _jsx(ColorPopover, { anchorEl: anchorEl, color: widgetColor, onChange: c => {\n                    setWidgetColor(c);\n                    for (const id of selected) {\n                        const elt = rows.find(f => f.name === id);\n                        if (elt) {\n                            elt.color = c;\n                        }\n                    }\n                    onChange([...rows]);\n                }, onClose: () => {\n                    setAnchorEl(null);\n                } }), _jsx(\"div\", { style: { height: 400, width: '100%' }, children: _jsx(DataGrid, { getRowId: row => row.name, checkboxSelection: true, onRowSelectionModelChange: arg => {\n                        setSelected([...arg.ids]);\n                    }, rows: rows, rowHeight: 25, columnHeaderHeight: 33, columns: [\n                        {\n                            field: 'color',\n                            headerName: 'Color',\n                            renderCell: ({ value, id }) => (_jsx(ColorPicker, { color: value || 'blue', onChange: c => {\n                                    const elt = rows.find(f => f.name === id);\n                                    if (elt) {\n                                        elt.color = c;\n                                    }\n                                    onChange([...rows]);\n                                } })),\n                        },\n                        {\n                            field: 'name',\n                            headerName: 'Name',\n                            width: measureGridWidth(rows.map(r => r.name)),\n                        },\n                        ...Object.keys(rest).map(val => ({\n                            field: val,\n                            renderCell: ({ value }) => (_jsx(\"div\", { className: classes.cell, children: _jsx(SanitizedHTML, { html: getStr(value) }) })),\n                            width: measureGridWidth(rows.map(r => `${r[val]}`)),\n                        })),\n                    ], sortModel: [], onSortModelChange: args => {\n                        const sort = args[0];\n                        const idx = (currSort.idx + 1) % 2;\n                        const field = sort.field || currSort.field;\n                        setCurrSort({ idx, field });\n                        onChange(field\n                            ? [...rows].sort((a, b) => {\n                                const aa = getStr(a[field]);\n                                const bb = getStr(b[field]);\n                                return idx === 1\n                                    ? aa.localeCompare(bb)\n                                    : bb.localeCompare(aa);\n                            })\n                            : rows);\n                    } }) })] }));\n}\nexport default SourcesGrid;\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { useState } from 'react';\nimport DraggableDialog from '@jbrowse/core/ui/DraggableDialog';\nimport { useLocalStorage } from '@jbrowse/core/util';\nimport { Button, DialogActions, DialogContent } from '@mui/material';\nimport { makeStyles } from 'tss-react/mui';\nimport SourcesGrid from './SourcesGrid';\nconst useStyles = makeStyles()({\n    content: {\n        minWidth: 800,\n    },\n    float: {\n        float: 'right',\n    },\n});\nexport default function SetColorDialog({ model, handleClose, }) {\n    const { classes } = useStyles();\n    const { sources } = model;\n    const [currLayout, setCurrLayout] = useState(structuredClone(sources || []));\n    const [showTips, setShowTips] = useLocalStorage('multiwiggle-showTips', false);\n    return (_jsxs(DraggableDialog, { open: true, onClose: handleClose, maxWidth: \"xl\", title: \"Multi-wiggle color/arrangement editor\", children: [_jsxs(DialogContent, { className: classes.content, children: [_jsx(Button, { variant: \"contained\", className: classes.float, onClick: () => {\n                            setShowTips(!showTips);\n                        }, children: showTips ? 'Hide tips' : 'Show tips' }), _jsx(\"br\", {}), showTips ? (_jsxs(_Fragment, { children: [\"Helpful tips\", _jsxs(\"ul\", { children: [_jsx(\"li\", { children: \"You can select rows in the table with the checkboxes\" }), _jsx(\"li\", { children: \"Multi-select is enabled with shift-click and control-click\" }), _jsx(\"li\", { children: \"The \\\"Move selected items up/down\\\" can re-arrange subtracks\" }), _jsx(\"li\", { children: \"Sorting the data grid itself can also re-arrange subtracks\" }), _jsx(\"li\", { children: \"Changes are applied when you hit Submit\" }), _jsx(\"li\", { children: \"You can click and drag the dialog box to move it on the screen\" }), _jsx(\"li\", { children: \"Columns in the table can be hidden using a vertical '...' menu on the right side of each column\" })] })] })) : null, _jsx(SourcesGrid, { rows: currLayout, onChange: setCurrLayout, showTips: showTips })] }), _jsxs(DialogActions, { children: [_jsx(Button, { variant: \"contained\", type: \"submit\", color: \"inherit\", onClick: () => {\n                            model.clearLayout();\n                            setCurrLayout(model.sources || []);\n                        }, children: \"Clear custom settings\" }), _jsx(Button, { variant: \"contained\", color: \"secondary\", onClick: () => {\n                            handleClose();\n                            setCurrLayout([...(model.sources || [])]);\n                        }, children: \"Cancel\" }), _jsx(Button, { variant: \"contained\", color: \"primary\", type: \"submit\", onClick: () => {\n                            model.setLayout(currLayout);\n                            handleClose();\n                        }, children: \"Submit\" })] })] }));\n}\n"],"names":["useStyles","makeStyles","SourcesGrid","rows","onChange","showTips","classes","anchorEl","setAnchorEl","useState","selected","setSelected","_name","_color","_baseUri","rest","widgetColor","setWidgetColor","currSort","setCurrSort","_jsxs","_jsx","Button","event","moveUp","KeyboardArrowUpIcon","moveDown","KeyboardArrowDownIcon","KeyboardDoubleArrowUpIcon","KeyboardDoubleArrowDownIcon","ColorPopover","c","id","elt","f","DataGrid","row","arg","value","ColorPicker","measureGridWidth","r","val","SanitizedHTML","getStr","args","sort","idx","field","a","b","aa","bb","SetColorDialog","model","handleClose","sources","currLayout","setCurrLayout","setShowTips","useLocalStorage","DraggableDialog","DialogContent","_Fragment","DialogActions"],"mappings":"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","x_google_ignoreList":[0,1]}