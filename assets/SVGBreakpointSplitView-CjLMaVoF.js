import{bZ as R,j as t,a0 as d,cM as I,I as M,a1 as N,b_ as B}from"./index-CGKDrrCR.js";import{t as G,S as T,a as L}from"./util-Dq-dUS2h.js";import{O as V}from"./Overlay-CarEmcA-.js";function E({width:a,height:n,shift:i}){const e=R();return t.jsx("rect",{width:a+i*2,height:n,fill:d.stripAlpha(e.palette.background.default)})}function _(a,n,i){return d.max(a.flatMap(e=>e.tracks.map(c=>d.measureText(I.getTrackName(c.configuration,i),n))),0)}function A(a,n,i=0){const e={};let c=n;for(const u of a.tracks)e[u.configuration.trackId]=c+i,c+=u.displays[0].height+n;return e}async function Y(a,n){var i;const{textHeight:e=18,headerHeight:c=30,rulerHeight:u=30,fontSize:r=13,trackLabels:m="offset",Wrapper:$=({children:s})=>s,themeName:O="default"}=n,j=d.getSession(a),y=(i=j.allThemes)===null||i===void 0?void 0:i.call(j)[O],{width:w,views:l}=a,x=50,p=c+u,v=l.map(s=>G(s.tracks,e,m)+p),k=d.sum(v)+100,f=await Promise.all(l.map(async s=>({view:s,data:await Promise.all(s.tracks.map(async o=>{const g=o.displays[0];return await M(()=>g.ready!==void 0?g.ready:!0),{track:o,result:await g.renderSvg({...n,theme:y})}}))}))),z=_(l,r,j)+40,h=m==="left"?z:0,H=m==="offset"?e:0,P=l.map((s,o)=>A(s,H,r+(o>0?v[o-1]:0)+p)),b=w+h,S=N.createJBrowseTheme(y);return d.renderToStaticMarkup(t.jsx(B,{theme:S,children:t.jsx($,{children:t.jsxs("svg",{width:w,height:k,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:[0,0,b+x*2,k].toString(),children:[t.jsx(E,{width:b,height:k,shift:x}),l[0]?t.jsxs("g",{transform:`translate(${x} ${r})`,children:[t.jsxs("g",{transform:`translate(${h})`,children:[t.jsx("text",{x:0,fontSize:r,fill:S.palette.text.primary,children:l[0].assemblyNames.join(", ")}),t.jsx(T,{model:f[0].view,fontSize:r})]}),t.jsx("g",{transform:`translate(0 ${p})`,children:t.jsx(L,{textHeight:e,trackLabels:m,fontSize:r,model:f[0].view,displayResults:f[0].data,trackLabelOffset:h})})]}):null,l[1]?t.jsxs("g",{transform:`translate(${x} ${r+v[0]})`,children:[t.jsxs("g",{transform:`translate(${h})`,children:[t.jsx("text",{x:0,fontSize:r,fill:S.palette.text.primary,children:l[1].assemblyNames.join(", ")}),t.jsx(T,{model:f[1].view,fontSize:r})]}),t.jsx("g",{transform:`translate(0 ${p})`,children:t.jsx(L,{textHeight:e,trackLabels:m,fontSize:r,model:f[1].view,displayResults:f[1].data,trackLabelOffset:h})})]}):null,t.jsx("defs",{children:t.jsx("clipPath",{id:"clip-bsv",children:t.jsx("rect",{x:0,y:0,width:w,height:k})})}),t.jsx("g",{transform:`translate(${h+x})`,clipPath:"url(#clip-bsv)",children:a.matchedTracks.map(s=>t.jsx(V,{parentRef:{current:null},model:a,trackId:s.configuration.trackId,getTrackYPosOverride:(o,g)=>P[g][o]},s.configuration.trackId))})]})})}))}export{Y as renderToSvg};
//# sourceMappingURL=SVGBreakpointSplitView-CjLMaVoF.js.map
