import{U as M,cp as U,a as l,u as g,y as d,j as t,c as b,o as y,m as S,t as N,D,B as h,aU as v}from"./index-BXtJZUZx.js";import{D as O}from"./Dialog-Cx4gvGwW.js";import{B as j}from"./BaseCard-DuBvzODX.js";var P=U();const E=M(P);function R({config:e}){const[a,s]=l.useState(),[n,r]=l.useState(),c=g.getSession(e),{rpcManager:m}=c;l.useEffect(()=>{(async()=>{try{const i=d.readConfObject(e,"adapter"),u=await m.call(e.trackId,"CoreGetInfo",{adapterConfig:i});r(u)}catch(i){console.error(i),s(i)}})()},[e,m]);const p=typeof n=="string"?{header:`<pre>${n.replaceAll("<","&lt;").replaceAll(">","&gt;")}</pre>`}:n||{};return t.jsx(j,{title:"File info",children:a?t.jsx(b.ErrorMessage,{error:a}):n===void 0?t.jsx(b.LoadingEllipses,{message:"Loading file data"}):t.jsx(E,{attributes:p})})}const A=1e4,I=S()(e=>({container:{minWidth:800},refNames:{maxHeight:300,overflow:"auto",flexGrow:1,background:e.palette.background.default}})),F=y(function({config:e,onClose:a}){const{classes:s}=I(),[n,r]=l.useState(),[c,m]=l.useState(),[p,i]=l.useState(!1),{rpcManager:u}=g.getSession(e);l.useEffect(()=>{(async()=>{try{const o=await Promise.all([...new Set(N.getConfAssemblyNames(e))].map(async f=>{const w=d.readConfObject(e,"adapter");return[f,await u.call(e.trackId,"CoreGetRefNames",{adapterConfig:w,regions:[{assemblyName:f}]})]}));m(Object.fromEntries(o))}catch(o){console.error(o),r(o)}})()},[e,u]);const x=c?Object.entries(c):[],C=x.flatMap(([o,f])=>[`--- ${o} ---`,...f.slice(0,A),f.length>A?`
Too many refNames to show in browser for ${o}, use "Copy ref names" button to copy to clipboard`:""]).filter(o=>!!o).join(`
`);return t.jsx(b.Dialog,{open:!0,title:"Reference sequence names used in track",onClose:a,maxWidth:"xl",children:t.jsx(D,{className:s.container,children:n?t.jsx(b.ErrorMessage,{error:n}):c===void 0?t.jsx(b.LoadingEllipses,{message:"Loading refNames"}):t.jsxs(t.Fragment,{children:[t.jsx(h,{variant:"contained",onClick:()=>{v(x.flatMap(([o,f])=>[`--- ${o} ---`,...f]).filter(o=>!!o).join(`
`)),i(!0),setTimeout(()=>{i(!1)},1e3)},children:p?"Copied to clipboard!":"Copy ref names"}),t.jsx("pre",{className:s.refNames,children:C})]})})})}),$=S()({content:{minWidth:800},button:{float:"right"}});function k(e,a){for(const s in e)s===a?delete e[s]:typeof e[s]=="object"&&k(e[s],a);return e}const B=y(function({config:e}){const[a,s]=l.useState(!1),n=d.readConfObject(e),r=g.getSession(e),{classes:c}=$(),[m,p]=l.useState(!1),i=d.getConf(r,["formatAbout","hideUris"])||d.readConfObject(e,["formatAbout","hideUris"]),{pluginManager:u}=g.getEnv(r),x=u.evaluateExtensionPoint("Core-customizeAbout",{config:{...n,...d.getConf(r,["formatAbout","config"],{config:n}),...d.readConfObject(e,["formatAbout","config"],{config:n})}},{session:r,config:e}),C=u.evaluateExtensionPoint("Core-extraAboutPanel",null,{session:r,config:e});return t.jsxs("div",{className:c.content,children:[t.jsxs(j,{title:"Configuration",children:[i?null:t.jsxs("span",{className:c.button,children:[t.jsx(h,{variant:"contained",color:"secondary",onClick:()=>{p(!0)},children:"Show ref names"}),t.jsx(h,{variant:"contained",onClick:()=>{const o=k(structuredClone(n),"baseUri");v(JSON.stringify(o,null,2)),s(!0),setTimeout(()=>{s(!1)},1e3)},children:a?"Copied to clipboard!":"Copy config"})]}),t.jsx(E,{attributes:x.config,omit:["displays","baseUri","refNames","formatAbout","metadata"],hideUris:i})]}),x.config.metadata?t.jsx(j,{title:"Metadata",children:t.jsx(E,{attributes:x.config.metadata,omit:["displays","baseUri","refNames","formatAbout"],hideUris:i})}):null,C?t.jsx(j,{title:C.name,children:t.jsx(C.Component,{config:e})}):null,t.jsx(R,{config:e}),m?t.jsx(F,{config:e,onClose:()=>{p(!1)}}):null]})});function G({config:e,handleClose:a}){const s=g.getSession(e),n=N.getTrackName(e,s),{pluginManager:r}=g.getEnv(s),c=r.evaluateExtensionPoint("Core-replaceAbout",B,{session:s,config:e});return t.jsx(O,{open:!0,onClose:a,title:n,maxWidth:"xl",children:t.jsx(c,{config:e})})}export{G as default};
//# sourceMappingURL=AboutDialog-C1QndDDM.js.map
