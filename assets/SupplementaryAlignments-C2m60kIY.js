const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CGKDrrCR.js","./index-DIqbght7.css"])))=>i.map(i=>d[i]);
import{p as u,dq as N,G as E,dr as $,c as y,j as n,T as x,n as b,L as h,_ as v,ds as k}from"./index-CGKDrrCR.js";import{n as A,_ as R}from"./AlignmentsFeatureDetail-CUzs0kIY.js";async function D({view:e,feature:s}){var a;const{assemblyManager:r}=u.getSession(e),i=s.get("CIGAR"),l=s.get("strand"),d=((a=s.get("tags"))===null||a===void 0?void 0:a.SA)||"",m=s.get("name"),t=N(i,1),g=await r.waitForAssembly(e.assemblyNames[0]);if(!g)throw new Error("assembly not found");const p=E(d,s.id(),l,m,!0),o=s.toJSON();o.clipPos=t,o.strand=1,o.mate={refName:m,start:t,end:t+$(i)};const S=[o,...p];for(const[f,c]of S.entries())c.refName=g.getCanonicalRefName(c.refName)||c.refName,c.syntenyId=f,c.mate.syntenyId=f,c.mate.uniqueId=`${c.uniqueId}_mate`;return S.sort((f,c)=>f.clipPos-c.clipPos),S}const C=y.lazy(()=>v(()=>import("./index-CGKDrrCR.js").then(e=>e.gl),__vite__mapDeps([0,1]),import.meta.url)),P=y.lazy(()=>v(()=>import("./index-CGKDrrCR.js").then(e=>e.gm),__vite__mapDeps([0,1]),import.meta.url));function V({model:e,feature:s}){const{view:a}=e,[r,i]=y.useState(),[l,d]=y.useState();y.useEffect(()=>{(async()=>{try{const t=await D({view:a,feature:new u.SimpleFeature(s)});i(t)}catch(t){d(t),console.error(t)}})()},[s,a]);const m=[];if(r)for(let t=0;t<r.length-1;t++)m.push([r[t],r[t+1]]);return m.length?n.jsxs("div",{children:[n.jsx(x,{children:"Launch split view"}),l?n.jsx(b.ErrorMessage,{error:l}):null,n.jsx("ul",{children:m.map((t,g)=>{const[p,o]=t;return n.jsxs("li",{children:[p.refName,":",u.toLocale(p.strand===1?p.end:p.start)," ->"," ",o.refName,":",u.toLocale(o.strand===1?o.start:o.end)," ",n.jsx(B,{model:e,f1:p,f2:o})," ",n.jsx(I,{model:e,f1:p,f2:o})]},`${JSON.stringify(t)}-${g}`)})})]}):null}function B({model:e,f1:s,f2:a}){return n.jsx(h,{href:"#",onClick:r=>{r.preventDefault();const i=u.getSession(e);i.queueDialog(l=>[C,{handleClose:l,session:i,feature:new u.SimpleFeature({...s,mate:a}),view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])},children:"(top/bottom)"})}function I({model:e,f1:s,f2:a}){return n.jsx(h,{href:"#",onClick:r=>{r.preventDefault();const i=u.getSession(e);i.queueDialog(l=>[P,{handleClose:l,session:i,feature:new u.SimpleFeature({...s,mate:a}),view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])},children:"(single row)"})}function O({tag:e,model:s}){return n.jsxs("div",{children:[n.jsx(x,{children:"List of supplementary alignment locations"}),n.jsx("ul",{children:e.split(";").filter(a=>!!a).map((a,r)=>{const[i,l,d,m]=a.split(","),t=k(m),g=Math.floor(t/5),p=+l,o=+l+t,S=p-g,f=o+g,c=`${i}:${Math.max(1,S)}-${f}`,w=p.toLocaleString("en-US"),L=o.toLocaleString("en-US"),j=`${i}:${w}-${L} (${d}) [${t}bp]`;return n.jsx("li",{children:n.jsx(h,{href:"#",onClick:async _=>{_.preventDefault(),A(c,s)},children:j})},`${c}-${r}`)})})]})}function q(e){const{model:s,tag:a,feature:r}=e,i=u.getSession(s),{pluginManager:l}=u.getEnv(i);let d=!1;try{d=!!l.getViewType("BreakpointSplitView")}catch{}return n.jsxs(R,{...e,title:"Supplementary alignments",children:[n.jsx(O,{model:s,tag:a}),d?n.jsx(V,{model:s,feature:r}):null]})}export{q as default};
//# sourceMappingURL=SupplementaryAlignments-C2m60kIY.js.map
