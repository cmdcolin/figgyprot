import{S as r,b5 as j,b7 as x,J as S,b9 as T}from"./index-CGKDrrCR.js";const y=.3,E=2;function H(t,I){const{stopToken:p,features:g,regions:M,bpPerPx:u,scaleOpts:s,height:b,config:n}=I,d=M[0],N=r.readConfObject(n,"bicolorPivot"),V=r.readConfObject(n,"bicolorPivotValue"),k=r.readConfObject(n,"negColor"),C=r.readConfObject(n,"posColor"),F=r.readConfObject(n,"color"),_=r.readConfObject(n,"clipColor"),P=N!=="none"&&s.scaleType!=="log",R=j({...s,pivotValue:P?V:void 0,range:P?[k,"#eee",C]:["#eee",C]}),A=j({...s,range:[0,b]}),D=F==="#f0f"?(e,o)=>R(o):(e,o)=>r.readConfObject(n,"color",{feature:e,score:o}),h=A.domain(),m=h[0],v=h[1];let w=Number.NEGATIVE_INFINITY,f=!1;const O=[];let a=performance.now();for(const e of g.values()){performance.now()-a>400&&(x(p),a=performance.now());const[o,i]=S.featureSpanPx(e,d,u);Math.floor(o)!==Math.floor(w)&&(O.push(e),w=o);const c=e.get("score");f=f||c>v||c<m;const l=i-o+y;t.fillStyle=D(e,c),t.fillRect(o,0,l,b)}if(t.save(),f){t.fillStyle=_;for(const e of g.values()){performance.now()-a>400&&(x(p),a=performance.now());const[o,i]=S.featureSpanPx(e,d,u),c=i-o+y,l=e.get("score");l>v?T(o,0,c,E,t):l<m&&s.scaleType!=="log"&&T(o,0,c,E,t)}}return t.restore(),{reducedFeatures:O}}export{H as drawDensity};
//# sourceMappingURL=drawDensity-C_AlqdQa.js.map
