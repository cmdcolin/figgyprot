{"version":3,"mappings":"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","names":["SyntenyContextMenu","model","onClose","anchorEl","view","getContainingView","clientX","clientY","feature","_jsx","Menu","event","callback","x","y","f","start","end","refName","mate","l1","l2","e","err","getSession","SyntenyTooltip","lazy","__vitePreload","useStyles","makeStyles","LinearSyntenyRendering","observer","classes","mouseoverId","height","xOffset","useRef","width","delta","scheduled","timeout","setAnchorEl","useState","tooltip","setTooltip","currX","setCurrX","mouseCurrDownX","setMouseCurrDownX","mouseInitialDownX","setMouseInitialDownX","currY","setCurrY","mainSyntenyCanvasRefp","mouseoverDetectionCanvasRef","useCallback","ref","mainSyntenyCanvasRef","useEffect","_a","onWheel","v","transaction","clickMapCanvasRef","cigarClickMapCanvasRef","_jsxs","ref1","ref2","rect","ctx1","ctx2","r1","g1","b1","r2","g2","b2","unitMultiplier","MAX_COLOR_RANGE","id","getId","cigar","unitMultiplier2","cigarIdx","getTooltip","evt","onSynClick","onSynContextClick","theme","bg","LoadingMessage","shown","setShown","LoadingEllipses","BlockMessage","messageText","BlockError","error","ServerSideRenderedBlockContent"],"ignoreList":[0,1,2],"sources":["../../node_modules/@jbrowse/plugin-linear-comparative-view/esm/LinearSyntenyDisplay/components/SyntenyContextMenu.js","../../node_modules/@jbrowse/plugin-linear-comparative-view/esm/LinearSyntenyDisplay/components/LinearSyntenyRendering.js","../../node_modules/@jbrowse/plugin-linear-comparative-view/esm/LinearSyntenyDisplay/components/Component.js"],"sourcesContent":["import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Menu } from '@jbrowse/core/ui';\nimport { getContainingView, getSession } from '@jbrowse/core/util';\nexport default function SyntenyContextMenu({ model, onClose, anchorEl, }) {\n    const view = getContainingView(model);\n    const { clientX, clientY, feature } = anchorEl;\n    return (_jsx(Menu, { onMenuItemClick: (event, callback) => {\n            callback(event);\n            onClose();\n        }, anchorEl: {\n            nodeType: 1,\n            getBoundingClientRect: () => {\n                const x = clientX;\n                const y = clientY;\n                return {\n                    top: y,\n                    left: x,\n                    bottom: y,\n                    right: x,\n                    width: 0,\n                    height: 0,\n                    x,\n                    y,\n                    toJSON() { },\n                };\n            },\n        }, onClose: onClose, open: Boolean(anchorEl), menuItems: [\n            {\n                label: 'Center on feature',\n                onClick: () => {\n                    const { f } = feature;\n                    const start = f.get('start');\n                    const end = f.get('end');\n                    const refName = f.get('refName');\n                    const mate = f.get('mate');\n                    const l1 = view.views[model.level];\n                    const l2 = view.views[model.level + 1];\n                    l1.navToLocString(`${refName}:${start}-${end}`).catch((e) => {\n                        const err = `${l1.assemblyNames[0]}:${e}`;\n                        console.error(err);\n                        getSession(model).notifyError(err, e);\n                    });\n                    l2.navToLocString(`${mate.refName}:${mate.start}-${mate.end}`).catch((e) => {\n                        const err = `${l2.assemblyNames[0]}:${e}`;\n                        console.error(err);\n                        getSession(model).notifyError(err, e);\n                    });\n                },\n            },\n        ] }));\n}\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { lazy, useCallback, useEffect, useRef, useState } from 'react';\nimport { getContainingView } from '@jbrowse/core/util';\nimport { transaction } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { makeStyles } from 'tss-react/mui';\nimport { MAX_COLOR_RANGE, getId } from '../drawSynteny';\nimport SyntenyContextMenu from './SyntenyContextMenu';\nimport { getTooltip, onSynClick, onSynContextClick } from './util';\nconst SyntenyTooltip = lazy(() => import('./SyntenyTooltip'));\nconst useStyles = makeStyles()({\n    pix: {\n        imageRendering: 'pixelated',\n        pointerEvents: 'none',\n        visibility: 'hidden',\n        position: 'absolute',\n    },\n    rel: {\n        position: 'relative',\n    },\n    mouseoverCanvas: {\n        position: 'absolute',\n        pointEvents: 'none',\n    },\n    mainCanvas: {\n        position: 'absolute',\n    },\n});\nconst LinearSyntenyRendering = observer(function ({ model, }) {\n    const { classes } = useStyles();\n    const { mouseoverId, height } = model;\n    const xOffset = useRef(0);\n    const view = getContainingView(model);\n    const width = view.width;\n    const delta = useRef(0);\n    const scheduled = useRef(false);\n    const timeout = useRef(null);\n    const [anchorEl, setAnchorEl] = useState();\n    const [tooltip, setTooltip] = useState('');\n    const [currX, setCurrX] = useState();\n    const [mouseCurrDownX, setMouseCurrDownX] = useState();\n    const [mouseInitialDownX, setMouseInitialDownX] = useState();\n    const [currY, setCurrY] = useState();\n    const mainSyntenyCanvasRefp = useRef(null);\n    const mouseoverDetectionCanvasRef = useCallback((ref) => {\n        model.setMouseoverCanvasRef(ref);\n    }, [model, height, width]);\n    const mainSyntenyCanvasRef = useCallback((ref) => {\n        model.setMainCanvasRef(ref);\n        mainSyntenyCanvasRefp.current = ref;\n    }, [model, height, width]);\n    useEffect(() => {\n        var _a;\n        function onWheel(event) {\n            event.preventDefault();\n            if (event.ctrlKey) {\n                delta.current += event.deltaY / 500;\n                for (const v of view.views) {\n                    v.setScaleFactor(delta.current < 0 ? 1 - delta.current : 1 / (1 + delta.current));\n                }\n                if (timeout.current) {\n                    clearTimeout(timeout.current);\n                }\n                timeout.current = setTimeout(() => {\n                    var _a;\n                    for (const v of view.views) {\n                        v.setScaleFactor(1);\n                        v.zoomTo(delta.current > 0\n                            ? v.bpPerPx * (1 + delta.current)\n                            : v.bpPerPx / (1 - delta.current), event.clientX -\n                            (((_a = mainSyntenyCanvasRefp.current) === null || _a === void 0 ? void 0 : _a.getBoundingClientRect().left) ||\n                                0));\n                    }\n                    delta.current = 0;\n                }, 300);\n            }\n            else {\n                if (Math.abs(event.deltaY) < Math.abs(event.deltaX)) {\n                    xOffset.current += event.deltaX / 2;\n                }\n                if (!scheduled.current) {\n                    scheduled.current = true;\n                    window.requestAnimationFrame(() => {\n                        transaction(() => {\n                            for (const v of view.views) {\n                                v.horizontalScroll(xOffset.current);\n                            }\n                            xOffset.current = 0;\n                            scheduled.current = false;\n                        });\n                    });\n                }\n            }\n        }\n        (_a = mainSyntenyCanvasRefp.current) === null || _a === void 0 ? void 0 : _a.addEventListener('wheel', onWheel);\n        return () => {\n            var _a;\n            (_a = mainSyntenyCanvasRefp.current) === null || _a === void 0 ? void 0 : _a.removeEventListener('wheel', onWheel);\n        };\n    }, [model, height, width]);\n    const clickMapCanvasRef = useCallback((ref) => {\n        model.setClickMapCanvasRef(ref);\n    }, [model, height, width]);\n    const cigarClickMapCanvasRef = useCallback((ref) => {\n        model.setCigarClickMapCanvasRef(ref);\n    }, [model, height, width]);\n    return (_jsxs(\"div\", { className: classes.rel, children: [_jsx(\"canvas\", { ref: mouseoverDetectionCanvasRef, width: width, height: height, className: classes.mouseoverCanvas }), _jsx(\"canvas\", { ref: mainSyntenyCanvasRef, onMouseMove: event => {\n                    var _a;\n                    if (mouseCurrDownX !== undefined) {\n                        xOffset.current += mouseCurrDownX - event.clientX;\n                        setMouseCurrDownX(event.clientX);\n                        if (!scheduled.current) {\n                            scheduled.current = true;\n                            window.requestAnimationFrame(() => {\n                                transaction(() => {\n                                    for (const v of view.views) {\n                                        v.horizontalScroll(xOffset.current);\n                                    }\n                                    xOffset.current = 0;\n                                    scheduled.current = false;\n                                });\n                            });\n                        }\n                    }\n                    else {\n                        const ref1 = model.clickMapCanvas;\n                        const ref2 = model.cigarClickMapCanvas;\n                        if (!ref1 || !ref2) {\n                            return;\n                        }\n                        const rect = ref1.getBoundingClientRect();\n                        const ctx1 = ref1.getContext('2d');\n                        const ctx2 = ref2.getContext('2d');\n                        if (!ctx1 || !ctx2) {\n                            return;\n                        }\n                        const { clientX, clientY } = event;\n                        const x = clientX - rect.left;\n                        const y = clientY - rect.top;\n                        setCurrX(clientX);\n                        setCurrY(clientY);\n                        const [r1, g1, b1] = ctx1.getImageData(x, y, 1, 1).data;\n                        const [r2, g2, b2] = ctx2.getImageData(x, y, 1, 1).data;\n                        const unitMultiplier = Math.floor(MAX_COLOR_RANGE / model.numFeats);\n                        const id = getId(r1, g1, b1, unitMultiplier);\n                        model.setMouseoverId((_a = model.featPositions[id]) === null || _a === void 0 ? void 0 : _a.f.id());\n                        if (id === -1) {\n                            setTooltip('');\n                        }\n                        else if (model.featPositions[id]) {\n                            const { f, cigar } = model.featPositions[id];\n                            const unitMultiplier2 = Math.floor(MAX_COLOR_RANGE / cigar.length);\n                            const cigarIdx = getId(r2, g2, b2, unitMultiplier2);\n                            setTooltip(getTooltip({\n                                feature: f,\n                                cigarOp: cigar[cigarIdx],\n                                cigarOpLen: cigar[cigarIdx + 1],\n                            }));\n                        }\n                    }\n                }, onMouseLeave: () => {\n                    model.setMouseoverId(undefined);\n                    setMouseInitialDownX(undefined);\n                    setMouseCurrDownX(undefined);\n                }, onMouseDown: evt => {\n                    setMouseCurrDownX(evt.clientX);\n                    setMouseInitialDownX(evt.clientX);\n                }, onMouseUp: evt => {\n                    setMouseCurrDownX(undefined);\n                    if (mouseInitialDownX !== undefined &&\n                        Math.abs(evt.clientX - mouseInitialDownX) < 5) {\n                        onSynClick(evt, model);\n                    }\n                }, onContextMenu: evt => {\n                    onSynContextClick(evt, model, setAnchorEl);\n                }, \"data-testid\": \"synteny_canvas\", className: classes.mainCanvas, width: width, height: height }), _jsx(\"canvas\", { ref: clickMapCanvasRef, className: classes.pix, width: width, height: height }), _jsx(\"canvas\", { ref: cigarClickMapCanvasRef, className: classes.pix, width: width, height: height }), mouseoverId && tooltip && currX && currY ? (_jsx(SyntenyTooltip, { title: tooltip })) : null, anchorEl ? (_jsx(SyntenyContextMenu, { model: model, anchorEl: anchorEl, onClose: () => {\n                    setAnchorEl(undefined);\n                } })) : null] }));\n});\nexport default LinearSyntenyRendering;\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useEffect, useState } from 'react';\nimport { LoadingEllipses } from '@jbrowse/core/ui';\nimport { observer } from 'mobx-react';\nimport { makeStyles } from 'tss-react/mui';\nimport LinearSyntenyRendering from './LinearSyntenyRendering';\nconst useStyles = makeStyles()(theme => {\n    const bg = theme.palette.action.disabledBackground;\n    return {\n        loading: {\n            paddingLeft: '0.6em',\n            backgroundColor: theme.palette.background.default,\n            backgroundImage: `repeating-linear-gradient(45deg, transparent, transparent 5px, ${bg} 5px, ${bg} 10px)`,\n            textAlign: 'center',\n        },\n        blockMessage: {\n            background: '#f1f1f1',\n            padding: 10,\n        },\n        blockError: {\n            background: '#f1f1f1',\n            padding: 10,\n            color: 'red',\n        },\n    };\n});\nfunction LoadingMessage() {\n    const [shown, setShown] = useState(false);\n    const { classes } = useStyles();\n    useEffect(() => {\n        const timeout = setTimeout(() => {\n            setShown(true);\n        }, 300);\n        return () => {\n            clearTimeout(timeout);\n        };\n    });\n    return shown ? (_jsx(\"div\", { className: classes.loading, children: _jsx(LoadingEllipses, {}) })) : null;\n}\nfunction BlockMessage({ messageText }) {\n    const { classes } = useStyles();\n    return _jsx(\"div\", { className: classes.blockMessage, children: messageText });\n}\nfunction BlockError({ error }) {\n    const { classes } = useStyles();\n    return _jsx(\"div\", { className: classes.blockError, children: `${error}` });\n}\nconst ServerSideRenderedBlockContent = observer(function ({ model, }) {\n    if (model.error) {\n        return _jsx(BlockError, { error: model.error });\n    }\n    if (model.message) {\n        return _jsx(BlockMessage, { messageText: model.message });\n    }\n    if (!model.features) {\n        return _jsx(LoadingMessage, {});\n    }\n    return _jsx(LinearSyntenyRendering, { model: model });\n});\nexport default ServerSideRenderedBlockContent;\n"],"file":"assets/Component-D_CKbtke.js"}