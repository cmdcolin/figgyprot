const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DeletePluginDialog-BNjfDpsI.js","./index-DRDIumvF.js","./index-DnpZ9owN.css","./AddCustomPluginDialog-f7MijyXZ.js","./ExpandMore-CaMz3Gw7.js","./Collapse-DUY0HwHW.js","./DialogContentText-CilhbB70.js"])))=>i.map(i=>d[i]);
import{I as w,H as T,a as u,K as N,j as s,M as _,N as k,O as D,ac as h,o as p,u as m,aW as x,ao as P,as as R,T as d,_ as I,m as j,an as F,a$ as $,L as B,B as S,ci as W,ab as z,d as U,cJ as O,c as q}from"./index-DRDIumvF.js";import{C as H}from"./Clear-DrwycK_u.js";import{A as v,a as C,E as y}from"./ExpandMore-CaMz3Gw7.js";import{L as V}from"./Lock-w9T626ra.js";import{L as Y}from"./ListItem-RJllARow.js";import{C as J,a as K}from"./CardContent-tBh32fMz.js";import"./Collapse-DUY0HwHW.js";function G(e){return w("MuiCardActions",e)}T("MuiCardActions",["root","spacing"]);const Q=e=>{const{classes:n,disableSpacing:i}=e;return D({root:["root",!i&&"spacing"]},G,n)},X=_("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:i}=e;return[n.root,!i.disableSpacing&&n.spacing]}})({display:"flex",alignItems:"center",padding:8,variants:[{props:{disableSpacing:!1},style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),Z=u.forwardRef(function(n,i){const t=N({props:n,name:"MuiCardActions"}),{disableSpacing:a=!1,className:c,...r}=t,l={...t,disableSpacing:a},o=Q(l);return s.jsx(X,{className:k(o.root,c),ownerState:l,ref:i,...r})}),ss=h(s.jsx("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"})),es=u.lazy(()=>I(()=>import("./DeletePluginDialog-BNjfDpsI.js"),__vite__mapDeps([0,1,2]),import.meta.url)),ns=j()(()=>({lockedPluginTooltip:{marginRight:"0.5rem"}}));function ts(){const{classes:e}=ns();return s.jsx(F,{className:e.lockedPluginTooltip,title:"This plugin was installed by an administrator, you cannot remove it.",children:s.jsx(V,{})})}const as=p(function({plugin:e,model:n}){const{pluginManager:i}=m.getEnv(n),t=m.getSession(n),{jbrowse:a,adminMode:c}=t,r=x.isSessionWithSessionPlugins(t)?t.sessionPlugins.some(l=>{var o;return((o=i.pluginMetadata[e.name])===null||o===void 0?void 0:o.url)===l.url}):!1;return s.jsxs(Y,{children:[c||r?s.jsx(P,{"data-testid":`removePlugin-${e.name}`,onClick:()=>{t.queueDialog(l=>[es,{plugin:e.name,onClose:o=>{if(o){const g=i.pluginMetadata[e.name];c?a.removePlugin(g):x.isSessionWithSessionPlugins(t)&&t.removeSessionPlugin(g)}l()}}])},children:s.jsx(R,{})}):s.jsx(ts,{}),s.jsx(d,{children:e.name})]},e.name)}),is=p(function({pluginManager:n,model:i}){const{plugins:t}=n,{filterText:a}=i,c=t.filter(r=>{var l;return!(!((l=n.pluginMetadata[r.name])===null||l===void 0)&&l.isCore)});return s.jsx($,{children:c.length>0?c.filter(r=>r.name.toLowerCase().includes(a.toLowerCase())).map(r=>s.jsx(as,{plugin:r,model:i},r.name)):s.jsx(d,{children:"No plugins currently installed"})})}),os=h(s.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})),rs=h(s.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"})),ls=j()({card:{margin:"0.5em"},icon:{marginLeft:"0.5em",marginRight:"0.5em"},bold:{fontWeight:600},dataField:{display:"flex",alignItems:"center"},mr:{marginRight:"0.5em"}}),cs=p(function({plugin:n,model:i}){const{classes:t}=ls(),a=m.getSession(i),{pluginManager:c}=m.getEnv(i),{runtimePluginDefinitions:r}=c,l=r.some(f=>"url"in f&&f.url===n.url),[o,g]=u.useState(!1),{adminMode:b,jbrowse:E}=a,{name:A,authors:L,description:M}=n;return s.jsxs(J,{variant:"outlined",className:t.card,children:[s.jsxs(K,{children:[s.jsx(d,{variant:"h5",children:s.jsx(B,{href:`${n.location}#readme`,target:"_blank",rel:"noopener",children:n.name})}),s.jsxs("div",{className:t.dataField,children:[s.jsx(rs,{className:t.mr}),s.jsx(d,{children:L.join(", ")})]}),s.jsx(d,{className:t.bold,children:"Description:"}),s.jsx(d,{children:M})]}),s.jsx(Z,{children:s.jsx(S,{variant:"contained",disabled:l||o,startIcon:l?s.jsx(os,{}):s.jsx(W,{}),onClick:()=>{b?E.addPlugin(n):x.isSessionWithSessionPlugins(a)?a.addSessionPlugin(n):a.notify("No way to install plugin"),g(!0)},children:l?"Installed":"Install"})})]},A)});function ds(){const[e,n]=u.useState(),[i,t]=u.useState();return u.useEffect(()=>{(async()=>{try{const a=await fetch("https://jbrowse.org/plugin-store/plugins.json");if(!a.ok){const r=await a.text();throw new Error(`HTTP ${a.status} fetching plugins: ${r}`)}const c=await a.json();n(c.plugins)}catch(a){console.error(a),t(a)}})()},[]),{plugins:e,error:i}}const us=u.lazy(()=>I(()=>import("./AddCustomPluginDialog-f7MijyXZ.js"),__vite__mapDeps([3,1,2,4,5,6]),import.meta.url)),ms=j()(e=>({expandIcon:{color:e.palette.tertiary.contrastText},adminBadge:{borderRadius:3,backgroundColor:e.palette.quaternary.main,padding:"1em",display:"flex",alignContent:"center"},customPluginButton:{margin:"1em auto",display:"flex"},mr:{marginRight:"0.3em"},m:{margin:"1em"}})),Cs=p(function({model:e}){const{classes:n}=ms(),{plugins:i,error:t}=ds(),{filterText:a}=e,c=m.getSession(e),{adminMode:r}=c,{pluginManager:l}=z(e);return s.jsxs("div",{children:[r&&s.jsxs(s.Fragment,{children:[!m.isElectron&&s.jsxs("div",{className:n.adminBadge,children:[s.jsx(ss,{className:n.mr}),s.jsxs(d,{children:["You are using the ",s.jsx("code",{children:"admin-server"}),". Any changes you make will be saved to your configuration file. You also have the ability to add custom plugins that are not in the store."]})]}),s.jsx(S,{className:n.customPluginButton,variant:"contained",onClick:()=>{c.queueDialog(o=>[us,{model:e,onClose:o}])},children:"Add custom plugin"})]}),s.jsx(U,{label:"Filter plugins",value:a,onChange:o=>{e.setFilterText(o.target.value)},fullWidth:!0,slotProps:{input:{endAdornment:s.jsx(O,{position:"end",children:s.jsx(P,{onClick:()=>{e.clearFilterText()},children:s.jsx(H,{})})})}}}),s.jsxs(v,{defaultExpanded:!0,children:[s.jsx(C,{expandIcon:s.jsx(y,{className:n.expandIcon}),children:s.jsx(d,{variant:"h5",children:"Installed plugins"})}),s.jsx("div",{className:n.m,children:s.jsx(is,{pluginManager:l,model:e})})]}),s.jsxs(v,{defaultExpanded:!0,children:[s.jsx(C,{expandIcon:s.jsx(y,{className:n.expandIcon}),children:s.jsx(d,{variant:"h5",children:"Available plugins"})}),t?s.jsx(d,{color:"error",children:`${t}`}):i?i.filter(o=>!(m.isElectron&&o.cjsUrl)&&o.name.toLowerCase().includes(a.toLowerCase())).map(o=>s.jsx(cs,{plugin:o,model:e},o.name)):s.jsx(q.LoadingEllipses,{})]})]})});export{Cs as default};
//# sourceMappingURL=PluginStoreWidget-Dh-nLVjd.js.map
